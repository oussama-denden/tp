<?xml version="1.0" encoding="UTF-8"?>
<con:soapui-project activeEnvironment="Default" name="Topaze-DEV-Emna" soapui-version="5.0.0" abortOnError="false" runType="SEQUENTIAL" resourceRoot="" xmlns:con="http://eviware.com/soapui/config"><con:settings/><con:interface xsi:type="con:RestService" wadlVersion="http://wadl.dev.java.net/2009/02" name="http://localhost:8081" type="rest" id="3930118b-701f-4c7c-a217-30b16488dffb" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:settings/><con:definitionCache type="TEXT" rootPart=""/><con:endpoints><con:endpoint>http://localhost:8081</con:endpoint></con:endpoints><con:resource name="preparer" path="/contrat-core/contrat/preparer" id="e0f6f06d-06e7-4185-ab9d-8d48c4b8127b"><con:settings/><con:parameters/><con:method name="Method 1" method="POST" id="a698817e-9a74-4989-a2bf-073587a14636"><con:settings/><con:parameters/><con:representation type="REQUEST"><con:mediaType>application/json</con:mediaType><con:params/></con:representation><con:representation type="RESPONSE"><con:mediaType>application/json</con:mediaType><con:status>200</con:status><con:params/><con:element xmlns:prep="http://localhost/contrat-core/contrat/preparer">prep:Response</con:element></con:representation><con:representation type="FAULT"><con:mediaType>application/json</con:mediaType><con:status>500 400</con:status><con:params/><con:element xmlns:prep="http://localhost/contrat-core/contrat/preparer">prep:Fault</con:element></con:representation><con:representation type="FAULT"><con:mediaType>text/html;charset=utf-8</con:mediaType><con:status>400</con:status><con:params/><con:element>html</con:element></con:representation><con:request name="Request 1" mediaType="application/json" postQueryString="false" id="991c0573-0e65-4b66-b591-5f6d6a24554a"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>http://localhost:8081</con:endpoint><con:request>{
  "user": "test",
  "produits": [
    {
      "reference": "avfwpro-confort-s",
      "numEC": "1",
      "numeroCommande": "12345678",
      "label": "Abonnement Antivirus Securitoo",
      "remboursable": "true",
      "typeProduit": "SERVICE",
      "prix": {
        "duree": "2",
        "periodicite": "1",
        "typeTVA": "R",
        "montant": "5",
        "modePaiement": "SEPA",
        "modeFacturation": "DATE_ANNIVERSAIRE"
      }
    }
  ]
}</con:request><con:originalUri>http://localhost/contrat-core/contrat/preparer</con:originalUri><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:request></con:method></con:resource><con:resource name="valider" path="/contrat-core/contrat/{refContrat}/valider" id="fd54d15b-9477-4141-bd80-2d3b7f2aaa7a"><con:settings/><con:parameters><con:parameter><con:name>refContrat</con:name><con:value>refContrat</con:value><con:style>TEMPLATE</con:style><con:default>refContrat</con:default></con:parameter></con:parameters><con:method name="Method 1" method="POST" id="c9c5da9e-6921-4869-9b88-5246156c4d0a"><con:settings/><con:parameters/><con:representation type="FAULT"><con:mediaType>text/html;charset=utf-8</con:mediaType><con:status>400 405</con:status><con:params/><con:element>html</con:element></con:representation><con:representation type="REQUEST"><con:mediaType>application/json</con:mediaType><con:params/></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="FAULT"><con:mediaType>application/json</con:mediaType><con:status>500 400</con:status><con:params/></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:request name="Request 1" mediaType="application/json" postQueryString="false" id="2f9095be-b9f7-4881-8ee1-74542c5d8d83"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>http://localhost:8081</con:endpoint><con:request>{
  "user": "test",
  "idClient": "00003870",
  "idAdrFacturation": "685",
  "paiementInfos": [
    {
      "referenceProduit": "avfwpro-confort-s",
      "numEC": "1",
      "referenceModePaiement": "R0000012",
      "idAdrLivraison": "adrliv1"
    }
  ],
  "politiqueValidation": {
    "fraisCreation": "true",
    "checkIsPackagerCreationPossible": "true"
  }
}</con:request><con:originalUri>http://localhost/contrat-core/contrat/00003177/valider</con:originalUri><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters><entry key="refContrat" value="00003177" xmlns="http://eviware.com/soapui/config"/></con:parameters></con:request></con:method></con:resource><con:resource name="ajouter" path="/contrat-core/contrat/{refContrat}/reduction/ajouter" id="74616538-5b58-4633-9ad2-5a831ae3eecd"><con:settings/><con:parameters><con:parameter><con:name>refContrat</con:name><con:value>refContrat</con:value><con:style>TEMPLATE</con:style><con:default>refContrat</con:default></con:parameter></con:parameters><con:method name="Method 1" method="POST" id="5bf6d390-75b2-4692-97d6-840169f07f80"><con:settings/><con:parameters/><con:representation type="REQUEST"><con:mediaType>application/json</con:mediaType><con:params/></con:representation><con:representation type="FAULT"><con:mediaType>text/html;charset=utf-8</con:mediaType><con:status>400</con:status><con:params/><con:element>html</con:element></con:representation><con:representation type="FAULT"><con:mediaType>application/json</con:mediaType><con:status>500</con:status><con:params/><con:element xmlns:ajo="http://localhost/contrat-core/contrat/00003183/reduction/ajouter">ajo:Fault</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>0</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType>application/json</con:mediaType><con:status>200</con:status><con:params/><con:element xmlns:ajo="http://localhost/contrat-core/contrat/00003200/reduction/ajouter">ajo:Response</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>0</con:status><con:params/><con:element>data</con:element></con:representation><con:request name="Request 1" mediaType="application/json" postQueryString="false" id="c08c5fb9-e8af-470e-988b-2a9adff352c1"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>http://localhost:8081</con:endpoint><con:request>{
  "reduction": {
    "valeur": "1",
    "isAffichableSurFacture": "true",
    "dateFin": "",
    "nbUtilisationMax": "1",
    "titre": "reduction-test-global",
    "dateDebut": "",
    "typeReduction": "FRAIS",
    "typeValeur": "MOIS",
    "typeFrais": "MIGRATION"
  },
  "user": "testeur"
}</con:request><con:originalUri>http://localhost/contrat-core/contrat/00003177/reduction/ajouter</con:originalUri><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters><entry key="refContrat" value="00003177" xmlns="http://eviware.com/soapui/config"/></con:parameters></con:request></con:method></con:resource><con:resource name="resilier" path="/contrat-core/contrat/{refContrat}/resilier" id="6a40d503-dcf9-4eaf-8c65-0730884d53a5"><con:settings/><con:parameters><con:parameter><con:name>refContrat</con:name><con:value>refContrat</con:value><con:style>TEMPLATE</con:style><con:default>refContrat</con:default></con:parameter></con:parameters><con:method name="Method 1" method="POST" id="f134a681-421b-4310-b09d-62633a1acec9"><con:settings/><con:parameters/><con:representation type="REQUEST"><con:mediaType>application/json</con:mediaType><con:params/></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="FAULT"><con:mediaType>application/json</con:mediaType><con:status>500 400</con:status><con:params/><con:element xmlns:res="http://localhost/contrat-core/contrat/00003215/resilier">res:Fault</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="FAULT"><con:mediaType>text/html;charset=utf-8</con:mediaType><con:status>405 400</con:status><con:params/><con:element>html</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:request name="Request 1" mediaType="application/json" postQueryString="false" id="0480d6f4-f5c9-435d-8fd6-28656d500056"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>http://localhost:8081</con:endpoint><con:request/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:request></con:method></con:resource><con:resource name="migrer" path="/contrat-core/contrat/{refContrat}/migrer" id="8c8587c2-ca7f-42af-83e4-e87edfccfd38"><con:settings/><con:parameters><con:parameter><con:name>refContrat</con:name><con:value>refContrat</con:value><con:style>TEMPLATE</con:style><con:default>refContrat</con:default></con:parameter></con:parameters><con:method name="Method 1" method="POST" id="0d1e864b-a851-4ff9-9e18-86f5f28728e1"><con:settings/><con:parameters/><con:representation type="FAULT"><con:mediaType>text/html;charset=utf-8</con:mediaType><con:status>405 400 404</con:status><con:params/><con:element>html</con:element></con:representation><con:representation type="REQUEST"><con:mediaType>application/json</con:mediaType><con:params/></con:representation><con:representation type="RESPONSE"><con:mediaType>application/json</con:mediaType><con:status>200</con:status><con:params/></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="FAULT"><con:mediaType>application/json</con:mediaType><con:status>500</con:status><con:params/><con:element xmlns:mig="http://localhost/contrat-core/contrat/00003252/migrer">mig:Fault</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:request name="Request 1" mediaType="application/json" postQueryString="false" id="e0e1fef8-939e-4869-8317-7654e19210c3"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>http://localhost:8081</con:endpoint><con:request/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:request></con:method></con:resource><con:resource name="renouveler" path="/contrat-core/contrat/{refContrat}/renouveler" id="44f22ee4-77d3-43c4-b3cb-4e11e3d6679e"><con:settings/><con:parameters><con:parameter><con:name>refContrat</con:name><con:value>refContrat</con:value><con:style>TEMPLATE</con:style><con:default>refContrat</con:default></con:parameter></con:parameters><con:method name="Method 1" method="POST" id="6f8377ec-fe84-4309-be1f-c01820fd4cee"><con:settings/><con:parameters/><con:representation type="REQUEST"><con:mediaType>application/json</con:mediaType><con:params/></con:representation><con:representation type="RESPONSE"><con:mediaType>application/json</con:mediaType><con:status>200</con:status><con:params/><con:element xmlns:ren="http://localhost/contrat-core/contrat/00003284/renouveler">ren:Response</con:element></con:representation><con:representation type="FAULT"><con:mediaType>text/html;charset=utf-8</con:mediaType><con:status>400</con:status><con:params/><con:element>html</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>0</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="FAULT"><con:mediaType>application/json</con:mediaType><con:status>500</con:status><con:params/><con:element xmlns:ren="http://localhost/contrat-core/contrat/00003285/renouveler">ren:Fault</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>200</con:status><con:params/><con:element>data</con:element></con:representation><con:request name="Request 1" mediaType="application/json" id="6557bae6-b6eb-4d0a-935b-3ff18edad705" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>http://localhost:8081</con:endpoint><con:request/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:request></con:method></con:resource></con:interface><con:testSuite name="Error validation" id="c529faf4-d2dc-405c-b78f-ad25995679b1"><con:settings/><con:runType>SEQUENTIAL</con:runType><con:testCase failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="preparation" searchProperties="true" id="621887f4-565f-4013-bd4a-24e3e4c41a1e"><con:settings/><con:testStep type="properties" name="ContratInfo" id="a44f3544-1ef1-4079-b45e-219d1cd4a797"><con:settings/><con:config xsi:type="con:PropertiesStep" saveFirst="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:properties><con:property><con:name>refContrat</con:name><con:value>003000010</con:value></con:property></con:properties></con:config></con:testStep><con:testStep type="groovy" name="create Ref Commande" id="db1ba6b2-11d2-43f6-9893-15204a39c5c1"><con:settings/><con:config><script>import static java.util.UUID.randomUUID 
def tc = context.testCase 
uuid = randomUUID().toString()
testRunner.testCase.setPropertyValue( "RefCommande", uuid ) 
log.info testRunner.testCase.getPropertyValue("RefCommande")</script></con:config></con:testStep><con:testStep type="restrequest" name="preparation" id="ef87afcb-ef92-4110-882e-0accb21ececc"><con:settings/><con:config service="http://localhost:8081" methodName="Method 1" resourcePath="/contrat-core/contrat/preparer" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="preparation" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://localhost:8081</con:endpoint><con:request>{
  "user": "test-prepa",
  "produits": [
    {
"reference": "avfwpro-confort-s",
      "numEC": "1",
"numeroCommande": "${#TestCase#RefCommande}",
      "label": "Abonnement Antivirus Securitoo",
      "remboursable": "true",
      "typeProduit": "SERVICE",
      "prix": {
        "duree": "10",
        "periodicite": "1",
        "typeTVA": "R",
        "montant": "5",
        "modePaiement": "SEPA",
        "frais": [
         
          {
            "montant": "30",
            "typeFrais": "creation"
            
          },
          {
            "montant": "30",
            "typeFrais": "resiliation"
            
          }
        ],
        "modeFacturation": "DATE_ANNIVERSAIRE"
      }
    }
  ]
}
</con:request><con:originalUri>http://localhost/contrat-core/contrat/preparer</con:originalUri><con:assertion type="XPath Match" name="XPath Match" id="7326d6f2-322f-41a7-85ff-914569dcc8fd"><con:configuration><path>exists(//*:referenceContrat)</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="Valid HTTP Status Codes" name="Valid HTTP Status Codes" id="a6618d83-80e2-40fe-9dbe-1bd0e4e49e64"><con:configuration><codes>200</codes></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:restRequest></con:config></con:testStep><con:testStep type="transfer" name="Move ref contrat" id="eb799165-04d6-4bca-87c4-a53855b99745"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" useXQuery="false" entitize="false" transferChildNodes="false"><con:name>refContrat</con:name><con:sourceType>ResponseAsXml</con:sourceType><con:sourceStep>preparation</con:sourceStep><con:sourcePath>//*:referenceContrat</con:sourcePath><con:targetType>refContrat</con:targetType><con:targetStep>#TestCase#</con:targetStep></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" transferToAll="false" ignoreEmpty="false" useXQuery="false" entitize="false" transferChildNodes="false"><con:name>refContratLocal</con:name><con:sourceType>ResponseAsXml</con:sourceType><con:sourceStep>preparation</con:sourceStep><con:sourcePath>//*:referenceContrat</con:sourcePath><con:targetType>refContrat</con:targetType><con:targetStep>ContratInfo</con:targetStep></con:transfers></con:config></con:testStep><con:testStep type="jdbc" name="contrat prepare" id="95d7798e-8b3d-4c0a-938c-38231a106792"><con:settings/><con:config xsi:type="con:JdbcRequestTestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:driver>com.mysql.jdbc.Driver</con:driver><con:connectionString>jdbc:mysql://localhost:3306/topaze_test?user=test&amp;password=test</con:connectionString><con:query>select * from contrat where reference=
"${ContratInfo#refContrat}";</con:query><con:assertion type="XPath Match" name="date preparation exists"><con:configuration><path>exists(//*:CONTRAT.DATEPREPARATION/text())</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="meme ref commande"><con:configuration><path>//*:CONTRAT.REFERENCE/text()</path><content>${ContratInfo#refContrat}</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:testStep type="jdbc" name="EC prepares" id="c476d1f6-2d63-4641-a496-fe0299996539"><con:settings/><con:config xsi:type="con:JdbcRequestTestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:driver>com.mysql.jdbc.Driver</con:driver><con:connectionString>jdbc:mysql://localhost:3306/topaze_test?user=test&amp;password=test</con:connectionString><con:query>select * from elementcontractuel where contratParent
=(select id from contrat where reference =
"${ContratInfo#refContrat}");</con:query><con:assertion type="XPath Match" name="date validation exists"><con:configuration><path>exists(//*:ELEMENTCONTRACTUEL.DATEPREPARATION/text())</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="mode facturation"><con:configuration><path>exists(//*:ELEMENTCONTRACTUEL.MODEFACTURATION/text())</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:properties><con:property><con:name>RefCommande</con:name><con:value>e323a30f-3c0a-4d75-9d50-6fadaf1a4f33</con:value></con:property><con:property><con:name>refContrat</con:name><con:value>003000010</con:value></con:property></con:properties></con:testCase><con:testCase failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="preparation-validation" searchProperties="true" id="6c56c18b-08b8-4072-a062-97a144660809"><con:settings/><con:testStep type="calltestcase" name="preparation" id="a3e41d01-a8e3-424e-a6d3-0ebf3fc8a7ac"><con:settings/><con:config xsi:type="con:RunTestCaseStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:targetTestCase>621887f4-565f-4013-bd4a-24e3e4c41a1e</con:targetTestCase><con:properties><con:property><con:name>RefCommande</con:name><con:value>470ea789-91f4-4db3-be90-960db01851e5</con:value></con:property><con:property><con:name>refContrat</con:name><con:value>005000004</con:value></con:property></con:properties><con:returnProperties><con:entry>RefCommande</con:entry><con:entry>refContrat</con:entry></con:returnProperties><con:runMode>PARALLELL</con:runMode></con:config></con:testStep><con:testStep type="transfer" name="move ref contrat" id="d698fcdb-0725-4aad-a70a-2a1a14409465"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" useXQuery="false" entitize="false" transferChildNodes="false"><con:name>refContrat</con:name><con:sourceType>refContrat</con:sourceType><con:sourceStep>preparation</con:sourceStep><con:targetType>refContrat</con:targetType><con:targetStep>#TestCase#</con:targetStep></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" useXQuery="false" entitize="false" transferChildNodes="false"><con:name>refCommande</con:name><con:sourceType>RefCommande</con:sourceType><con:sourceStep>preparation</con:sourceStep><con:targetType>refCommande</con:targetType><con:targetStep>#TestCase#</con:targetStep></con:transfers></con:config></con:testStep><con:testStep type="restrequest" name="validation" id="58e60810-534d-4ada-8c84-e7ddbcdffeee"><con:settings/><con:config service="http://localhost:8081" methodName="Method 1" resourcePath="/contrat-core/contrat/{refContrat}/valider" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="validation" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://localhost:8081</con:endpoint><con:request>{
  "user": "test",
  "idClient": "00003870",
  "segmentTVA": "00",
  "idAdrFacturation": "685",
  "paiementInfos": [
    {
      "referenceProduit": "avfwpro-confort-s",
      "numEC": "1",
      "referenceModePaiement": "R0000012",
      "idAdrLivraison": "idr"
    }
  ],
  "politiqueValidation": {
    "fraisCreation": "true",
    "checkIsPackagerCreationPossible": "true"
  }
}
</con:request><con:originalUri>http://localhost/contrat-core/contrat/00003193/valider</con:originalUri><con:assertion type="GroovyScriptAssertion" name="Script Assertion" id="62436055-65aa-426e-8375-e05ab5ae77a4"><con:configuration><scriptText>assert messageExchange.hasResponse() == false</scriptText></con:configuration></con:assertion><con:assertion type="Valid HTTP Status Codes" name="Valid HTTP Status Codes" id="8906dac3-7fb5-4a91-907d-e4a42723b4c0"><con:configuration><codes>200</codes></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters><entry key="refContrat" value="${preparation#refContrat}" xmlns="http://eviware.com/soapui/config"/></con:parameters></con:restRequest></con:config></con:testStep><con:testStep type="jdbc" name="politique validation" id="97da3dca-62d7-4720-a574-41a267d6425d"><con:settings/><con:config xsi:type="con:JdbcRequestTestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:driver>com.mysql.jdbc.Driver</con:driver><con:connectionString>jdbc:mysql://localhost:3306/topaze_test?user=test&amp;password=test</con:connectionString><con:query>select * from politiquevalidation 
where id  = 
(select politiqueValidationId from contrat
where reference = "${preparation#refContrat}")</con:query><con:assertion type="XPath Match" name="check is packager creation true"><con:configuration><path>//*:POLITIQUEVALIDATION.CHECKISPACKAGERCREATIONPOSSIBLE/text()</path><content>1</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="frais creation true"><con:configuration><path>//*:POLITIQUEVALIDATION.FRAISCREATION/text()</path><content>1</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:testStep type="jdbc" name="contrat valide" id="aefdbee9-a46a-4f06-8411-814beb8f7a7c"><con:settings/><con:config xsi:type="con:JdbcRequestTestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:driver>com.mysql.jdbc.Driver</con:driver><con:connectionString>jdbc:mysql://localhost:3306/topaze_test?user=test&amp;password=test</con:connectionString><con:query>select * from 
elementcontractuel 
where contratParent=(select id from contrat where reference="${preparation#refContrat}") ;</con:query><con:assertion type="Simple Contains" name="datevalidation exist"><con:configuration><token>ELEMENTCONTRACTUEL.DATEVALIDATION</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:testStep type="jdbc" name="EC valide" id="8a705d18-13ca-4909-b709-4e6d3155e739"><con:settings/><con:config xsi:type="con:JdbcRequestTestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:driver>com.mysql.jdbc.Driver</con:driver><con:connectionString>jdbc:mysql://localhost:3306/topaze_test?user=test&amp;password=test</con:connectionString><con:query>select * from elementcontractuel where
contratparent=(select id from contrat where
reference="${preparation#refcontrat}");</con:query><con:assertion type="XPath Match" name="date validation exists"><con:configuration><path>exists(//*:ELEMENTCONTRACTUEL.DATEVALIDATION/text())</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="numero commande"><con:configuration><path>//*:ELEMENTCONTRACTUEL.NUMEROCOMMANDE/text()</path><content>${preparation#refCommande}</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="adress livraison"><con:configuration><path>exists(//*:ELEMENTCONTRACTUEL.IDADRLIVRAISON/text())</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:testStep type="delay" name="Wait for beginning Livraison" id="16b53ab2-37a2-4974-9121-579c46d5aacc"><con:settings/><con:config><delay>500</delay></con:config></con:testStep><con:testStep type="jdbc" name="bon livraison intie" id="9dea75bb-d395-405e-81f3-6fe2c5e4c39a"><con:settings/><con:config xsi:type="con:JdbcRequestTestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:driver>com.mysql.jdbc.Driver</con:driver><con:connectionString>jdbc:mysql://localhost:3306/topaze_test?user=test&amp;password=test</con:connectionString><con:query>select * from bonpreparation 
where reference = "${preparation#refContrat}"
  and typeBonPreparation = 'LIVRAISON'</con:query><con:properties/></con:config></con:testStep><con:testStep type="goto" name="go to begining livraison" id="ac6b900d-8c09-4d3e-8552-c9d3c3854121"><con:settings/><con:config xsi:type="con:GotoStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:condition><con:name>begining livraison</con:name><con:type>XPATH</con:type><con:expression>not(//Results/ResultSet/Row/BONPREPARATION.DATEINITIATION/text())</con:expression><con:targetStep>Wait for beginning Livraison</con:targetStep></con:condition></con:config></con:testStep><con:testStep type="jdbc" name="bon livraison intie (validation champ)" id="2d27df49-c444-4c2f-a5ef-8c607a44eec2"><con:settings/><con:config xsi:type="con:JdbcRequestTestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:driver>com.mysql.jdbc.Driver</con:driver><con:connectionString>jdbc:mysql://localhost:3306/topaze_test?user=test&amp;password=test</con:connectionString><con:query>select * from bonpreparation 
where reference = "${preparation#refContrat}"
  and typeBonPreparation = 'LIVRAISON'</con:query><con:assertion type="XPath Match" name="reference"><con:configuration><path>//*:BONPREPARATION.REFERENCE/text()</path><content>${preparation#refContrat}</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="type bon livraison"><con:configuration><path>//*:BONPREPARATION.TYPEBONPREPARATION/text()</path><content>LIVRAISON</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="id client exists"><con:configuration><path>exists(//*:BONPREPARATION.IDCLIENT/text())</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="date initiation exists"><con:configuration><path>exists(//*:BONPREPARATION.DATEINITIATION/text())</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:testStep type="jdbc" name="element livraion intities" id="038cd165-4672-41bb-bea9-85fe66c234c5"><con:settings/><con:config xsi:type="con:JdbcRequestTestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:driver>com.mysql.jdbc.Driver</con:driver><con:connectionString>jdbc:mysql://localhost:3306/topaze_test?user=test&amp;password=test</con:connectionString><con:query>select * from elementlivraison 
where bonPreparationParent = 
(select id from bonpreparation 
  where reference = "${preparation#refContrat}"
    and typeBonPreparation = 'LIVRAISON')</con:query><con:assertion type="XPath Match" name="date initiation exists"><con:configuration><path>exists(//*:ELEMENTLIVRAISON.DATEINITIATION/text())</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="type bon livraison"><con:configuration><path>//*:ELEMENTLIVRAISON.TYPEBONPREPARATION/text()</path><content>LIVRAISON</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="type contrat"><con:configuration><path>//*:ELEMENTLIVRAISON.TYPECONTRAT/text()</path><content>ABONNEMENT</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="adr livraison exists"><con:configuration><path>exists(//*:ELEMENTLIVRAISON.ADDRESSELIVRAISON/text())</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:testStep type="delay" name="wait end livraison" id="6f8cb138-bb2d-404d-9a46-6f07fe096560"><con:settings/><con:config><delay>500</delay></con:config></con:testStep><con:testStep type="jdbc" name="bon livraison termine" id="c4155164-d093-464a-8576-07e370d5751f"><con:settings/><con:config xsi:type="con:JdbcRequestTestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:driver>com.mysql.jdbc.Driver</con:driver><con:connectionString>jdbc:mysql://localhost:3306/topaze_test?user=test&amp;password=test</con:connectionString><con:query>select * from bonpreparation 
where reference = "${preparation#refContrat}"
  and typeBonPreparation = 'LIVRAISON'</con:query><con:properties/></con:config></con:testStep><con:testStep type="goto" name="go end livraison" id="b79687e1-f350-4ec0-b207-aca1e1f67745"><con:settings/><con:config xsi:type="con:GotoStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:condition><con:name>end livraison</con:name><con:type>XPATH</con:type><con:expression>not(//ResultSet/Row/BONPREPARATION.DATELIVRAISONTERMINE/text()) 
and
not(//ResultSet/Row/BONPREPARATION.CAUSENONLIVRAISON/text())</con:expression><con:targetStep>wait end livraison</con:targetStep></con:condition></con:config></con:testStep><con:testStep type="jdbc" name="bon livraison termine validation" id="2092d97e-9da0-49f1-a3a1-9fba857661fe"><con:settings/><con:config xsi:type="con:JdbcRequestTestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:driver>com.mysql.jdbc.Driver</con:driver><con:connectionString>jdbc:mysql://localhost:3306/topaze_test?user=test&amp;password=test</con:connectionString><con:query>select * from bonpreparation 
where reference = "${preparation#refContrat}"
  and typeBonPreparation = 'LIVRAISON'</con:query><con:assertion type="XPath Match" name="date livraison exists"><con:configuration><path>exists(//*:BONPREPARATION.DATEPREPARATION/text())</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="type bon livraison"><con:configuration><path>//*:BONPREPARATION.TYPEBONPREPARATION/text()</path><content>LIVRAISON</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="date debut prep"><con:configuration><path>exists(//*:BONPREPARATION.DATEDEBUTPREPARATION/text())</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:testStep type="jdbc" name="element livraison livres" id="17320f72-011b-4cda-9edd-dc34a7525466"><con:settings/><con:config xsi:type="con:JdbcRequestTestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:driver>com.mysql.jdbc.Driver</con:driver><con:connectionString>jdbc:mysql://localhost:3306/topaze_test?user=test&amp;password=test</con:connectionString><con:query>select * from elementlivraison 
where bonPreparationParent = 
(select id from bonpreparation 
  where reference = "${preparation#refContrat}"
    and typeBonPreparation = 'LIVRAISON')</con:query><con:assertion type="XPath Match" name="date preparation exists"><con:configuration><path>exists(//*:ELEMENTLIVRAISON.DATEPREPARATION/text())</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="date livraison termine"><con:configuration><path>exists(//*:ELEMENTLIVRAISON.DATELIVRAISONTERMINE/text())</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="type contrat"><con:configuration><path>//*:ELEMENTLIVRAISON.TYPECONTRAT/text()</path><content>ABONNEMENT</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:testStep type="jdbc" name="bon livraison livre" id="606b137c-841e-4db4-8b2f-e0134d59c264"><con:settings/><con:config xsi:type="con:JdbcRequestTestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:driver>com.mysql.jdbc.Driver</con:driver><con:connectionString>jdbc:mysql://localhost:3306/topaze_test?user=test&amp;password=test</con:connectionString><con:query>select * from bonpreparation 
where reference = "${preparation#refContrat}"
  and typeBonPreparation = 'LIVRAISON'</con:query><con:assertion type="XPath Match" name="true"><con:configuration><path>exists(//*:BONPREPARATION.DATELIVRAISONTERMINE/text())</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="tous les dates exists"><con:configuration><path>exists(//ResultSet/Row/BONPREPARATION.DATEINITIATION/text())
and
exists(//ResultSet/Row/BONPREPARATION.DATEDEBUTPREPARATION/text())
and
exists(//ResultSet/Row/BONPREPARATION.DATEPREPARATION/text())
and
exists(//ResultSet/Row/BONPREPARATION.DATELIVRAISONTERMINE/text())</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="id client exists"><con:configuration><path>exists(//*:BONPREPARATION.IDCLIENT/text())</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="cause de non livraison vide"><con:configuration><path>exists(//*:BONPREPARATION.CAUSENONLIVRAISON/text())</path><content>false</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:testStep type="delay" name="wait end facture" id="4dcc85a4-92fa-4922-88a5-1627b9e3deaf"><con:settings/><con:config><delay>500</delay></con:config></con:testStep><con:testStep type="jdbc" name="facture exists" id="f4158430-5a52-452a-b556-6bc2ed9cbd21"><con:settings/><con:config xsi:type="con:JdbcRequestTestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:driver>com.mysql.jdbc.Driver</con:driver><con:connectionString>jdbc:mysql://localhost:3306/topaze_test?user=test&amp;password=test</con:connectionString><con:query>select * from movement where productReferenceId=
${preparation#refContrat};</con:query><con:properties/></con:config></con:testStep><con:testStep type="goto" name="go to facture" id="31664a2a-a2a3-4635-a6b9-94b763a8b8f8"><con:settings/><con:config xsi:type="con:GotoStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:condition><con:name>wait</con:name><con:type>XPATH</con:type><con:expression>not(//ResultSet/Row[contains(MOVEMENT.PRODUCTID/text(), 'Frais/Creation')])

</con:expression><con:targetStep>wait end facture</con:targetStep></con:condition></con:config></con:testStep><con:testStep type="jdbc" name="facturation valide" id="02fb4fdd-6507-407f-92a6-4eb253e07605"><con:settings/><con:config xsi:type="con:JdbcRequestTestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:driver>com.mysql.jdbc.Driver</con:driver><con:connectionString>jdbc:mysql://localhost:3306/topaze_test?user=test&amp;password=test</con:connectionString><con:query>select * from movement where productReferenceId=
${preparation#refContrat} ;</con:query><con:assertion type="XQuery Match" name="reference contrat"><con:configuration><path>&lt;Results> 
{ 
  for $x in //Row 
  return &lt;Result>{$x/MOVEMENT.PRODUCTREFERENCEID/text()}&lt;/Result> 
} 
&lt;/Results></path><content><![CDATA[<Results>
<Result> ${preparation#refContrat}  </Result>
<Result> ${preparation#refContrat}  </Result>


</Results>]]></content><allowWildcards>false</allowWildcards></con:configuration></con:assertion><con:assertion type="XQuery Match" name="id client"><con:configuration><path>&lt;Results> 
{ 
  for $x in //Row 
  return &lt;Result>{$x/MOVEMENT.ACCOUNTID/text()}&lt;/Result> 
} 
&lt;/Results></path><content><![CDATA[<Results>
<Result>00003870 </Result>
<Result> 00003870  </Result>


</Results>]]></content><allowWildcards>false</allowWildcards></con:configuration></con:assertion><con:assertion type="XQuery Match" name="type de mouvement"><con:configuration><path>&lt;Results> 
{ 
  for $x in //Row 
  return &lt;Result>{$x/MOVEMENT.PRODUCTID/text()}&lt;/Result> 
} 
&lt;/Results></path><content><![CDATA[<Results>
<Result>Securite/securitoo/avfwpro-confort-s/Frais/Creation </Result>
<Result> Securite/securitoo/avfwpro-confort-s  </Result>


</Results>]]></content><allowWildcards>false</allowWildcards></con:configuration></con:assertion><con:assertion type="XQuery Match" name="valeur "><con:configuration><path>&lt;Results> 
{ 
  for $x in //Row 
  return &lt;Result>{$x/MOVEMENT.AMOUNT/text()}&lt;/Result> 
} 
&lt;/Results></path><content><![CDATA[<Results>
<Result>30</Result>
<Result>5</Result>


</Results>]]></content><allowWildcards>false</allowWildcards></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:properties><con:property><con:name>refContrat</con:name><con:value>005000004</con:value></con:property><con:property><con:name>refCommande</con:name><con:value>470ea789-91f4-4db3-be90-960db01851e5</con:value></con:property></con:properties></con:testCase><con:testCase failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="preparation-validation-contrat-vente" searchProperties="true" id="d9b2d183-2730-46c9-849a-40afae69081e"><con:settings/><con:testStep type="properties" name="contratInfo" id="90c6ab49-8cf7-4ea4-9503-0c0f30bce476"><con:settings/><con:config xsi:type="con:PropertiesStep" saveFirst="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:properties><con:property><con:name>refContrat</con:name><con:value>301000000</con:value></con:property></con:properties></con:config></con:testStep><con:testStep type="restrequest" name="preparation" id="e01f41a8-0876-4627-a6bb-13eadf869db2"><con:settings/><con:config service="http://localhost:8081" methodName="Method 1" resourcePath="/contrat-core/contrat/preparer" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="preparation" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://localhost:8081</con:endpoint><con:request> {
  "user": "test",
  "produits": [
    {
      "reference": "avfwpro-confort-s",
      "numEC": "1",
      "numeroCommande": "12345678",
      "label": "Abonnement Antivirus Securitoo",
      "remboursable": "true",
      "typeProduit": "SERVICE",
      "prix": {
        "duree": "",
        "periodicite": "",
        "typeTVA": "R",
        "montant": "5",
        "frais": [
          {
            "montant": "10",
            "typeFrais": "creation"
          }
        ],
        "modePaiement": "CB",
        "modeFacturation": "DATE_ANNIVERSAIRE"
      }
    }
  ]
}</con:request><con:originalUri>http://localhost/contrat-core/contrat/preparer</con:originalUri><con:assertion type="Valid HTTP Status Codes" name="Valid HTTP Status Codes" id="9f4cac9a-b202-4f8f-ac80-f72c1a0277d0"><con:configuration><codes>200</codes></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:restRequest></con:config></con:testStep><con:testStep type="transfer" name="move ref contrat" id="36ad5f4a-b7dc-47c2-8173-348e49a6572d"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" useXQuery="false" entitize="false" transferChildNodes="false"><con:name>refContrat</con:name><con:sourceType>ResponseAsXml</con:sourceType><con:sourceStep>preparation</con:sourceStep><con:sourcePath>//*:referenceContrat</con:sourcePath><con:targetType>refContrat</con:targetType><con:targetStep>contratInfo</con:targetStep></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" useXQuery="false" entitize="false" transferChildNodes="false"><con:name>refContratTestcase</con:name><con:sourceType>ResponseAsXml</con:sourceType><con:sourceStep>preparation</con:sourceStep><con:sourcePath>//*:referenceContrat</con:sourcePath><con:targetType>refContrat</con:targetType><con:targetStep>#TestCase#</con:targetStep></con:transfers></con:config></con:testStep><con:testStep type="restrequest" name="valider" id="6165e816-8a40-4de6-a96e-b85ba0542804"><con:settings/><con:config service="http://localhost:8081" methodName="Method 1" resourcePath="/contrat-core/contrat/{refContrat}/valider" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="valider" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://localhost:8081</con:endpoint><con:request> {
  "user": "test",
  "idClient": "00003870",
  "segmentTVA": "00",
  "idAdrFacturation": "685",
  "paiementInfos": [
    {
      "referenceProduit": "avfwpro-confort-s",
      "numEC": "1",
      "referenceModePaiement": "R0000012",
      "idAdrLivraison": "adrliv1"
    }
  ],
  "politiqueValidation": {
    "fraisCreation": "true",
    "checkIsPackagerCreationPossible": "true"
  }
}</con:request><con:originalUri>http://localhost/contrat-core/contrat/00003217/valider</con:originalUri><con:assertion type="GroovyScriptAssertion" name="Script Assertion" id="a3e5c3ef-0238-41df-aea2-6bf97af71d67"><con:configuration><scriptText>assert messageExchange.hasResponse() == false</scriptText></con:configuration></con:assertion><con:assertion type="Valid HTTP Status Codes" name="Valid HTTP Status Codes" id="7215f2da-7325-4ca1-a5fb-290d0da9eb65"><con:configuration><codes>200</codes></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters><entry key="refContrat" value="${contratInfo#refContrat}" xmlns="http://eviware.com/soapui/config"/></con:parameters></con:restRequest></con:config></con:testStep><con:testStep type="delay" name="wait facture" id="80b34c38-e020-4d48-a22c-fc3b8cfa5447"><con:settings/><con:config><delay>500</delay></con:config></con:testStep><con:testStep type="jdbc" name="contrat valide" id="77499393-7256-43b8-9224-2ac504355177"><con:settings/><con:config xsi:type="con:JdbcRequestTestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:driver>com.mysql.jdbc.Driver</con:driver><con:connectionString>jdbc:mysql://localhost:3306/topaze_test?user=test&amp;password=test</con:connectionString><con:query>select * from 
elementcontractuel 
where contratParent=(select id from contrat where reference="${contratInfo#refContrat}") ;</con:query><con:assertion type="Simple Contains" name="date validation exist"><con:configuration><token>ELEMENTCONTRACTUEL.DATEVALIDATION</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:testStep type="goto" name="go to facture" id="96d8822c-06a2-453f-bae5-962d842c053d"><con:settings/><con:config xsi:type="con:GotoStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:condition><con:name>facture</con:name><con:type>XPATH</con:type><con:expression>not(//Results/ResultSet/Row/ELEMENTCONTRACTUEL.DATEDERNIEREFACTURE/text())</con:expression><con:targetStep>wait facture</con:targetStep></con:condition></con:config></con:testStep><con:properties><con:property><con:name>refContrat</con:name><con:value>301000000</con:value></con:property></con:properties></con:testCase><con:testCase failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="resiliation" searchProperties="true" id="82a3926c-67ae-4136-87ba-1c522c84a422"><con:settings/><con:testStep type="calltestcase" name="preparation-validation" id="c7e84e68-32d5-45aa-a6a7-5d24c18fd097"><con:settings/><con:config xsi:type="con:RunTestCaseStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:targetTestCase>6c56c18b-08b8-4072-a062-97a144660809</con:targetTestCase><con:properties><con:property><con:name>refContrat</con:name><con:value>005000019</con:value></con:property><con:property><con:name>refCommande</con:name></con:property></con:properties><con:returnProperties><con:entry>refContrat</con:entry></con:returnProperties><con:runMode>PARALLELL</con:runMode></con:config></con:testStep><con:testStep type="delay" name="wait facture" id="36af356a-9f89-40c7-aa8f-57e17b60ad20"><con:settings/><con:config><delay>500</delay></con:config></con:testStep><con:testStep type="jdbc" name="contrat valide" id="43c760d5-b25e-44a8-8b52-4db695a23caf"><con:settings/><con:config xsi:type="con:JdbcRequestTestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:driver>com.mysql.jdbc.Driver</con:driver><con:connectionString>jdbc:mysql://localhost:3306/topaze_test?user=test&amp;password=test</con:connectionString><con:query>select * from elementcontractuel where contratParent=(select id from contrat where reference="${preparation-validation#refContrat}") ;</con:query><con:properties/></con:config></con:testStep><con:testStep type="goto" name="go facture" id="39f1f433-fc90-45f0-ac03-77765ed75c94"><con:settings/><con:config xsi:type="con:GotoStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:condition><con:name>go wait for facture</con:name><con:type>XPATH</con:type><con:expression>not(//Results/ResultSet/Row/ELEMENTCONTRACTUEL.DATEDERNIEREFACTURE/text())</con:expression><con:targetStep>wait facture</con:targetStep></con:condition></con:config></con:testStep><con:testStep type="restrequest" name="resilier" id="9de381ab-c210-45e4-854f-c93e87b1b674"><con:settings/><con:config service="http://localhost:8081" methodName="Method 1" resourcePath="/contrat-core/contrat/{refContrat}/resilier" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="resilier" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://localhost:8081</con:endpoint><con:request>{
  "user": "test",
  "politiqueResiliation": {
    "fraisResiliation": "true",
    "montantResiliation": "",
    "typeResiliation": "RIC",
    "remboursement": "true",
    "montantRemboursement": "",
    "penalite": "true",
    "commentaire": "this is a test"
  }
}</con:request><con:originalUri>http://localhost/contrat-core/contrat/00003217/resilier</con:originalUri><con:assertion type="Valid HTTP Status Codes" name="Valid HTTP Status Codes" id="63699cce-1ca7-4527-8c2f-134c7c9e295f"><con:configuration><codes>200</codes></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters><entry key="refContrat" value="${preparation-validation#refContrat}" xmlns="http://eviware.com/soapui/config"/></con:parameters></con:restRequest></con:config></con:testStep><con:testStep type="delay" name="wait cancelling" id="d9789c13-6ddf-4dcc-b97e-04ce90e5b2ff"><con:settings/><con:config><delay>500</delay></con:config></con:testStep><con:testStep type="jdbc" name="contrat resilier" id="56d8fc1c-dc85-4074-80aa-91f2f8a698e2"><con:settings/><con:config xsi:type="con:JdbcRequestTestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:driver>com.mysql.jdbc.Driver</con:driver><con:connectionString>jdbc:mysql://localhost:3306/topaze_test?user=test&amp;password=test</con:connectionString><con:query>select * from  contrat where reference="${preparation-validation#refContrat}" ;</con:query><con:properties/></con:config></con:testStep><con:testStep type="goto" name="go to cancelling" id="2762c2a2-a08a-415e-bd46-14d5980faa69"><con:settings/><con:config xsi:type="con:GotoStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:condition><con:name>end cancellling</con:name><con:type>XPATH</con:type><con:expression>not(//Results/ResultSet/Row/CONTRAT.DATEFINCONTRAT/text())</con:expression><con:targetStep>wait cancelling</con:targetStep></con:condition></con:config></con:testStep><con:testStep type="transfer" name="move ref contrat" id="bab5a393-9014-4e18-8b47-c5ca7e46d4af"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" useXQuery="false" entitize="false" transferChildNodes="false"><con:name>refContrat</con:name><con:sourceType>refContrat</con:sourceType><con:sourceStep>preparation-validation</con:sourceStep><con:targetType>refContrat</con:targetType><con:targetStep>#TestCase#</con:targetStep></con:transfers></con:config></con:testStep><con:properties><con:property><con:name>refContrat</con:name><con:value>005000019</con:value></con:property></con:properties></con:testCase><con:testCase failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="migration" searchProperties="true" id="e1f6b7ab-ad8a-475f-b087-515b66563f51"><con:settings/><con:testStep type="calltestcase" name="preparation-validation" id="10348a2e-18c4-4504-82fb-ebdebd22efcc"><con:settings/><con:config xsi:type="con:RunTestCaseStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:targetTestCase>6c56c18b-08b8-4072-a062-97a144660809</con:targetTestCase><con:properties><con:property><con:name>refContrat</con:name><con:value>002000500</con:value></con:property><con:property><con:name>refCommande</con:name></con:property></con:properties><con:returnProperties><con:entry>refContrat</con:entry></con:returnProperties><con:runMode>PARALLELL</con:runMode></con:config></con:testStep><con:testStep type="restrequest" name="migrer" id="2c6547aa-51a4-4895-b6dc-76a84e59f71d"><con:settings/><con:config service="http://localhost:8081" methodName="Method 1" resourcePath="/contrat-core/contrat/{refContrat}/migrer" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="migrer" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://localhost:8081</con:endpoint><con:request>{
  "user": "test",
  "politiqueMigration": {
    "fraisMigration": "30",
    "fraisResiliation": "true",
    "remboursement": "true",
    "fraisCreation": "true",
    "penalite": "true",
    "reductionAncienne": "true"
  },
  "produitsMigration": [
    {
      "numEC": "2",
      "referenceGammeSource": "",
      "referenceProduitSource": "",
      "referenceGammeDestination": "securite",
      "referenceProduitDestination": "Antivirus.Firewall.6.postes",
      "label": "Abonnement Antivirus Firewall 6 postes",
      "numeroCommande": "Order_migration_avfw_xl",
      "typeProduit": "SERVICE",
      "remboursable": true,
      "prix": {
        "duree" : "12",
        "periodicite": 2,
        "montant": "8",
        "typeTVA": "R",
        "modeFacturation": "DATE_ANNIVERSAIRE"
      },
      "referenceDePaiement": "R0000012",
      "modePaiement": "SEPA"
    }
  ]
}
</con:request><con:originalUri>http://localhost/contrat-core/contrat/00003205/migrer</con:originalUri><con:assertion type="GroovyScriptAssertion" name="Script Assertion" id="65e923bb-81e9-487c-adc1-f07e2d54c13a"><con:configuration><scriptText>assert messageExchange.hasResponse() == false</scriptText></con:configuration></con:assertion><con:assertion type="Valid HTTP Status Codes" name="Valid HTTP Status Codes" id="039948d8-c18c-4d11-a55b-dc7bce99633e"><con:configuration><codes>200</codes></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters><entry key="refContrat" value="${preparation-validation#refContrat}" xmlns="http://eviware.com/soapui/config"/></con:parameters></con:restRequest></con:config></con:testStep><con:testStep type="jdbc" name="Contrat ancient" id="8f891b4c-40a6-4166-ad69-67fbeac86ff4"><con:settings/><con:config xsi:type="con:JdbcRequestTestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:driver>com.mysql.jdbc.Driver</con:driver><con:connectionString>jdbc:mysql://localhost:3306/topaze_test?user=test&amp;password=test</con:connectionString><con:query>select * from contrathistorique where reference =
 "${preparation-validation#refContrat}";</con:query><con:assertion type="XPath Match" name="mm reference"><con:configuration><path>//ResultSet/Row/CONTRATHISTORIQUE.REFERENCE/text()</path><content>${preparation-validation#refContrat}</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:testStep type="jdbc" name="EC ancients" id="1d8d4700-cb2a-4dfd-9498-fb0b16607a31"><con:settings/><con:config xsi:type="con:JdbcRequestTestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:driver>com.mysql.jdbc.Driver</con:driver><con:connectionString>jdbc:mysql://localhost:3306/topaze_test?user=test&amp;password=test</con:connectionString><con:query>select * from elementcontractuelhistorique 
where contratParent=
(select id from contrathistorique where reference =
 "${preparation-validation#refContrat}");</con:query><con:assertion type="XPath Match" name="nombre el historique"><con:configuration><path>count(//Row)</path><content>1</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:testStep type="delay" name="wait end migration" id="d8259ffe-d8f5-4091-a9be-e67f4ec1150b"><con:settings/><con:config><delay>500</delay></con:config></con:testStep><con:testStep type="jdbc" name="Bon migration" id="091990f0-1c98-461d-b70f-7c51a024b7ca"><con:settings/><con:config xsi:type="con:JdbcRequestTestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:driver>com.mysql.jdbc.Driver</con:driver><con:connectionString>jdbc:mysql://localhost:3306/topaze_test?user=test&amp;password=test</con:connectionString><con:query>select * from bonpreparation
where reference ="${preparation-validation#refContrat}"
and typeBonPreparation='MIGRATION'</con:query><con:properties/></con:config></con:testStep><con:testStep type="goto" name="go to migration" id="00c9a1a3-81a1-4e77-b823-fe671e1ea9e0"><con:settings/><con:config xsi:type="con:GotoStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:condition><con:name>migration</con:name><con:type>XPATH</con:type><con:expression>not(//Results/ResultSet/Row/BONPREPARATION.DATELIVRAISONTERMINE/text())
and
not(//Results/ResultSet/Row/BONPREPARATION.DATERETOURTERMINE/text())</con:expression><con:targetStep>wait end migration</con:targetStep></con:condition></con:config></con:testStep><con:testStep type="jdbc" name="bon migration valide" id="fa7c1fcb-b26d-4b47-a837-95bb27d891d8"><con:settings/><con:config xsi:type="con:JdbcRequestTestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:driver>com.mysql.jdbc.Driver</con:driver><con:connectionString>jdbc:mysql://localhost:3306/topaze_test?user=test&amp;password=test</con:connectionString><con:query>select * from bonpreparation
where reference ="${preparation-validation#refContrat}"
and typeBonPreparation='MIGRATION'</con:query><con:assertion type="XPath Match" name="mm reference"><con:configuration><path>//*:BONPREPARATION.REFERENCE/text()</path><content>${preparation-validation#refContrat}</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="XPath Match"><con:configuration><path>//ResultSet/Row/BONPREPARATION.TYPEBONPREPARATION/text()</path><content>MIGRATION</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:testStep type="jdbc" name="el migration" id="ecb2c304-5a1c-49bf-9c75-9afaab8f3488"><con:settings/><con:config xsi:type="con:JdbcRequestTestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:driver>com.mysql.jdbc.Driver</con:driver><con:connectionString>jdbc:mysql://localhost:3306/topaze_test?user=test&amp;password=test</con:connectionString><con:query>select * from elementlivraison where 
bonPreparationparent =(select id from bonpreparation
where reference ="${preparation-validation#refContrat}"
and typeBonPreparation='MIGRATION');</con:query><con:assertion type="XPath Match" name="nombre element"><con:configuration><path>count(//Row)</path><content>2</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XQuery Match" name="acteurs"><con:configuration><path>&lt;Results> 
{ 
 for $x in //Row 
order by $x/ELEMENTLIVRAISON.NUMEC
 return &lt;result>{$x/ELEMENTLIVRAISON.ACTEUR/text()}&lt;/result> 
}
&lt;/Results></path><content><![CDATA[<Results>
  <result>PACKAGER</result>
  <result>PACKAGER</result>
</Results>]]></content><allowWildcards>false</allowWildcards></con:configuration></con:assertion><con:assertion type="XQuery Match" name="type el"><con:configuration><path>&lt;Results> 
{ 
 for $x in //Row 
order by $x/ELEMENTLIVRAISON.NUMEC
 return &lt;result>{$x/ELEMENTLIVRAISON.TYPEBONPREPARATION/text()}&lt;/result> 
}
&lt;/Results></path><content><![CDATA[<Results>
  <result>RETOUR</result>
  <result>LIVRAISON</result>
</Results>]]></content><allowWildcards>false</allowWildcards></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:properties/></con:testCase><con:testCase failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="Error preparation" searchProperties="true" id="0754c117-639c-420a-9e17-87c7de8c6f1c"><con:settings/><con:testStep type="restrequest" name="Sans Ref produit" id="024cf4ca-5293-466a-8562-5524673e25af"><con:settings/><con:config service="http://localhost:8081" methodName="Method 1" resourcePath="/contrat-core/contrat/preparer" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="Sans Ref produit" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://localhost:8081</con:endpoint><con:request>{
  "user": "test",
  "produits": [
    {
      "reference": "",
      "numEC": "1",
      "numeroCommande": "12345678",
      "label": "Abonnement Antivirus Securitoo",
      "remboursable": "true",
      "typeProduit": "SERVICE",
      "prix": {
        "duree": "",
        "periodicite": "1",
        "typeTVA": "R",
        "montant": "5",
        "modePaiement": "SEPA",
        "modeFacturation": "DATE_ANNIVERSAIRE"
      }
    }
  ]
}
</con:request><con:originalUri>http://localhost/contrat-core/contrat/preparer</con:originalUri><con:assertion type="XPath Match" name="ErrorCode" id="fcd09def-50d1-48bd-8511-22c24532e967"><con:configuration><path>//*:errorCode</path><content>0.1.1</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="ErrorMessage" id="90ade3a3-4f1e-434e-8693-3af068015ded" disabled="true"><con:configuration><path>//*:errorMessage</path><content>un des parametres est mal formate : Produit.reference.</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="XPath Match" id="42aa90d0-02b8-4939-a53e-97f6ad858e1f"><con:configuration><path>//*:url</path><content>/contrat-core/contrat/preparer</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="Valid HTTP Status Codes" name="Valid HTTP Status Codes" id="11c80768-0f04-4d71-9254-1b1e7c6d63c5"><con:configuration><codes>500</codes></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:restRequest></con:config></con:testStep><con:testStep type="restrequest" name="Sans Num Cmd" id="563d32e9-6f5b-4644-b2c7-6810c737f02f"><con:settings/><con:config service="http://localhost:8081" methodName="Method 1" resourcePath="/contrat-core/contrat/preparer" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="Sans Num Cmd" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://localhost:8081</con:endpoint><con:request>{
  "user": "test",
  "produits": [
    {
     "reference": "avfwpro-confort-s",
      "numEC": "1",
       "numeroCommande": "",
      "label": "Abonnement Antivirus Securitoo",
      "remboursable": "true",
      "typeProduit": "SERVICE",
      "prix": {
        "duree": "",
        "periodicite": "1",
        "typeTVA": "R",
        "montant": "5",
        "modePaiement": "SEPA",
        "modeFacturation": "DATE_ANNIVERSAIRE"
      }
    }
  ]
}
</con:request><con:originalUri>http://localhost/contrat-core/contrat/preparer</con:originalUri><con:assertion type="XPath Match" name="errorCode" id="1813dfa4-4da0-4748-98d2-2d94d605314c"><con:configuration><path>//*:errorCode</path><content>0.1.1</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="ErrorMessage" id="25784644-424d-4a50-b7e9-f7f864a61f20"><con:configuration><path>//*:errorMessage</path><content>un des parametres est mal formaté : Produit.numeroCommande.</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="url" id="2c3f5cc9-b7f7-40c8-a551-66c30be5e871"><con:configuration><path>//*:url</path><content>/contrat-core/contrat/preparer</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="Valid HTTP Status Codes" name="Valid HTTP Status Codes" id="85b8c916-4ba7-4f26-abbf-564a73988175"><con:configuration><codes>500</codes></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:restRequest></con:config></con:testStep><con:testStep type="restrequest" name="Sans Num EC" id="c32de687-3b17-4796-8938-d8520b92c966"><con:settings/><con:config service="http://localhost:8081" methodName="Method 1" resourcePath="/contrat-core/contrat/preparer" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="Sans Num EC" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://localhost:8081</con:endpoint><con:request>{
  "user": "test",
  "produits": [
    {
"reference": "avfwpro-confort-s",
      "numEC": "",
"numeroCommande": "12345678",
      "label": "Abonnement Antivirus Securitoo",
      "remboursable": "true",
      "typeProduit": "SERVICE",
      "prix": {
        "duree": "",
        "periodicite": "1",
        "typeTVA": "R",
        "montant": "5",
        "modePaiement": "SEPA",
        "modeFacturation": "DATE_ANNIVERSAIRE"
      }
    }
  ]
}
</con:request><con:originalUri>http://localhost/contrat-core/contrat/preparer</con:originalUri><con:assertion type="XPath Match" name="errorCode" id="ab945b85-e880-480f-8a16-fa12eeb76aed"><con:configuration><path>//*:errorCode</path><content>1.1.68</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="errorMessage" id="812de4b3-8b2b-48a1-b2ef-df6cdd61250d"><con:configuration><path>//*:errorMessage</path><content>Le numero d'element contractuel pour le produit avfwpro-confort-s ne doit pas etre null.</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="url" id="e3892048-9f1a-4919-8f91-eae429bd6c54"><con:configuration><path>//*:url</path><content>/contrat-core/contrat/preparer</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="Valid HTTP Status Codes" name="Valid HTTP Status Codes" id="5b8f35e5-9a5c-4c0e-9156-57ec4f94aae5"><con:configuration><codes>500</codes></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:restRequest></con:config></con:testStep><con:testStep type="restrequest" name="Sans Label" id="ed238139-989e-48dc-b54f-520fb60be198"><con:settings/><con:config service="http://localhost:8081" methodName="Method 1" resourcePath="/contrat-core/contrat/preparer" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="Sans Label" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://localhost:8081</con:endpoint><con:request>{
  "user": "test",
  "produits": [
{
"reference": "avfwpro-confort-s",
      "numEC": "1",
"numeroCommande": "12345678",
      "label": "",
      "remboursable": "true",
      "typeProduit": "SERVICE",
      "prix": {
        "duree": "",
        "periodicite": "1",
        "typeTVA": "R",
        "montant": "5",
        "modePaiement": "SEPA",
        "modeFacturation": "DATE_ANNIVERSAIRE"
      }
    }
  ]
}
</con:request><con:originalUri>http://localhost/contrat-core/contrat/preparer</con:originalUri><con:assertion type="XPath Match" name="errorCode" id="bd32c2c0-a770-4b1b-b620-894d4faaafd5"><con:configuration><path>//*:errorCode</path><content>0.1.1</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="ErrorMessage" id="28a377e4-6e6a-4431-b953-f9fcf1ac2513" disabled="true"><con:configuration><path>//*:errorMessage</path><content>un des parametres est mal formate : Produit.label.</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="url" id="46a5c2cd-9e90-44a4-a32f-0e6655ed4fb5"><con:configuration><path>//*:url</path><content>/contrat-core/contrat/preparer</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="Valid HTTP Status Codes" name="Valid HTTP Status Codes" id="61a78ba3-252f-4d96-b412-0477ecb064c3"><con:configuration><codes>500</codes></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:restRequest></con:config></con:testStep><con:testStep type="restrequest" name="Sans type produit" id="e0a7fb76-5cd4-427e-a49a-19063ff68d18"><con:settings/><con:config service="http://localhost:8081" methodName="Method 1" resourcePath="/contrat-core/contrat/preparer" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="Sans type produit" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://localhost:8081</con:endpoint><con:request>{
  "user": "test",
  "produits": [
    {
"reference": "avfwpro-confort-s",
      "numEC": "1",
"numeroCommande": "12345678",
      "label": "Abonnement Antivirus Securitoo",
      "remboursable": "true",
      "typeProduit": "SERVICEBIEN",
      "prix": {
        "duree": "",
        "periodicite": "1",
        "typeTVA": "R",
        "montant": "5",
        "modePaiement": "SEPA",
        "modeFacturation": "DATE_ANNIVERSAIRE"
      }
    }
  ]
}
</con:request><con:originalUri>http://localhost/contrat-core/contrat/preparer</con:originalUri><con:assertion type="XPath Match" name="errorCode" id="2e2642f1-d7b4-403d-a73f-e3e64b9c5ffc"><con:configuration><path>//*:errorCode</path><content>0.1.11</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="errorMessage" id="1506dc19-9b2a-4d63-8fbb-f436bf4332e0"><con:configuration><path>//*:errorMessage</path><content>Le Produit.typeProduit ne peut valoir que [BIEN, SERVICE].</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="url" id="cdd4aaef-aad0-4efe-996c-2b18be9a133d"><con:configuration><path>//*:url</path><content>/contrat-core/contrat/preparer</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="Valid HTTP Status Codes" name="Valid HTTP Status Codes" id="c8ef9765-2177-410b-90a9-c710205ff8a1"><con:configuration><codes>500</codes></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:restRequest></con:config></con:testStep><con:testStep type="restrequest" name="Mode de paiement TROIS FOIS SANS FRAIS" id="b79f9d10-b8ec-4204-8401-530f59bc3628"><con:settings/><con:config service="http://localhost:8081" methodName="Method 1" resourcePath="/contrat-core/contrat/preparer" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="Mode de paiement TROIS FOIS SANS FRAIS" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://localhost:8081</con:endpoint><con:request>{
  "user": "test",
  "produits": [
    {
      "reference": "avfwpro-confort-s",
      "numEC": "1",
"numeroCommande": "12345678",
      "label": "Abonnement Antivirus Securitoo",
      "remboursable": "true",
      "typeProduit": "SERVICE",
      "prix": {
        "duree": "",
        "periodicite": "1",
        "typeTVA": "R",
        "montant": "5",
        "modePaiement": "TROIS_FOIS_SANS_FRAIS",
        "modeFacturation": "DATE_ANNIVERSAIRE"
      }
    }
  ]
}
</con:request><con:originalUri>http://localhost/contrat-core/contrat/preparer</con:originalUri><con:assertion type="XPath Match" name="errorCode" id="c3a94218-7a5b-4353-a6f3-1ff6002c810a"><con:configuration><path>//*:errorCode</path><content>1.1.34</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="errorMessage" id="421f5eb1-39e2-4739-8eba-743db39de479"><con:configuration><path>//*:errorMessage</path><content>un Produit de Type Location ou abonnement ne doit pas Avoir un Mode de Paiement TROIS FOIS SANS FRAIS.</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="url" id="e61e1661-5d25-4350-9583-ed6e90783c2d"><con:configuration><path>//*:url</path><content>/contrat-core/contrat/preparer</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="Valid HTTP Status Codes" name="Valid HTTP Status Codes" id="0c68408c-c921-4fc6-9c36-e2ccc3a851eb"><con:configuration><codes>500</codes></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:restRequest></con:config></con:testStep><con:testStep type="restrequest" name="Sans type TVA" id="f191549f-1b52-4233-8a23-79e0704b0a7f"><con:settings/><con:config service="http://localhost:8081" methodName="Method 1" resourcePath="/contrat-core/contrat/preparer" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="Sans type TVA" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://localhost:8081</con:endpoint><con:request>{
  "user": "test",
  "produits": [
    {
"reference": "avfwpro-confort-s",
      "numEC": "1",
"numeroCommande": "12345678",
      "label": "Abonnement Antivirus Securitoo",
      "remboursable": "true",
      "typeProduit": "SERVICE",
      "prix": {
        "duree": "",
        "periodicite": "1",
        "typeTVA": "",
        "montant": "5",
        "modePaiement": "SEPA",
        "modeFacturation": "DATE_ANNIVERSAIRE"
      }
    }
  ]
}
</con:request><con:originalUri>http://localhost/contrat-core/contrat/preparer</con:originalUri><con:assertion type="XPath Match" name="errorCode" id="f9b14985-a0f5-4a6c-b13f-aedb6d683758"><con:configuration><path>//*:errorCode</path><content>0.1.11</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="errorMessage" id="3f029738-fb49-47d5-a746-cb747b31ef39"><con:configuration><path>//*:errorMessage</path><content>Le Prix.typeTVA ne peut valoir que [S, R, SR, P].</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="url" id="5cda8075-eb83-4fcf-9837-bbecd3673e6a"><con:configuration><path>//*:url</path><content>/contrat-core/contrat/preparer</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="Valid HTTP Status Codes" name="Valid HTTP Status Codes" id="a7c5c8da-b0df-4178-85fe-0d11edcb27a0"><con:configuration><codes>500</codes></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:restRequest></con:config></con:testStep><con:testStep type="restrequest" name="Differente periodicite" id="88c6ae01-5fe4-496e-bdf3-a9b68da79821"><con:settings/><con:config service="http://localhost:8081" methodName="Method 1" resourcePath="/contrat-core/contrat/preparer" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="Differente periodicite" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://localhost:8081</con:endpoint><con:request>{
  "user": "test",
  "produits": [
    {
      "reference": "avfwpro-confort-s",
      "numEC": "1",
      "numeroCommande": "12345678",
      "label": "Abonnement Antivirus Securitoo",
      "remboursable": "true",
      "typeProduit": "SERVICE",
      "prix": {
        "duree": "",
        "periodicite": "1",
        "typeTVA": "R",
        "montant": "5",
        "modePaiement": "SEPA",
        "modeFacturation": "DATE_ANNIVERSAIRE"
      }
    },
   {
      "reference": "option.plus",
      "numEC": "2",
      "numeroCommande": "12345678",
      "label": "Abonnement option plus",
      "remboursable": "true",
      "typeProduit": "SERVICE",
      "prix": {
        "duree": "",
        "periodicite": "2",
        "typeTVA": "R",
        "montant": "3",
        "modePaiement": "SEPA",
        "modeFacturation": "DATE_ANNIVERSAIRE"
      }
    }
  ]
}
</con:request><con:originalUri>http://localhost/contrat-core/contrat/preparer</con:originalUri><con:assertion type="XPath Match" name="errorCode" id="f8042b79-6f71-4658-b2bd-f32a39dddf68"><con:configuration><path>//*:errorCode</path><content>1.1.136</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="errorMessage" id="862e3e24-55c4-4c76-90cf-f95bb15bfe36"><con:configuration><path>//*:errorMessage</path><content>Tous les elements contractuel doivent avoir la meme periodicite.</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="url" id="4690b88a-99f9-46cd-a6c4-21217d567210"><con:configuration><path>//*:url</path><content>/contrat-core/contrat/preparer</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="Valid HTTP Status Codes" name="Valid HTTP Status Codes" id="f248f397-1fc6-4c17-8ca5-aed0481cb7b5"><con:configuration><codes>500</codes></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:restRequest></con:config></con:testStep><con:testStep type="restrequest" name="Differente mode de facturation" id="f7c86a42-8432-4fce-ac84-0e5cd7f0d486"><con:settings/><con:config service="http://localhost:8081" methodName="Method 1" resourcePath="/contrat-core/contrat/preparer" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="Differente mode de facturation" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://localhost:8081</con:endpoint><con:request>{
  "user": "test",
  "produits": [
    {
      "reference": "avfwpro-confort-s",
      "numEC": "1",
      "numeroCommande": "12345678",
      "label": "Abonnement Antivirus Securitoo",
      "remboursable": "true",
      "typeProduit": "SERVICE",
      "prix": {
        "duree": "",
        "periodicite": "1",
        "typeTVA": "R",
        "montant": "5",
        "modePaiement": "SEPA",
        "modeFacturation": "DATE_ANNIVERSAIRE"
      }
    },
   {
      "reference": "option.plus",
      "numEC": "2",
      "numeroCommande": "12345678",
      "label": "Abonnement option plus",
      "remboursable": "true",
      "typeProduit": "SERVICE",
      "prix": {
        "duree": "",
        "periodicite": "1",
        "typeTVA": "R",
        "montant": "3",
        "modePaiement": "SEPA",
        "modeFacturation": "PREMIER_MOIS"
      }
    }
  ]
}
</con:request><con:originalUri>http://localhost/contrat-core/contrat/preparer</con:originalUri><con:assertion type="XPath Match" name="XPath Match" id="b0c80768-766d-4f84-b9c3-1fa48826fb22"><con:configuration><path>//*:errorCode</path><content>1.1.137</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="errorMessage" id="f1c0d455-7533-46a8-8b84-5174d8d81bc8"><con:configuration><path>//*:errorMessage</path><content>Tous les elements contractuel doivent avoir le meme mode de facturation.</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="url" id="0bc51e25-c5f5-48b8-94d4-fc495565de70"><con:configuration><path>//*:url</path><content>/contrat-core/contrat/preparer</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="Valid HTTP Status Codes" name="Valid HTTP Status Codes" id="d7f4e2ce-b6be-4a62-b590-eff4a0f8e9ed"><con:configuration><codes>500</codes></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:restRequest></con:config></con:testStep><con:testStep type="restrequest" name="Sans Mode de paiement" id="6a0aeabe-d5e3-4123-8632-197e5ca37a6f"><con:settings/><con:config service="http://localhost:8081" methodName="Method 1" resourcePath="/contrat-core/contrat/preparer" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="Sans Mode de paiement" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://localhost:8081</con:endpoint><con:request>{
  "user": "test",
  "produits": [
    {
"reference": "avfwpro-confort-s",
      "numEC": "1",
"numeroCommande": "12345678",
      "label": "Abonnement Antivirus Securitoo",
      "remboursable": "true",
      "typeProduit": "SERVICE",
      "prix": {
        "duree": "",
        "periodicite": "1",
        "typeTVA": "R",
        "montant": "5",
        "modePaiement": "",
        "modeFacturation": "DATE_ANNIVERSAIRE"
      }
    }
  ]
}
</con:request><con:originalUri>http://localhost/contrat-core/contrat/preparer</con:originalUri><con:assertion type="XPath Match" name="errorCode" id="eee4c4f7-1589-4026-ae58-eb7b1dcaada7"><con:configuration><path>//*:errorCode</path><content>0.1.11</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="errorMesage" id="bf1caf1c-4fe5-42f0-a4a0-bde545ab665b" disabled="true"><con:configuration><path>//*:errorMessage</path><content>Le Prix.modePaiement ne peut valoir que [SEPA, CB, CHEQUE, FACTURE, TROIS_FOIS_SANS_FRAIS, FACTURE_FIN_DE_MOIS].</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="url" id="e4f7479c-af15-41fb-ab06-71ac05b82e23"><con:configuration><path>//*:url</path><content>/contrat-core/contrat/preparer</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="Valid HTTP Status Codes" name="Valid HTTP Status Codes" id="6f45bbd7-c47a-43dc-83aa-e17916b970f0"><con:configuration><codes>500</codes></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:restRequest></con:config></con:testStep><con:testStep type="restrequest" name="Sans Mode facturation" id="200cec96-fba0-4b97-8ba9-ae39319f589b"><con:settings/><con:config service="http://localhost:8081" methodName="Method 1" resourcePath="/contrat-core/contrat/preparer" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="Sans Mode facturation" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://localhost:8081</con:endpoint><con:request>{
  "user": "test",
  "produits": [
    {
"reference": "avfwpro-confort-s",
      "numEC": "1",
"numeroCommande": "12345678",
      "label": "Abonnement Antivirus Securitoo",
      "remboursable": "true",
      "typeProduit": "SERVICE",
      "prix": {
        "duree": "",
        "periodicite": "1",
        "typeTVA": "R",
        "montant": "5",
        "modePaiement": "SEPA",
        "modeFacturation": ""
      }
    }
  ]
}
</con:request><con:originalUri>http://localhost/contrat-core/contrat/preparer</con:originalUri><con:assertion type="XPath Match" name="errorCode" id="f4f08f8d-295c-4502-a143-505db18ae819"><con:configuration><path>//*:errorCode</path><content>0.1.11</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="errorMessage" id="a3700f2a-2993-4509-a427-d4ed01033cc1"><con:configuration><path>//*:errorMessage</path><content>Le Prix.modeFacturation ne peut valoir que [PREMIER_MOIS, DATE_ANNIVERSAIRE].</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="url" id="b78b7723-a53a-4581-aab2-c68c3d773fdf"><con:configuration><path>//*:url</path><content>/contrat-core/contrat/preparer</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="Valid HTTP Status Codes" name="Valid HTTP Status Codes" id="b8348e47-3f7d-445e-9a2f-cf004531b930"><con:configuration><codes>500</codes></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:restRequest></con:config></con:testStep><con:testStep type="restrequest" name="Sans User" id="e269cbaf-cf8b-4fb8-8c36-93e084598b3b"><con:settings/><con:config service="http://localhost:8081" methodName="Method 1" resourcePath="/contrat-core/contrat/preparer" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="Sans User" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://localhost:8081</con:endpoint><con:request>{
  "user": "",
  "produits": [
    {
      "reference": "avfwpro-confort-s",
"numEC": "1",
"numeroCommande": "12345678",
      "label": "Abonnement Antivirus Securitoo",
      "remboursable": "true",
      "typeProduit": "SERVICE",
      "prix": {
        "duree": "",
        "periodicite": "1",
        "typeTVA": "R",
        "montant": "5",
        "modePaiement": "SEPA",
        "modeFacturation": "DATE_ANNIVERSAIRE"
      }
    }
  ]
}
</con:request><con:originalUri>http://localhost/contrat-core/contrat/preparer</con:originalUri><con:assertion type="XPath Match" name="errorCode" id="c9b0f251-55bd-45f7-ad1c-4bfe6acdee73"><con:configuration><path>//*:errorCode</path><content>1.1.91</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="errorMessage" id="50d4a878-15e8-4ff4-9fd2-e485c7778890"><con:configuration><path>//*:errorMessage</path><content>L'element user est obligatoire.</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="url" id="079531e5-b65a-4c62-8d84-01992ad4e8ae"><con:configuration><path>//*:url</path><content>/contrat-core/contrat/preparer</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="Valid HTTP Status Codes" name="Valid HTTP Status Codes" id="e1c03285-defb-4462-b943-84e178d83026"><con:configuration><codes>500</codes></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:restRequest></con:config></con:testStep><con:properties/></con:testCase><con:testCase failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="Preparation contrat sans frais" searchProperties="true" id="a6758843-8531-4e0c-9a25-cf77decbec4f"><con:settings/><con:testStep type="restrequest" name="preparation" id="43451e2b-4d6f-4c3e-8a3a-33b575527616"><con:settings/><con:config service="http://localhost:8081" methodName="Method 1" resourcePath="/contrat-core/contrat/preparer" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="preparation" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://localhost:8081</con:endpoint><con:request>{
  "user": "test-prepa",
  "produits": [
    {
"reference": "avfwpro-confort-s",
      "numEC": "1",
"numeroCommande": "12345678",
      "label": "Abonnement Antivirus Securitoo",
      "remboursable": "true",
      "typeProduit": "SERVICE",
      "prix": {
        "duree": "",
        "periodicite": "1",
        "typeTVA": "R",
        "montant": "5",
        "modePaiement": "SEPA",
        "modeFacturation": "DATE_ANNIVERSAIRE"
      }
    }
  ]
}
</con:request><con:originalUri>http://localhost/contrat-core/contrat/preparer</con:originalUri><con:assertion type="Valid HTTP Status Codes" name="Valid HTTP Status Codes"><con:configuration><codes>200</codes></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:restRequest></con:config></con:testStep><con:testStep type="transfer" name="move ref contrat" id="ff82067f-94ce-4d8a-840d-92e37580e9df"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" useXQuery="false" entitize="false" transferChildNodes="false"><con:name>refContrat</con:name><con:sourceType>ResponseAsXml</con:sourceType><con:sourceStep>preparation</con:sourceStep><con:sourcePath>//*:referenceContrat</con:sourcePath><con:targetType>refContrat</con:targetType><con:targetStep>#TestCase#</con:targetStep></con:transfers></con:config></con:testStep><con:properties><con:property><con:name>refContrat</con:name><con:value>068000000</con:value></con:property></con:properties></con:testCase><con:testCase failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="Error validation" searchProperties="true" id="6b780b28-c924-499c-a66b-598955a9f1ab"><con:settings/><con:testStep type="calltestcase" name="preparation"><con:settings/><con:config xsi:type="con:RunTestCaseStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:targetTestCase>621887f4-565f-4013-bd4a-24e3e4c41a1e</con:targetTestCase><con:properties><con:property><con:name>RefCommande</con:name><con:value>19d193d6-8be1-4057-ad30-0061df6f97f2</con:value></con:property><con:property><con:name>refContrat</con:name><con:value>000007000</con:value></con:property></con:properties><con:returnProperties><con:entry>RefCommande</con:entry><con:entry>refContrat</con:entry></con:returnProperties><con:runMode>PARALLELL</con:runMode></con:config></con:testStep><con:testStep type="restrequest" name="Ref contrat erronee"><con:settings/><con:config service="http://localhost:8081" methodName="Method 1" resourcePath="/contrat-core/contrat/{refContrat}/valider" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="Ref contrat erronee" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://localhost:8081</con:endpoint><con:request>{
  "user": "test",
  "idClient": "",
  "idAdrFacturation": "685",
  "paiementInfos": [
    {
      "referenceProduit": "avfwpro-confort-s",
      "numEC": "1",
      "referenceModePaiement": "R0000012",
      "idAdrLivraison": "adrliv1"
    }
  ],
  "politiqueValidation": {
    "fraisCreation": "true",
    "checkIsPackagerCreationPossible": "true"
  }
}
</con:request><con:originalUri>http://localhost/contrat-core/contrat//valider</con:originalUri><con:assertion type="Valid HTTP Status Codes" name="Valid HTTP Status Codes"><con:configuration><codes>500</codes></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters><entry key="refContrat" value="1111111111111" xmlns="http://eviware.com/soapui/config"/></con:parameters></con:restRequest></con:config></con:testStep><con:testStep type="restrequest" name="Sans idClient"><con:settings/><con:config service="http://localhost:8081" methodName="Method 1" resourcePath="/contrat-core/contrat/{refContrat}/valider" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="Sans idClient" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://localhost:8081</con:endpoint><con:request>{
  "user": "test",
  "idClient": "",
  "idAdrFacturation": "685",
  "paiementInfos": [
    {
      "referenceProduit": "avfwpro-confort-s",
      "numEC": "1",
      "referenceModePaiement": "R0000012",
      "idAdrLivraison": "adrliv1"
    }
  ],
  "politiqueValidation": {
    "fraisCreation": "true",
    "checkIsPackagerCreationPossible": "true"
  }
}
</con:request><con:originalUri>http://localhost/contrat-core/contrat/00003181/valider</con:originalUri><con:assertion type="XPath Match" name="XPath Match"><con:configuration><path>//*:errorCode</path><content>0.1.1</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="errormessage" disabled="true"><con:configuration><path>//*:errorMessage</path><content>un des parametres est mal formate : Contrat.idClient.</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="url"><con:configuration><path>//*:url</path><content>/contrat-core/contrat/${preparation#refContrat}/valider</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="Valid HTTP Status Codes" name="Valid HTTP Status Codes"><con:configuration><codes>500</codes></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters><entry key="refContrat" value="${preparation#refContrat}" xmlns="http://eviware.com/soapui/config"/></con:parameters></con:restRequest></con:config></con:testStep><con:testStep type="restrequest" name="Sans idAdreFacturation"><con:settings/><con:config service="http://localhost:8081" methodName="Method 1" resourcePath="/contrat-core/contrat/{refContrat}/valider" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="Sans idAdreFacturation" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://localhost:8081</con:endpoint><con:request>{
  "user": "test",
  "idClient": "00003870",
  "idAdrFacturation": "",
  "paiementInfos": [
    {
      "referenceProduit": "avfwpro-confort-s",
      "numEC": "1",
      "referenceModePaiement": "R0000012",
      "idAdrLivraison": "adrliv1"
    }
  ],
  "politiqueValidation": {
    "fraisCreation": "true",
    "checkIsPackagerCreationPossible": "true"
  }
}
</con:request><con:originalUri>http://localhost/contrat-core/contrat/refContrat/valider</con:originalUri><con:assertion type="XPath Match" name="errorCode"><con:configuration><path>//*:errorCode</path><content>0.1.1</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="errorMessage" disabled="true"><con:configuration><path>//*:errorMessage</path><content>un des parametres est mal formate : Contrat.idAdrFacturation.</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="url"><con:configuration><path>//*:url</path><content>/contrat-core/contrat/${preparation#refContrat}/valider</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="Valid HTTP Status Codes" name="Valid HTTP Status Codes"><con:configuration><codes>500</codes></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters><entry key="refContrat" value="${preparation#refContrat}" xmlns="http://eviware.com/soapui/config"/></con:parameters></con:restRequest></con:config></con:testStep><con:testStep type="restrequest" name="Sans ref produit"><con:settings/><con:config service="http://localhost:8081" methodName="Method 1" resourcePath="/contrat-core/contrat/{refContrat}/valider" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="Sans ref produit" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://localhost:8081</con:endpoint><con:request>{
  "user": "test",
  "idClient": "00003870",
  "segmentTVA": "00",
  "idAdrFacturation": "685",
  "paiementInfos": [
    {	
      "referenceProduit": "",
      "numEC": "1",
      "referenceModePaiement": "R0000012",
      "idAdrLivraison": "adrliv1"
    }
  ],
  "politiqueValidation": {
    "fraisCreation": "true",
    "checkIsPackagerCreationPossible": "true"
  }
}
</con:request><con:originalUri>http://localhost/contrat-core/contrat/refContrat/valider</con:originalUri><con:assertion type="XPath Match" name="errorCode"><con:configuration><path>//*:errorCode</path><content>1.1.31</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="errorMessage" disabled="true"><con:configuration><path>//*:errorMessage</path><content>Les même numeros d'element contractuel et References  utilisees lors de la preparation doivent être utilisees lors de validation.</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="url"><con:configuration><path>//*:url</path><content>/contrat-core/contrat/${preparation#refContrat}/valider</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="Valid HTTP Status Codes" name="Valid HTTP Status Codes"><con:configuration><codes>500</codes></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters><entry key="refContrat" value="${preparation#refContrat}" xmlns="http://eviware.com/soapui/config"/></con:parameters></con:restRequest></con:config></con:testStep><con:testStep type="restrequest" name="Sans NumEC"><con:settings/><con:config service="http://localhost:8081" methodName="Method 1" resourcePath="/contrat-core/contrat/{refContrat}/valider" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="Sans NumEC" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://localhost:8081</con:endpoint><con:request>{
  "user": "test",
  "idClient": "00003870",
  "segmentTVA": "00",
  "idAdrFacturation": "685",
  "paiementInfos": [
    {
      "referenceProduit": "avfwpro-confort-s",
      "numEC": "",
      "referenceModePaiement": "R0000012",
      "idAdrLivraison": "adrliv1"
    }
  ],
  "politiqueValidation": {
    "fraisCreation": "true",
    "checkIsPackagerCreationPossible": "true"
  }
}
</con:request><con:originalUri>http://localhost/contrat-core/contrat/00003181/valider</con:originalUri><con:assertion type="XPath Match" name="XPath Match"><con:configuration><path>//*:errorCode</path><content>1.1.31</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="errorMessage" disabled="true"><con:configuration><path>//*:errorMessage</path><content>Les même numeros d'element contractuel et References  utilisees lors de la preparation doivent être utilisees lors de validation.</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="url"><con:configuration><path>//*:url</path><content>/contrat-core/contrat/${preparation#refContrat}/valider</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="Valid HTTP Status Codes" name="Valid HTTP Status Codes"><con:configuration><codes>500</codes></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters><entry key="refContrat" value="${preparation#refContrat}" xmlns="http://eviware.com/soapui/config"/></con:parameters></con:restRequest></con:config></con:testStep><con:testStep type="restrequest" name="Sans ref mode de paiement"><con:settings/><con:config service="http://localhost:8081" methodName="Method 1" resourcePath="/contrat-core/contrat/{refContrat}/valider" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="Sans ref mode de paiement" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://localhost:8081</con:endpoint><con:request>{
  "user": "test",
  "idClient": "00003870",
  "segmentTVA": "00",
  "idAdrFacturation": "685",
  "paiementInfos": [
    {
      "referenceProduit": "avfwpro-confort-s",
      "numEC": "1",
      "referenceModePaiement": "",
      "idAdrLivraison": "adrliv1"
    }
  ],
  "politiqueValidation": {
    "fraisCreation": "true",
    "checkIsPackagerCreationPossible": "true"
  }
}
</con:request><con:originalUri>http://localhost/contrat-core/contrat/refContrat/valider</con:originalUri><con:assertion type="XPath Match" name="errorCode"><con:configuration><path>//*:errorCode</path><content>1.1.37</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="errorMessage" disabled="true"><con:configuration><path>//*:errorMessage</path><content>la Reference de Mode paiement est obligatoire pour les mode de paiement de type  SEPA, FACTURE ou FACTURE FIN DE MOIS .</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="url"><con:configuration><path>//*:url</path><content>/contrat-core/contrat/${preparation#refContrat}/valider</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="Valid HTTP Status Codes" name="Valid HTTP Status Codes"><con:configuration><codes>500</codes></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters><entry key="refContrat" value="${preparation#refContrat}" xmlns="http://eviware.com/soapui/config"/></con:parameters></con:restRequest></con:config></con:testStep><con:testStep type="restrequest" name="Sans adresse livraison"><con:settings/><con:config service="http://localhost:8081" methodName="Method 1" resourcePath="/contrat-core/contrat/{refContrat}/valider" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="Sans adresse livraison" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://localhost:8081</con:endpoint><con:request>{
  "user": "test",
  "idClient": "00003870",
  "segmentTVA": "00",
  "idAdrFacturation": "685",
  "paiementInfos": [
    {
      "referenceProduit": "avfwpro-confort-s",
      "numEC": "1",
      "referenceModePaiement": "R0000012",
      "idAdrLivraison": ""
    }
  ],
  "politiqueValidation": {
    "fraisCreation": "true",
    "checkIsPackagerCreationPossible": "true"
  }
}
</con:request><con:originalUri>http://localhost/contrat-core/contrat/refContrat/valider</con:originalUri><con:assertion type="XPath Match" name="XPath Match"><con:configuration><path>//*:errorCode</path><content>0.1.1</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="errorMessage" disabled="true"><con:configuration><path>//*:errorMessage</path><content>un des parametres est mal formate : paiementInfo.idAdrLivraison.</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="url"><con:configuration/></con:assertion><con:assertion type="Valid HTTP Status Codes" name="Valid HTTP Status Codes"><con:configuration><codes>500</codes></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters><entry key="refContrat" value="${preparation#refContrat}" xmlns="http://eviware.com/soapui/config"/></con:parameters></con:restRequest></con:config></con:testStep><con:testStep type="restrequest" name="Sans politique de validation"><con:settings/><con:config service="http://localhost:8081" methodName="Method 1" resourcePath="/contrat-core/contrat/{refContrat}/valider" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="Sans politique de validation" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://localhost:8081</con:endpoint><con:request>{
  "user": "test",
  "idClient": "00003870",
  "segmentTVA": "00",
  "idAdrFacturation": "685",
  "paiementInfos": [
    {
      "referenceProduit": "avfwpro-confort-s",
      "numEC": "1",
      "referenceModePaiement": "R0000012",
      "idAdrLivraison": ""
    }
  ]
}
</con:request><con:originalUri>http://localhost/contrat-core/contrat/refContrat/valider</con:originalUri><con:assertion type="XPath Match" name="XPath Match"><con:configuration><path>//*:errorCode</path><content>1.1.17</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="errorMessage" disabled="true"><con:configuration><path>//*:errorMessage</path><content>La politique de validation est obligatoire.</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="url"><con:configuration><path>//*:url</path><content>/contrat-core/contrat/${preparation#refContrat}/valider</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="Valid HTTP Status Codes" name="Valid HTTP Status Codes"><con:configuration><codes>500</codes></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters><entry key="refContrat" value="${preparation#refContrat}" xmlns="http://eviware.com/soapui/config"/></con:parameters></con:restRequest></con:config></con:testStep><con:testStep type="restrequest" name="Sans frais de creation"><con:settings/><con:config service="http://localhost:8081" methodName="Method 1" resourcePath="/contrat-core/contrat/{refContrat}/valider" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="Sans frais de creation" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://localhost:8081</con:endpoint><con:request>{
  "user": "test",
  "idClient": "00003870",
  "segmentTVA": "00",
  "idAdrFacturation": "685",
  "paiementInfos": [
    {
      "referenceProduit": "avfwpro-confort-s",
      "numEC": "1",
      "referenceModePaiement": "R0000012",
      "idAdrLivraison": ""
    }
  ],
  "politiqueValidation": {
    "fraisCreation": "",
    "checkIsPackagerCreationPossible": "true"
  }
}
</con:request><con:originalUri>http://localhost/contrat-core/contrat/00003181/valider</con:originalUri><con:assertion type="XPath Match" name="XPath Match"><con:configuration><path>//*:errorCode</path><content>0.1.1</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="errorMessage" disabled="true"><con:configuration><path>//*:errorMessage</path><content>un des parametres est mal formate : PolitiqueValidation.fraisCreation.</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="url"><con:configuration><path>//*:url</path><content>/contrat-core/contrat/${preparation#refContrat}/valider</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="Valid HTTP Status Codes" name="Valid HTTP Status Codes"><con:configuration><codes>500</codes></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters><entry key="refContrat" value="${preparation#refContrat}" xmlns="http://eviware.com/soapui/config"/></con:parameters></con:restRequest></con:config></con:testStep><con:testStep type="restrequest" name="Sans checkIsPackagerCreationPossible"><con:settings/><con:config service="http://localhost:8081" methodName="Method 1" resourcePath="/contrat-core/contrat/{refContrat}/valider" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="Sans checkIsPackagerCreationPossible" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://localhost:8081</con:endpoint><con:request>{
  "user": "test",
  "idClient": "00003870",
  "segmentTVA": "00",
  "idAdrFacturation": "685",
  "paiementInfos": [
    {
      "referenceProduit": "avfwpro-confort-s",
      "numEC": "1",
      "referenceModePaiement": "R0000012",
      "idAdrLivraison": ""
    }
  ],
  "politiqueValidation": {
    "fraisCreation": "true",
    "checkIsPackagerCreationPossible": ""
  }
}
</con:request><con:originalUri>http://localhost/contrat-core/contrat/00003181/valider</con:originalUri><con:assertion type="XPath Match" name="errorCode"><con:configuration><path>//*:errorCode</path><content>0.1.1</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="errorMessage" disabled="true"><con:configuration><path>//*:errorMessage</path><content>un des parametres est mal formate : PolitiqueValidation.checkIsPackagerCreationPossible.</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="url"><con:configuration><path>//*:url</path><content>/contrat-core/contrat/${preparation#refContrat}/valider</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="Valid HTTP Status Codes" name="Valid HTTP Status Codes"><con:configuration><codes>500</codes></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters><entry key="refContrat" value="${preparation#refContrat}" xmlns="http://eviware.com/soapui/config"/></con:parameters></con:restRequest></con:config></con:testStep><con:testStep type="restrequest" name="sans segment TVA"><con:settings/><con:config service="http://localhost:8081" resourcePath="/contrat-core/contrat/{refContrat}/valider" methodName="Method 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="sans segment TVA" mediaType="application/json" postQueryString="false" id="2f9095be-b9f7-4881-8ee1-74542c5d8d83"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>http://localhost:8081</con:endpoint><con:request>{
  "user": "test",
  "idClient": "00003870",
  "idAdrFacturation": "685",
  "paiementInfos": [
    {
      "referenceProduit": "avfwpro-confort-s",
      "numEC": "1",
      "referenceModePaiement": "R0000012",
      "idAdrLivraison": "adrliv1"
    }
  ],
  "politiqueValidation": {
    "fraisCreation": "true",
    "checkIsPackagerCreationPossible": "true"
  }
}</con:request><con:originalUri>http://localhost/contrat-core/contrat/00003177/valider</con:originalUri><con:assertion type="XPath Match" name="code erreur"><con:configuration><path>//*:Fault/*:errorCode</path><content>0.1.4</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters><entry key="refContrat" value="${preparation#refContrat}" xmlns="http://eviware.com/soapui/config"/></con:parameters></con:restRequest></con:config></con:testStep><con:testStep type="restrequest" name="segment TVA non valide"><con:settings/><con:config service="http://localhost:8081" resourcePath="/contrat-core/contrat/{refContrat}/valider" methodName="Method 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="segment TVA non valide" mediaType="application/json" postQueryString="false" id="2f9095be-b9f7-4881-8ee1-74542c5d8d83"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>http://localhost:8081</con:endpoint><con:request>{
  "user": "test",
  "idClient": "00003870",
  "segmentTVA": "123",
  "idAdrFacturation": "685",
  "paiementInfos": [
    {
      "referenceProduit": "avfwpro-confort-s",
      "numEC": "1",
      "referenceModePaiement": "R0000012",
      "idAdrLivraison": "adrliv1"
    }
  ],
  "politiqueValidation": {
    "fraisCreation": "true",
    "checkIsPackagerCreationPossible": "true"
  }
}</con:request><con:originalUri>http://localhost/contrat-core/contrat/00003177/valider</con:originalUri><con:assertion type="XPath Match" name="code erreur"><con:configuration><path>//*:Fault/*:errorCode</path><content>1.1.142</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters><entry key="refContrat" value="${preparation#refContrat}" xmlns="http://eviware.com/soapui/config"/></con:parameters></con:restRequest></con:config></con:testStep><con:properties/></con:testCase><con:testCase failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="Error reduction" searchProperties="true" id="ded0dc48-000b-479c-bf60-9f14b664bd56"><con:settings/><con:testStep type="calltestcase" name="preparation"><con:settings/><con:config xsi:type="con:RunTestCaseStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:targetTestCase>621887f4-565f-4013-bd4a-24e3e4c41a1e</con:targetTestCase><con:properties><con:property><con:name>RefCommande</con:name><con:value>1cf0fd6b-d16a-4d4c-93bb-5e1da70eeb20</con:value></con:property><con:property><con:name>refContrat</con:name><con:value>003000080</con:value></con:property></con:properties><con:returnProperties><con:entry>RefCommande</con:entry><con:entry>refContrat</con:entry></con:returnProperties><con:runMode>PARALLELL</con:runMode></con:config></con:testStep><con:testStep type="restrequest" name="Sans Valeur"><con:settings/><con:config service="http://localhost:8081" methodName="Method 1" resourcePath="/contrat-core/contrat/{refContrat}/reduction/ajouter" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="Sans Valeur" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://localhost:8081</con:endpoint><con:request>{
  "reduction": {
    "valeur": "",
    "isAffichableSurFacture": "true",
    "dateFin": "",
    "nbUtilisationMax": "3",
    "titre": "red-global-test",
    "dateDebut": "",
    "typeReduction": "CONTRAT",
    "typeValeur": "MOIS",
    "typeFrais": ""
  },
  "user": "testeur-red"
}
</con:request><con:originalUri>http://localhost/contrat-core/contrat/00003188/reduction/ajouter</con:originalUri><con:assertion type="XPath Match" name="errorCode"><con:configuration><path>//*:errorCode</path><content>0.1.4</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="errorMessage"><con:configuration><path>//*:errorMessage</path><content>Reduction.valeur ne peut pas etre null.</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="url"><con:configuration><path>//*:url</path><content>/contrat-core/contrat/${preparation#refContrat}/reduction/ajouter</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="Valid HTTP Status Codes" name="Valid HTTP Status Codes"><con:configuration><codes>500</codes></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters><entry key="refContrat" value="${preparation#refContrat}" xmlns="http://eviware.com/soapui/config"/></con:parameters></con:restRequest></con:config></con:testStep><con:testStep type="restrequest" name="Sans isAffichableSurFacture"><con:settings/><con:config service="http://localhost:8081" methodName="Method 1" resourcePath="/contrat-core/contrat/{refContrat}/reduction/ajouter" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="Sans isAffichableSurFacture" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://localhost:8081</con:endpoint><con:request>{
  "reduction": {
    "valeur": "1",
    "isAffichableSurFacture": "",
    "dateFin": "",
    "nbUtilisationMax": "3",
    "titre": "red-global-test",
    "dateDebut": "",
    "typeReduction": "CONTRAT",
    "typeValeur": "MOIS",
    "typeFrais": ""
  },
  "user": "testeur-red"
}</con:request><con:originalUri>http://localhost/contrat-core/contrat/00003183/reduction/ajouter</con:originalUri><con:assertion type="XPath Match" name="errorCode"><con:configuration><path>//*:errorCode</path><content>0.1.1</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="errorMessage" disabled="true"><con:configuration><path>//*:errorMessage</path><content>un des parametres est mal formate : Reduction.isAffichableSurFacture.</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="url"><con:configuration><path>//*:url</path><content>/contrat-core/contrat/${preparation#refContrat}/reduction/ajouter</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="Valid HTTP Status Codes" name="Valid HTTP Status Codes"><con:configuration><codes>500</codes></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters><entry key="refContrat" value="${preparation#refContrat}" xmlns="http://eviware.com/soapui/config"/></con:parameters></con:restRequest></con:config></con:testStep><con:testStep type="restrequest" name="Sans type reduction"><con:settings/><con:config service="http://localhost:8081" methodName="Method 1" resourcePath="/contrat-core/contrat/{refContrat}/reduction/ajouter" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="Sans type reduction" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://localhost:8081</con:endpoint><con:request>{
  "reduction": {
    "valeur": "1",
    "isAffichableSurFacture": "true",
    "dateFin": "",
    "nbUtilisationMax": "3",
    "titre": "red-global-test",
    "dateDebut": "",
    "typeReduction": "",
    "typeValeur": "MOIS",
    "typeFrais": ""
  },
  "user": "testeur-red"
}
</con:request><con:originalUri>http://localhost/contrat-core/contrat/00003183/reduction/ajouter</con:originalUri><con:assertion type="XPath Match" name="errorCode"><con:configuration><path>//*:errorCode</path><content>0.1.1</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="errorMessage" disabled="true"><con:configuration><path>//*:errorMessage</path><content>un des parametres est mal formate : Reduction.typeReduction.</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="url"><con:configuration><path>//*:url</path><content>/contrat-core/contrat/${preparation#refContrat}/reduction/ajouter</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="Valid HTTP Status Codes" name="Valid HTTP Status Codes"><con:configuration><codes>500</codes></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters><entry key="refContrat" value="${preparation#refContrat}" xmlns="http://eviware.com/soapui/config"/></con:parameters></con:restRequest></con:config></con:testStep><con:testStep type="restrequest" name="Sans type valeur"><con:settings/><con:config service="http://localhost:8081" methodName="Method 1" resourcePath="/contrat-core/contrat/{refContrat}/reduction/ajouter" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="Sans type valeur" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://localhost:8081</con:endpoint><con:request>{
  "reduction": {
    "valeur": "1",
    "isAffichableSurFacture": "true",
    "dateFin": "",
    "nbUtilisationMax": "3",
    "titre": "red-global-test",
    "dateDebut": "",
    "typeReduction": "CONTRAT",
    "typeValeur": "",
    "typeFrais": ""
  },
  "user": "testeur-red"
}
</con:request><con:originalUri>http://localhost/contrat-core/contrat/00003183/reduction/ajouter</con:originalUri><con:assertion type="XPath Match" name="errorCode"><con:configuration><path>//*:errorCode</path><content>0.1.1</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="errorMessage" disabled="true"><con:configuration><path>//*:errorMessage</path><content>un des parametres est mal formate : Reduction.typeValeur.</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="url"><con:configuration><path>//*:url</path><content>/contrat-core/contrat/${preparation#refContrat}/reduction/ajouter</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="Valid HTTP Status Codes" name="Valid HTTP Status Codes"><con:configuration><codes>500</codes></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters><entry key="refContrat" value="${preparation#refContrat}" xmlns="http://eviware.com/soapui/config"/></con:parameters></con:restRequest></con:config></con:testStep><con:testStep type="restrequest" name="Sans user"><con:settings/><con:config service="http://localhost:8081" methodName="Method 1" resourcePath="/contrat-core/contrat/{refContrat}/reduction/ajouter" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="Sans user" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://localhost:8081</con:endpoint><con:request>{
  "reduction": {
    "valeur": "1",
    "isAffichableSurFacture": "true",
    "dateFin": "",
    "nbUtilisationMax": "3",
    "titre": "red-global-test",
    "dateDebut": "",
    "typeReduction": "CONTRAT",
    "typeValeur": "MOIS",
    "typeFrais": ""
  },
  "user": ""
}
</con:request><con:originalUri>http://localhost/contrat-core/contrat/00003183/reduction/ajouter</con:originalUri><con:assertion type="XPath Match" name="XPath Match"><con:configuration><path>//*:errorCode</path><content>1.1.91</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="errorMessage" disabled="true"><con:configuration><path>//*:errorMessage</path><content>L'element user est obligatoire.</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="url"><con:configuration><path>//*:url</path><content>/contrat-core/contrat/${preparation#refContrat}/reduction/ajouter</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="Valid HTTP Status Codes" name="Valid HTTP Status Codes"><con:configuration><codes>500</codes></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters><entry key="refContrat" value="${preparation#refContrat}" xmlns="http://eviware.com/soapui/config"/></con:parameters></con:restRequest></con:config></con:testStep><con:testStep type="restrequest" name="Indiquer le champ « typeFrais » alors que typeReduction = Contrat"><con:settings/><con:config service="http://localhost:8081" methodName="Method 1" resourcePath="/contrat-core/contrat/{refContrat}/reduction/ajouter" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="Indiquer le champ « typeFrais » alors que typeReduction = Contrat" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://localhost:8081</con:endpoint><con:request>{
  "reduction": {
    "valeur": "1",
    "isAffichableSurFacture": "true",
    "dateFin": "",
    "nbUtilisationMax": "3",
    "titre": "red-global-test",
    "dateDebut": "",
    "typeReduction": "CONTRAT",
    "typeValeur": "MOIS",
    "typeFrais": "CREATION"
  },
  "user": "testeur"
}
</con:request><con:originalUri>http://localhost/contrat-core/contrat/00003183/reduction/ajouter</con:originalUri><con:assertion type="XPath Match" name="errorCode"><con:configuration><path>//*:errorCode</path><content>1.1.126</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="errormessage" disabled="true"><con:configuration><path>//*:errorMessage</path><content>Impossible de definir un typeFrais lorsque la reduction est de type CONTRAT.</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="url"><con:configuration><path>//*:url</path><content>/contrat-core/contrat/${preparation#refContrat}/reduction/ajouter</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="Valid HTTP Status Codes" name="Valid HTTP Status Codes"><con:configuration><codes>500</codes></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters><entry key="refContrat" value="${preparation#refContrat}" xmlns="http://eviware.com/soapui/config"/></con:parameters></con:restRequest></con:config></con:testStep><con:testStep type="restrequest" name="Sans nombre d’utilisation et sans date debut"><con:settings/><con:config service="http://localhost:8081" methodName="Method 1" resourcePath="/contrat-core/contrat/{refContrat}/reduction/ajouter" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="Sans nombre d’utilisation et sans date debut" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://localhost:8081</con:endpoint><con:request>{
  "reduction": {
    "valeur": "1",
    "isAffichableSurFacture": "true",
    "dateFin": "",
    "nbUtilisationMax": "",
    "titre": "red-global-test",
    "dateDebut": "",
    "typeReduction": "CONTRAT",
    "typeValeur": "MOIS",
    "typeFrais": ""
  },
  "user": "testeur"
}
</con:request><con:originalUri>http://localhost/contrat-core/contrat/00003183/reduction/ajouter</con:originalUri><con:assertion type="XPath Match" name="errorCode"><con:configuration><path>//*:errorCode</path><content>1.1.59</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="errorMessage" disabled="true"><con:configuration><path>//*:errorMessage</path><content>Les information de Reduction ne sont pas valide. Fournir une periode valide ou un nombre d'utilisation maximale valide.</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="url"><con:configuration><path>//*:url</path><content>/contrat-core/contrat/${preparation#refContrat}/reduction/ajouter</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="Valid HTTP Status Codes" name="Valid HTTP Status Codes"><con:configuration><codes>500</codes></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters><entry key="refContrat" value="${preparation#refContrat}" xmlns="http://eviware.com/soapui/config"/></con:parameters></con:restRequest></con:config></con:testStep><con:testStep type="calltestcase" name="preparation-validation"><con:settings/><con:config xsi:type="con:RunTestCaseStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:targetTestCase>6c56c18b-08b8-4072-a062-97a144660809</con:targetTestCase><con:properties><con:property><con:name>refContrat</con:name><con:value>006009000</con:value></con:property><con:property><con:name>refCommande</con:name></con:property></con:properties><con:returnProperties><con:entry>refContrat</con:entry></con:returnProperties><con:runMode>PARALLELL</con:runMode></con:config></con:testStep><con:testStep type="restrequest" name="reduction frais apres validation"><con:settings/><con:config service="http://localhost:8081" methodName="Method 1" resourcePath="/contrat-core/contrat/{refContrat}/reduction/ajouter" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="reduction frais apres validation" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://localhost:8081</con:endpoint><con:request>{
  "reduction": {
    "valeur": "1",
    "isAffichableSurFacture": "true",
    "dateFin": "",
    "nbUtilisationMax": "",
    "titre": "red-global-test",
    "dateDebut": "",
    "typeReduction": "FRAIS",
    "typeValeur": "MOIS",
    "typeFrais": "CREATION"
  },
  "user": "testeur"
}
</con:request><con:originalUri>http://localhost/contrat-core/contrat/00003184/reduction/ajouter</con:originalUri><con:assertion type="XPath Match" name="XPath Match"><con:configuration><path>//*:errorCode</path><content>1.1.66</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="errorMessage" disabled="true"><con:configuration><path>//*:errorMessage</path><content>Impossible d'associer une reduction sur frais de creation a un contrat ou element contractuel validee.</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="url"><con:configuration><path>//*:url</path><content>/contrat-core/contrat/${preparation-validation#refContrat}/reduction/ajouter</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="Valid HTTP Status Codes" name="Valid HTTP Status Codes"><con:configuration><codes>500</codes></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters><entry key="refContrat" value="${preparation-validation#refContrat}" xmlns="http://eviware.com/soapui/config"/></con:parameters></con:restRequest></con:config></con:testStep><con:testStep type="restrequest" name="Associer une reduction à un contrat qui n’existe pas"><con:settings/><con:config service="http://localhost:8081" methodName="Method 1" resourcePath="/contrat-core/contrat/{refContrat}/reduction/ajouter" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="Associer une reduction à un contrat qui n’existe pas" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://localhost:8081</con:endpoint><con:request>{
  "reduction": {
    "valeur": "1",
    "isAffichableSurFacture": "true",
    "dateFin": "",
    "nbUtilisationMax": "",
    "titre": "red-global-test",
    "dateDebut": "",
    "typeReduction": "FRAIS",
    "typeValeur": "MOIS",
    "typeFrais": "CREATION"
  },
  "user": "testeur"
}
</con:request><con:originalUri>http://localhost/contrat-core/contrat/refContrat/reduction/ajouter</con:originalUri><con:assertion type="XPath Match" name="XPath Match"><con:configuration><path>//*:errorCode</path><content>0.1.2</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="errorMessage" disabled="true"><con:configuration><path>//*:errorMessage</path><content>l'element refContrat n'existe pas.</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="url"><con:configuration><path>//*:url</path><content>/contrat-core/contrat/refContrat/reduction/ajouter</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="Valid HTTP Status Codes" name="Valid HTTP Status Codes"><con:configuration><codes>500</codes></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters><con:entry key="refContrat" value="refContrat"/></con:parameters></con:restRequest></con:config></con:testStep><con:testStep type="calltestcase" name="preparation contrat sans frais"><con:settings/><con:config xsi:type="con:RunTestCaseStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:targetTestCase>a6758843-8531-4e0c-9a25-cf77decbec4f</con:targetTestCase><con:properties><con:property><con:name>refContrat</con:name><con:value>005000010</con:value></con:property></con:properties><con:returnProperties><con:entry>refContrat</con:entry></con:returnProperties><con:runMode>PARALLELL</con:runMode></con:config></con:testStep><con:testStep type="restrequest" name="Reduction pour un contrat qui n’a pas de frais"><con:settings/><con:config service="http://localhost:8081" methodName="Method 1" resourcePath="/contrat-core/contrat/{refContrat}/reduction/ajouter" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="Reduction pour un contrat qui n’a pas de frais" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://localhost:8081</con:endpoint><con:request>{
  "reduction": {
    "valeur": "1",
    "isAffichableSurFacture": "true",
    "dateFin": "",
    "nbUtilisationMax": "1",
    "titre": "reduction-test-global",
    "dateDebut": "",
    "typeReduction": "FRAIS",
    "typeValeur": "MOIS",
    "typeFrais": "RESILIATION"
  },
  "user": "testeur"
}
</con:request><con:originalUri>http://localhost/contrat-core/contrat/00003203/reduction/ajouter</con:originalUri><con:assertion type="XPath Match" name="XPath Match"><con:configuration><path>//*:errorCode</path><content>1.1.146</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="errorMessage" disabled="true"><con:configuration><path>//*:errorMessage</path><content>Le contrat de reference ${preparation contrat sans frais#refContrat} n'a pas de frais de type RESILIATION.</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="url"><con:configuration><path>//*:url</path><content>/contrat-core/contrat/${preparation contrat sans frais#refContrat}/reduction/ajouter</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="Valid HTTP Status Codes" name="Valid HTTP Status Codes"><con:configuration><codes>500</codes></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters><entry key="refContrat" value="${preparation contrat sans frais#refContrat}" xmlns="http://eviware.com/soapui/config"/></con:parameters></con:restRequest></con:config></con:testStep><con:testStep type="restrequest" name="Date precedente"><con:settings/><con:config service="http://localhost:8081" methodName="Method 1" resourcePath="/contrat-core/contrat/{refContrat}/reduction/ajouter" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="Date precedente" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://localhost:8081</con:endpoint><con:request>{
  "reduction": {
    "valeur": "1",
    "isAffichableSurFacture": "true",
    "dateFin": "",
    "nbUtilisationMax": "2",
    "titre": "red-global-test",
    "dateDebut": "2012-01-01",
    "typeReduction": "CONTRAT",
    "typeValeur": "MOIS",
    "typeFrais": ""
  },
  "user": "testeur"
}
</con:request><con:originalUri>http://localhost/contrat-core/contrat/00003208/reduction/ajouter</con:originalUri><con:assertion type="XPath Match" name="XPath Match"><con:configuration><path>//*:errorCode</path><content>1.1.89</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="errorMessage" disabled="true"><con:configuration><path>//*:errorMessage</path><content>La periode de reduction ne doit pas etre dans le passe.</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="url"><con:configuration><path>//*:url</path><content>/contrat-core/contrat/${preparation#refContrat}/reduction/ajouter</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="Valid HTTP Status Codes" name="Valid HTTP Status Codes"><con:configuration><codes>500</codes></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters><entry key="refContrat" value="${preparation#refContrat}" xmlns="http://eviware.com/soapui/config"/></con:parameters></con:restRequest></con:config></con:testStep><con:testStep type="restrequest" name="reductionValide"><con:settings/><con:config service="http://localhost:8081" methodName="Method 1" resourcePath="/contrat-core/contrat/{refContrat}/reduction/ajouter" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="reductionValide" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://localhost:8081</con:endpoint><con:request>{
  "reduction": {
    "valeur": "1",
    "isAffichableSurFacture": "true",
    "dateFin": "",
    "nbUtilisationMax": "2",
    "titre": "red-global-test",
    "dateDebut": "",
    "typeReduction": "CONTRAT",
    "typeValeur": "MOIS",
    "typeFrais": ""
  },
  "user": "testeur"
}
</con:request><con:originalUri>http://localhost/contrat-core/contrat/00003200/reduction/ajouter</con:originalUri><con:assertion type="GroovyScriptAssertion" name="Script Assertion" disabled="true"><con:configuration><scriptText>assert messageExchange.hasResponse() == false</scriptText></con:configuration></con:assertion><con:assertion type="Valid HTTP Status Codes" name="Valid HTTP Status Codes"><con:configuration><codes>200</codes></con:configuration></con:assertion><con:assertion type="XPath Match" name="XPath Match"><con:configuration><path>exists(//*:referenceReduction)</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters><entry key="refContrat" value="${preparation#refContrat}" xmlns="http://eviware.com/soapui/config"/></con:parameters></con:restRequest></con:config></con:testStep><con:testStep type="restrequest" name="double reduction"><con:settings/><con:config service="http://localhost:8081" methodName="Method 1" resourcePath="/contrat-core/contrat/{refContrat}/reduction/ajouter" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="double reduction" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://localhost:8081</con:endpoint><con:request>{
  "reduction": {
    "valeur": "1",
    "isAffichableSurFacture": "true",
    "dateFin": "",
    "nbUtilisationMax": "2",
    "titre": "red-global-test",
    "dateDebut": "",
    "typeReduction": "CONTRAT",
    "typeValeur": "MOIS",
    "typeFrais": ""
  },
  "user": "testeur"
}
</con:request><con:originalUri>http://localhost/contrat-core/contrat/00003200/reduction/ajouter</con:originalUri><con:assertion type="XPath Match" name="XPath Match"><con:configuration><path>//*:errorCode</path><content>1.1.144</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="ErrorMessage" disabled="true"><con:configuration><path>//*:errorMessage</path><content>L'element de reference ${preparation#refContrat} a deja une reduction.</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="url"><con:configuration><path>//*:url</path><content>/contrat-core/contrat/${preparation#refContrat}/reduction/ajouter</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="Valid HTTP Status Codes" name="Valid HTTP Status Codes"><con:configuration><codes>500</codes></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters><entry key="refContrat" value="${preparation#refContrat}" xmlns="http://eviware.com/soapui/config"/></con:parameters></con:restRequest></con:config></con:testStep><con:testStep type="calltestcase" name="resiliation"><con:settings/><con:config xsi:type="con:RunTestCaseStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:targetTestCase>82a3926c-67ae-4136-87ba-1c522c84a422</con:targetTestCase><con:properties><con:property><con:name>refContrat</con:name><con:value>003000110</con:value></con:property></con:properties><con:returnProperties><con:entry>refContrat</con:entry></con:returnProperties><con:runMode>PARALLELL</con:runMode></con:config></con:testStep><con:testStep type="restrequest" name="Associer une reduction à un contrat ou EC resilie"><con:settings/><con:config service="http://localhost:8081" methodName="Method 1" resourcePath="/contrat-core/contrat/{refContrat}/reduction/ajouter" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="Associer une reduction à un contrat ou EC resilie" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://localhost:8081</con:endpoint><con:request>{
  "reduction": {
    "valeur": "1",
    "isAffichableSurFacture": "true",
    "dateFin": "",
    "nbUtilisationMax": "2",
    "titre": "red-global-test",
    "dateDebut": "",
    "typeReduction": "CONTRAT",
    "typeValeur": "MOIS",
    "typeFrais": ""
  },
  "user": "testeur"
}
</con:request><con:originalUri>http://localhost/contrat-core/contrat/00003220/reduction/ajouter</con:originalUri><con:assertion type="XPath Match" name="errorCode"><con:configuration><path>//*:errorCode</path><content>1.1.64</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="ErrorMessage" disabled="true"><con:configuration><path>//*:errorMessage</path><content>Impossible d'associer une reduction a un contrat ou  un element contractuel resilie.</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="url"><con:configuration><path>//*:url</path><content>/contrat-core/contrat/${resiliation#refContrat}/reduction/ajouter</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="Valid HTTP Status Codes" name="Valid HTTP Status Codes"><con:configuration><codes>500</codes></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters><entry key="refContrat" value="${resiliation#refContrat}" xmlns="http://eviware.com/soapui/config"/></con:parameters></con:restRequest></con:config></con:testStep><con:properties/></con:testCase><con:testCase failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="Error migration" searchProperties="true" id="3b4637d4-cafd-4ca3-992e-b61054cd8fc5"><con:settings/><con:testStep type="calltestcase" name="preparation-validation"><con:settings/><con:config xsi:type="con:RunTestCaseStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:targetTestCase>6c56c18b-08b8-4072-a062-97a144660809</con:targetTestCase><con:properties><con:property><con:name>refContrat</con:name><con:value>202000300</con:value></con:property><con:property><con:name>refCommande</con:name></con:property></con:properties><con:returnProperties><con:entry>refContrat</con:entry></con:returnProperties><con:runMode>PARALLELL</con:runMode></con:config></con:testStep><con:testStep type="restrequest" name="sans num EC"><con:settings/><con:config service="http://localhost:8081" methodName="Method 1" resourcePath="/contrat-core/contrat/{refContrat}/migrer" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="sans num EC" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://localhost:8081</con:endpoint><con:request>{
  "user": "test",
  "politiqueMigration": {
    "fraisMigration": "30",
    "fraisResiliation": "true",
    "remboursement": "true",
    "fraisCreation": "true",
    "penalite": "true",
    "reductionAncienne": "true"
  },
  "produitsMigration": [
    {
      "numEC": "",
      "referenceGammeSource": "securite",
      "referenceProduitSource": "avfwpro-confort-s",
      "referenceGammeDestination": "securite",
      "referenceProduitDestination": "avfw.confort.xl",
      "label": "Abonnement Antivirus 6postes",
      "numeroCommande": "Order_migration_avfw_xl",
      "typeProduit": "SERVICE",
      "remboursable": true,
      "prix": {
        "duree" : "12",
        "periodicite": 2,
        "montant": "10",
        "typeTVA": "R",
        "modeFacturation": "DATE_ANNIVERSAIRE"
      },
      "referenceDePaiement": "R0000012",
      "modePaiement": "SEPA"
    }
  ]
}
</con:request><con:originalUri>http://localhost/contrat-core/contrat/00003251/migrer</con:originalUri><con:assertion type="XPath Match" name="errorCode"><con:configuration><path>//*:errorCode</path><content>1.1.74</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="errorMessage" disabled="true"><con:configuration><path>//*:errorMessage</path><content>Impossible de migrer un produit qui n’est pas reference par son numero de ligne du precedent contrat.</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="url"><con:configuration><path>//*:url</path><content>/contrat-core/contrat/${preparation-validation#refContrat}/migrer</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="Valid HTTP Status Codes" name="Valid HTTP Status Codes"><con:configuration><codes>500</codes></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters><entry key="refContrat" value="${preparation-validation#refContrat}" xmlns="http://eviware.com/soapui/config"/></con:parameters></con:restRequest></con:config></con:testStep><con:testStep type="restrequest" name="Sans num commande"><con:settings/><con:config service="http://localhost:8081" methodName="Method 1" resourcePath="/contrat-core/contrat/{refContrat}/migrer" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="Sans num commande" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://localhost:8081</con:endpoint><con:request>{
  "user": "test",
  "politiqueMigration": {
    "fraisMigration": "30",
    "fraisResiliation": "true",
    "remboursement": "true",
    "fraisCreation": "true",
    "penalite": "true",
    "reductionAncienne": "true"
  },
  "produitsMigration": [
    {
      "numEC": "1",
      "referenceGammeSource": "securite",
      "referenceProduitSource": "avfwpro-confort-s",
      "referenceGammeDestination": "securite",
      "referenceProduitDestination": "avfw.confort.xl",
      "label": "Abonnement Antivirus 6postes",
      "numeroCommande": "",
      "typeProduit": "SERVICE",
      "remboursable": true,
      "prix": {
        "duree" : "12",
        "periodicite": 2,
        "montant": "10",
        "typeTVA": "R",
        "modeFacturation": "DATE_ANNIVERSAIRE"
      },
      "referenceDePaiement": "R0000012",
      "modePaiement": "SEPA"
    }
  ]
}
</con:request><con:originalUri>http://localhost/contrat-core/contrat/00003252/migrer</con:originalUri><con:assertion type="XPath Match" name="errorCode"><con:configuration><path>//*:errorCode</path><content>0.1.1</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="errorMessage" disabled="true"><con:configuration><path>//*:errorMessage</path><content>un des parametres est mal formate : Produit.numeroCommande.</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="url"><con:configuration><path>//*:url</path><content>/contrat-core/contrat/${preparation-validation#refContrat}/migrer</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="Valid HTTP Status Codes" name="Valid HTTP Status Codes"><con:configuration><codes>500</codes></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters><entry key="refContrat" value="${preparation-validation#refContrat}" xmlns="http://eviware.com/soapui/config"/></con:parameters></con:restRequest></con:config></con:testStep><con:testStep type="restrequest" name="Sans EC parent et sans Prix avec des frais de migration"><con:settings/><con:config service="http://localhost:8081" methodName="Method 1" resourcePath="/contrat-core/contrat/{refContrat}/migrer" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="Sans EC parent et sans Prix avec des frais de migration" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://localhost:8081</con:endpoint><con:request>{
  "user": "test",
  "politiqueMigration": {
    "fraisMigration": "30",
    "fraisResiliation": "true",
    "remboursement": "true",
    "fraisCreation": "true",
    "penalite": "true",
    "reductionAncienne": "true"
  },
  "produitsMigration": [
    {
      "numEC": "1",
      "referenceGammeSource": "securite",
      "referenceProduitSource": "avfwpro-confort-s",
      "referenceGammeDestination": "securite",
      "referenceProduitDestination": "jet",
      "label": "Abonnement Antivirus 6postes",
      "numeroCommande": "Order_migration_avfw_xl",
      "typeProduit": "SERVICE",
      "remboursable": true,
      "referenceDePaiement": "R0000012",
      "modePaiement": "SEPA"
    }
  ]
}
</con:request><con:originalUri>http://localhost/contrat-core/contrat/00003252/migrer</con:originalUri><con:assertion type="XPath Match" name="errorCode"><con:configuration><path>//*:errorCode</path><content>1.1.131</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="errorMessage" disabled="true"><con:configuration><path>//*:errorMessage</path><content>Impossible d'associer les frais de migration a une offre sans prix.</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="url"><con:configuration><path>//*:url</path><content>/contrat-core/contrat/${preparation-validation#refContrat}/migrer</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="Valid HTTP Status Codes" name="Valid HTTP Status Codes"><con:configuration><codes>500</codes></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters><entry key="refContrat" value="${preparation-validation#refContrat}" xmlns="http://eviware.com/soapui/config"/></con:parameters></con:restRequest></con:config></con:testStep><con:testStep type="restrequest" name="Sans Ref mode de paiement avec mode de paiement CB / SEPA / Facture"><con:settings/><con:config service="http://localhost:8081" methodName="Method 1" resourcePath="/contrat-core/contrat/{refContrat}/migrer" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="Sans Ref mode de paiement avec mode de paiement CB / SEPA / Facture" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://localhost:8081</con:endpoint><con:request>{
  "user": "test",
  "politiqueMigration": {
    "fraisMigration": "30",
    "fraisResiliation": "true",
    "remboursement": "true",
    "fraisCreation": "true",
    "penalite": "true",
    "reductionAncienne": "true"
  },
  "produitsMigration": [
    {
      "numEC": "1",
      "referenceGammeSource": "securite",
      "referenceProduitSource": "avfwpro-confort-s",
      "referenceGammeDestination": "securite",
      "referenceProduitDestination": "jet",
      "label": "Abonnement Antivirus 6postes",
      "numeroCommande": "Order_migration_avfw_xl",
      "typeProduit": "SERVICE",
      "remboursable": true,
      "prix": {
        "duree" : "12",
        "periodicite": 2,
        "montant": "10",
        "typeTVA": "R",
        "modeFacturation": "DATE_ANNIVERSAIRE"
      },
      "referenceDePaiement": "",
      "modePaiement": "SEPA"
    }
  ]
}
</con:request><con:originalUri>http://localhost/contrat-core/contrat/00003252/migrer</con:originalUri><con:assertion type="XPath Match" name="errorCode"><con:configuration><path>//*:errorCode</path><content>1.1.37</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="errorMessage" disabled="true"><con:configuration><path>//*:errorMessage</path><content>la Reference de Mode paiement est obligatoire pour les mode de paiement de type  SEPA, FACTURE ou FACTURE FIN DE MOIS .</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="url"><con:configuration><path>//*:url</path><content>/contrat-core/contrat/${preparation-validation#refContrat}/migrer</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="Valid HTTP Status Codes" name="Valid HTTP Status Codes"><con:configuration><codes>500</codes></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters><entry key="refContrat" value="${preparation-validation#refContrat}" xmlns="http://eviware.com/soapui/config"/></con:parameters></con:restRequest></con:config></con:testStep><con:testStep type="restrequest" name="Sans mode de paiement"><con:settings/><con:config service="http://localhost:8081" methodName="Method 1" resourcePath="/contrat-core/contrat/{refContrat}/migrer" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="Sans mode de paiement" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://localhost:8081</con:endpoint><con:request>{
  "user": "test",
  "politiqueMigration": {
    "fraisMigration": "30",
    "fraisResiliation": "true",
    "remboursement": "true",
    "fraisCreation": "true",
    "penalite": "true",
    "reductionAncienne": "true"
  },
  "produitsMigration": [
    {
      "numEC": "1",
      "referenceGammeSource": "securite",
      "referenceProduitSource": "avfwpro-confort-s",
      "referenceGammeDestination": "securite",
      "referenceProduitDestination": "jet",
      "label": "Abonnement Antivirus 6postes",
      "numeroCommande": "Order_migration_avfw_xl",
      "typeProduit": "SERVICE",
      "remboursable": true,
      "prix": {
        "duree" : "12",
        "periodicite": 2,
        "montant": "10",
        "typeTVA": "R",
        "modeFacturation": "DATE_ANNIVERSAIRE"
      },
      "referenceDePaiement": "R0000012",
      "modePaiement": ""
    }
  ]
}
</con:request><con:originalUri>http://localhost/contrat-core/contrat/preparation-validation/migrer</con:originalUri><con:assertion type="XPath Match" name="errorCode"><con:configuration><path>//*:errorCode</path><content>0.1.11</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="errorMessage" disabled="true"><con:configuration><path>//*:errorMessage</path><content>Le Prix.modePaiement ne peut valoir que [SEPA, CB, CHEQUE, FACTURE, TROIS_FOIS_SANS_FRAIS, FACTURE_FIN_DE_MOIS].</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="url"><con:configuration><path>//*:url</path><content>/contrat-core/contrat/${preparation-validation#refContrat}/migrer</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="Valid HTTP Status Codes" name="Valid HTTP Status Codes"><con:configuration><codes>500</codes></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters><entry key="refContrat" value="${preparation-validation#refContrat}" xmlns="http://eviware.com/soapui/config"/></con:parameters></con:restRequest></con:config></con:testStep><con:testStep type="restrequest" name="Sans mode de facturation"><con:settings/><con:config service="http://localhost:8081" methodName="Method 1" resourcePath="/contrat-core/contrat/{refContrat}/migrer" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="Sans mode de facturation" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://localhost:8081</con:endpoint><con:request>{
  "user": "test",
  "politiqueMigration": {
    "fraisMigration": "30",
    "fraisResiliation": "true",
    "remboursement": "true",
    "fraisCreation": "true",
    "penalite": "true",
    "reductionAncienne": "true"
  },
  "produitsMigration": [
    {
      "numEC": "1",
      "referenceGammeSource": "securite",
      "referenceProduitSource": "avfwpro-confort-s",
      "referenceGammeDestination": "securite",
      "referenceProduitDestination": "jet",
      "label": "Abonnement Antivirus 6postes",
      "numeroCommande": "Order_migration_avfw_xl",
      "typeProduit": "SERVICE",
      "remboursable": true,
      "prix": {
        "duree" : "12",
        "periodicite": 2,
        "montant": "10",
        "typeTVA": "R",
        "modeFacturation": ""
      },
      "referenceDePaiement": "R0000012",
      "modePaiement": "SEPA"
    }
  ]
}
</con:request><con:originalUri>http://localhost/contrat-core/contrat/00003178/migrer</con:originalUri><con:assertion type="XPath Match" name="errorCode"><con:configuration><path>//*:errorCode</path><content>0.1.11</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="errorMessage" disabled="true"><con:configuration><path>//*:errorMessage</path><content>Le Prix.modeFacturation ne peut valoir que [PREMIER_MOIS, DATE_ANNIVERSAIRE].</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="url"><con:configuration><path>//*:url</path><content>/contrat-core/contrat/${preparation-validation#refContrat}/migrer</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="Valid HTTP Status Codes" name="Valid HTTP Status Codes"><con:configuration><codes>500</codes></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters><entry key="refContrat" value="${preparation-validation#refContrat}" xmlns="http://eviware.com/soapui/config"/></con:parameters></con:restRequest></con:config></con:testStep><con:testStep type="restrequest" name="Packager sans indiquer les produits destination"><con:settings/><con:config service="http://localhost:8081" methodName="Method 1" resourcePath="/contrat-core/contrat/{refContrat}/migrer" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="Packager sans indiquer les produits destination" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://localhost:8081</con:endpoint><con:request>{
  "user": "test",
  "politiqueMigration": {
    "fraisMigration": "30",
    "fraisResiliation": "true",
    "remboursement": "true",
    "fraisCreation": "true",
    "penalite": "true",
    "reductionAncienne": "true"
  },
  "produitsMigration": [
    {
      "numEC": "1",
      "referenceGammeSource": "securite",
      "referenceProduitSource": "avfwpro-confort-s",
      "referenceGammeDestination": "",
      "referenceProduitDestination": "",
      "label": "Abonnement Antivirus 6postes",
      "numeroCommande": "Order_migration_avfw_xl",
      "typeProduit": "SERVICE",
      "remboursable": true,
      "prix": {
        "duree" : "12",
        "periodicite": 2,
        "montant": "10",
        "typeTVA": "R",
        "modeFacturation": "DATE_ANNIVERSAIRE"
      },
      "referenceDePaiement": "R0000012",
      "modePaiement": "SEPA"
    }
  ]
}
</con:request><con:originalUri>http://localhost/contrat-core/contrat/00003178/migrer</con:originalUri><con:assertion type="XPath Match" name="errorCode"><con:configuration><path>//*:errorCode</path><content>1.1.87</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="errorMessage" disabled="true"><con:configuration><path>//*:errorMessage</path><content>Impossible d’ajouter le produit 1. Il ne renseigne pas les informations RefProduit et/ou RefGamme</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="url"><con:configuration><path>//*:url</path><content>/contrat-core/contrat/${preparation-validation#refContrat}/migrer</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="Valid HTTP Status Codes" name="Valid HTTP Status Codes"><con:configuration><codes>500</codes></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters><entry key="refContrat" value="${preparation-validation#refContrat}" xmlns="http://eviware.com/soapui/config"/></con:parameters></con:restRequest></con:config></con:testStep><con:testStep type="restrequest" name="Migrer un antivirus avec un produit de type BIEN"><con:settings/><con:config service="http://localhost:8081" methodName="Method 1" resourcePath="/contrat-core/contrat/{refContrat}/migrer" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="Migrer un antivirus avec un produit de type BIEN" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://localhost:8081</con:endpoint><con:request>{
  "user": "test",
  "politiqueMigration": {
    "fraisMigration": "30",
    "fraisResiliation": "true",
    "remboursement": "true",
    "fraisCreation": "true",
    "penalite": "true",
    "reductionAncienne": "true"
  },
  "produitsMigration": [
    {
      "numEC": "1",
      "referenceGammeSource": "securite",
      "referenceProduitSource": "avfwpro-confort-s",
      "referenceGammeDestination": "securite",
      "referenceProduitDestination": "jet",
      "label": "Abonnement Antivirus 6postes",
      "numeroCommande": "Order_migration_avfw_xl",
      "typeProduit": "BIEN",
      "remboursable": true,
      "prix": {
        "duree" : "12",
        "periodicite": 2,
        "montant": "10",
        "typeTVA": "R",
        "modeFacturation": "DATE_ANNIVERSAIRE"
      },
      "referenceDePaiement": "R0000012",
      "modePaiement": "SEPA"
    }
  ]
}
</con:request><con:originalUri>http://localhost/contrat-core/contrat/00003178/migrer</con:originalUri><con:assertion type="XPath Match" name="errorcode"><con:configuration><path>//*:errorCode</path><content>1.1.77</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="errorMessage" disabled="true"><con:configuration><path>//*:errorMessage</path><content>Impossible de migrer l'element contractuel avfwpro-confort-s vers avfwpro-confort-s, car les types de produits sont differents.</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="url"><con:configuration><path>//*:url</path><content>/contrat-core/contrat/${preparation-validation#refContrat}/migrer</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="Valid HTTP Status Codes" name="Valid HTTP Status Codes"><con:configuration><codes>500</codes></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters><entry key="refContrat" value="${preparation-validation#refContrat}" xmlns="http://eviware.com/soapui/config"/></con:parameters></con:restRequest></con:config></con:testStep><con:testStep type="restrequest" name="Sans politique migration"><con:settings/><con:config service="http://localhost:8081" methodName="Method 1" resourcePath="/contrat-core/contrat/{refContrat}/migrer" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="Sans politique migration" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://localhost:8081</con:endpoint><con:request>{
  "user": "test",
  "produitsMigration": [
    {
      "numEC": "1",
      "referenceGammeSource": "securite",
      "referenceProduitSource": "avfwpro-confort-s",
      "referenceGammeDestination": "securite",
      "referenceProduitDestination": "avfwpro-confort-s",
      "label": "Abonnement Antivirus 6postes",
      "numeroCommande": "Order_migration_avfw_xl",
      "typeProduit": "SERVICE",
      "remboursable": true,
      "prix": {
        "duree" : "12",
        "periodicite": 2,
        "montant": "10",
        "typeTVA": "R",
        "modeFacturation": "DATE_ANNIVERSAIRE"
      },
      "referenceDePaiement": "R0000012",
      "modePaiement": "SEPA"
    }
  ]
}
</con:request><con:originalUri>http://localhost/contrat-core/contrat/00003178/migrer</con:originalUri><con:assertion type="XPath Match" name="errorCode"><con:configuration><path>//*:errorCode</path><content>1.1.17</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="errorMessage" disabled="true"><con:configuration><path>//*:errorMessage</path><content>La politique de migration est obligatoire.</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="url"><con:configuration><path>//*:url</path><content>/contrat-core/contrat/${preparation-validation#refContrat}/migrer</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="Valid HTTP Status Codes" name="Valid HTTP Status Codes"><con:configuration><codes>500</codes></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters><entry key="refContrat" value="${preparation-validation#refContrat}" xmlns="http://eviware.com/soapui/config"/></con:parameters></con:restRequest></con:config></con:testStep><con:testStep type="restrequest" name="Sans User"><con:settings/><con:config service="http://localhost:8081" methodName="Method 1" resourcePath="/contrat-core/contrat/{refContrat}/migrer" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="Sans User" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://localhost:8081</con:endpoint><con:request>{

  "politiqueMigration": {
    "fraisMigration": "30",
    "fraisResiliation": "true",
    "remboursement": "true",
    "fraisCreation": "true",
    "penalite": "true",
    "reductionAncienne": "true"
  },
  "produitsMigration": [
    {
      "numEC": "1",
      "referenceGammeSource": "securite",
      "referenceProduitSource": "avfwpro-confort-s",
      "referenceGammeDestination": "securite",
      "referenceProduitDestination": "avfwpro-confort-s",
      "label": "Abonnement Antivirus 6postes",
      "numeroCommande": "Order_migration_avfw_xl",
      "typeProduit": "SERVICE",
      "remboursable": true,
      "prix": {
        "duree" : "12",
        "periodicite": 2,
        "montant": "10",
        "typeTVA": "R",
        "modeFacturation": "DATE_ANNIVERSAIRE"
      },
      "referenceDePaiement": "R0000012",
      "modePaiement": "SEPA"
    }
  ]
}
</con:request><con:originalUri>http://localhost/contrat-core/contrat/00003178/migrer</con:originalUri><con:assertion type="XPath Match" name="errorcode"><con:configuration><path>//*:errorCode</path><content>1.1.91</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="errorMessage" disabled="true"><con:configuration><path>//*:errorMessage</path><content>L'element user est obligatoire.</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="url"><con:configuration><path>//*:url</path><content>/contrat-core/contrat/${preparation-validation#refContrat}/migrer</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="Valid HTTP Status Codes" name="Valid HTTP Status Codes"><con:configuration><codes>500</codes></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters><entry key="refContrat" value="${preparation-validation#refContrat}" xmlns="http://eviware.com/soapui/config"/></con:parameters></con:restRequest></con:config></con:testStep><con:testStep type="restrequest" name="Ajout nouveau produit en indiquant des donnees source"><con:settings/><con:config service="http://localhost:8081" methodName="Method 1" resourcePath="/contrat-core/contrat/{refContrat}/migrer" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="Ajout nouveau produit en indiquant des donnees source" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://localhost:8081</con:endpoint><con:request>{
  "user": "test",
  "politiqueMigration": {
    "fraisMigration": "30",
    "fraisResiliation": "true",
    "remboursement": "true",
    "fraisCreation": "true",
    "penalite": "true",
    "reductionAncienne": "true"
  },
  "produitsMigration": [
    {
      "numEC": "2",
      "referenceGammeSource": "securite",
      "referenceProduitSource": "avfwpro-confort-s",
      "referenceGammeDestination": "securite",
      "referenceProduitDestination": "Antivirus.Firewall.6.postes",
      "label": "Abonnement Antivirus Firewall 6 postes",
      "numeroCommande": "Order_migration_avfw_xl",
      "typeProduit": "SERVICE",
      "remboursable": true,
      "prix": {
        "duree" : "12",
        "periodicite": 2,
        "montant": "8",
        "typeTVA": "R",
        "modeFacturation": "DATE_ANNIVERSAIRE"
      },
      "referenceDePaiement": "R0000012",
      "modePaiement": "SEPA"
    }
  ]
}

</con:request><con:originalUri>http://localhost/contrat-core/contrat/00003178/migrer</con:originalUri><con:assertion type="XPath Match" name="errorCode"><con:configuration><path>//*:errorCode</path><content>1.1.74</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="errorMessage" disabled="true"><con:configuration><path>//*:errorMessage</path><content>Impossible de migrer un produit qui n’est pas reference par son numero de ligne du precedent contrat.</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="url"><con:configuration><path>//*:url</path><content>/contrat-core/contrat/${preparation-validation#refContrat}/migrer</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="Valid HTTP Status Codes" name="Valid HTTP Status Codes"><con:configuration><codes>500</codes></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters><entry key="refContrat" value="${preparation-validation#refContrat}" xmlns="http://eviware.com/soapui/config"/></con:parameters></con:restRequest></con:config></con:testStep><con:testStep type="calltestcase" name="preparation"><con:settings/><con:config xsi:type="con:RunTestCaseStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:targetTestCase>621887f4-565f-4013-bd4a-24e3e4c41a1e</con:targetTestCase><con:properties><con:property><con:name>RefCommande</con:name></con:property><con:property><con:name>refContrat</con:name><con:value>004200004</con:value></con:property></con:properties><con:returnProperties><con:entry>refContrat</con:entry></con:returnProperties><con:runMode>PARALLELL</con:runMode></con:config></con:testStep><con:testStep type="restrequest" name="Contrat non valide"><con:settings/><con:config service="http://localhost:8081" methodName="Method 1" resourcePath="/contrat-core/contrat/{refContrat}/migrer" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="Contrat non valide" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://localhost:8081</con:endpoint><con:request>{
  "user": "test",
  "politiqueMigration": {
    "fraisMigration": "30",
    "fraisResiliation": "true",
    "remboursement": "true",
    "fraisCreation": "true",
    "penalite": "true",
    "reductionAncienne": "true"
  },
  "produitsMigration": [
    {
      "numEC": "2",
      "referenceGammeSource": "securite",
      "referenceProduitSource": "avfw.confort.xl",
      "referenceGammeDestination": "securite",
      "referenceProduitDestination": "avfw.confort.xl",
      "label": "Abonnement Antivirus Firewall 6 postes",
      "numeroCommande": "Order_migration_avfw_xl",
      "typeProduit": "SERVICE",
      "remboursable": true,
      "prix": {
        "duree" : "12",
        "periodicite": 2,
        "montant": "8",
        "typeTVA": "R",
        "modeFacturation": "DATE_ANNIVERSAIRE"
      },
      "referenceDePaiement": "R0000012",
      "modePaiement": "SEPA"
    }
  ]
}
</con:request><con:originalUri>http://localhost/contrat-core/contrat/00003179/migrer</con:originalUri><con:assertion type="XPath Match" name="errorCode"><con:configuration><path>//*:errorCode</path><content>1.1.72</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="errorMessage" disabled="true"><con:configuration><path>//*:errorMessage</path><content>Impossible de migrer un contrat non-valide.</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="url"><con:configuration><path>//*:url</path><content>/contrat-core/contrat/${preparation#refContrat}/migrer</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="Valid HTTP Status Codes" name="Valid HTTP Status Codes"><con:configuration><codes>500</codes></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters><entry key="refContrat" value="${preparation#refContrat}" xmlns="http://eviware.com/soapui/config"/></con:parameters></con:restRequest></con:config></con:testStep><con:testStep type="calltestcase" name="resiliation"><con:settings/><con:config xsi:type="con:RunTestCaseStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:targetTestCase>82a3926c-67ae-4136-87ba-1c522c84a422</con:targetTestCase><con:properties><con:property><con:name>refContrat</con:name><con:value>521000000</con:value></con:property></con:properties><con:returnProperties><con:entry>refContrat</con:entry></con:returnProperties><con:runMode>PARALLELL</con:runMode></con:config></con:testStep><con:testStep type="restrequest" name="Migrer un contrat resilie"><con:settings/><con:config service="http://localhost:8081" methodName="Method 1" resourcePath="/contrat-core/contrat/{refContrat}/migrer" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="Migrer un contrat resilie" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://localhost:8081</con:endpoint><con:request>{
  "user": "test",
  "politiqueMigration": {
    "fraisMigration": "30",
    "fraisResiliation": "true",
    "remboursement": "true",
    "fraisCreation": "true",
    "penalite": "true",
    "reductionAncienne": "true"
  },
  "produitsMigration": [
    {
      "numEC": "2",
      "referenceGammeSource": "securite",
      "referenceProduitSource": "avfw.confort.xl",
      "referenceGammeDestination": "securite",
      "referenceProduitDestination": "avfw.confort.xl",
      "label": "Abonnement Antivirus Firewall 6 postes",
      "numeroCommande": "Order_migration_avfw_xl",
      "typeProduit": "SERVICE",
      "remboursable": true,
      "prix": {
        "duree" : "12",
        "periodicite": 2,
        "montant": "8",
        "typeTVA": "R",
        "modeFacturation": "DATE_ANNIVERSAIRE"
      },
      "referenceDePaiement": "R0000012",
      "modePaiement": "SEPA"
    }
  ]
}
</con:request><con:originalUri>http://localhost/contrat-core/contrat/00003180/migrer</con:originalUri><con:assertion type="XPath Match" name="errorcode"><con:configuration><path>//*:errorCode</path><content>1.1.73</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="errorMessage" disabled="true"><con:configuration><path>//*:errorMessage</path><content>Impossible de migrer un contrat resilie.</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="url"><con:configuration><path>//*:url</path><content>/contrat-core/contrat/${resiliation#refContrat}/migrer</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="Valid HTTP Status Codes" name="Valid HTTP Status Codes"><con:configuration><codes>500</codes></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters><entry key="refContrat" value="${resiliation#refContrat}" xmlns="http://eviware.com/soapui/config"/></con:parameters></con:restRequest></con:config></con:testStep><con:testStep type="restrequest" name="Migrer contrat dans une date precedente"><con:settings/><con:config service="http://localhost:8081" methodName="Method 1" resourcePath="/contrat-core/contrat/{refContrat}/migrer" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="Migrer contrat dans une date precedente" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://localhost:8081</con:endpoint><con:request>{
  "user": "test",
  "politiqueMigration": {
    "fraisMigration": "30",
    "fraisResiliation": "true",
    "remboursement": "true",
    "fraisCreation": "true",
    "penalite": "true",
    "reductionAncienne": "true",
    "dateAction": "2012-01-15"
  },
  "produitsMigration": [
    {
      "numEC": "1",
      "referenceGammeSource": "securite",
      "referenceProduitSource": "avfwpro-confort-s",
      "referenceGammeDestination": "max",
      "referenceProduitDestination": "Antivirus.Firewall.6.postes",
      "label": "Abonnement Antivirus 6postes",
      "numeroCommande": "Order_migration_avfw_xl",
      "typeProduit": "SERVICE",
      "remboursable": true,
      "prix": {
        "duree" : "12",
        "periodicite": 2,
        "montant": "10",
        "typeTVA": "R",
        "modeFacturation": "DATE_ANNIVERSAIRE"
      },
      "referenceDePaiement": "R0000012",
      "modePaiement": "SEPA"
    }
  ]
}
</con:request><con:originalUri>http://localhost/contrat-core/contrat/00003178/migrer</con:originalUri><con:assertion type="XPath Match" name="errorCode"><con:configuration><path>//*:errorCode</path><content>1.1.110</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="errorMesage" disabled="true"><con:configuration><path>//*:errorMessage</path><content>Date migration doit etre superieure ou egale à la date du jour.</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="url"><con:configuration><path>//*:url</path><content>/contrat-core/contrat/${preparation-validation#refContrat}/migrer</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="Valid HTTP Status Codes" name="Valid HTTP Status Codes"><con:configuration><codes>500</codes></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters><entry key="refContrat" value="${preparation-validation#refContrat}" xmlns="http://eviware.com/soapui/config"/></con:parameters></con:restRequest></con:config></con:testStep><con:testStep type="restrequest" name="date action qui depasse la date fin contrat"><con:settings/><con:config service="http://localhost:8081" methodName="Method 1" resourcePath="/contrat-core/contrat/{refContrat}/migrer" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="date action qui depasse la date fin contrat" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://localhost:8081</con:endpoint><con:request>{
  "user": "test",
  "politiqueMigration": {
    "fraisMigration": "30",
    "fraisResiliation": "true",
    "remboursement": "true",
    "fraisCreation": "true",
    "penalite": "true",
    "reductionAncienne": "true",
    "dateAction": "2018-01-17"
  },
  "produitsMigration": [
    {
      "numEC": "1",
      "referenceGammeSource": "securite",
      "referenceProduitSource": "avfwpro-confort-s",
      "referenceGammeDestination": "max",
      "referenceProduitDestination": "Antivirus.Firewall.6.postes",
      "label": "Abonnement Antivirus 6postes",
      "numeroCommande": "Order_migration_avfw_xl",
      "typeProduit": "SERVICE",
      "remboursable": true,
      "prix": {
        "duree" : "12",
        "periodicite": 2,
        "montant": "10",
        "typeTVA": "R",
        "modeFacturation": "DATE_ANNIVERSAIRE"
      },
      "referenceDePaiement": "R0000012",
      "modePaiement": "SEPA"
    }
  ]
}
</con:request><con:originalUri>http://localhost/contrat-core/contrat/00003178/migrer</con:originalUri><con:assertion type="XPath Match" name="errorCode"><con:configuration><path>//*:errorCode</path><content>1.1.132</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="errorMessage" disabled="true"><con:configuration><path>//*:errorMessage</path><content>la date de Migration ne doit depasser la date du fin du contrat ${preparation-validation#refContrat}.</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="url"><con:configuration><path>//*:url</path><content>/contrat-core/contrat/${preparation-validation#refContrat}/migrer</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="Valid HTTP Status Codes" name="Valid HTTP Status Codes"><con:configuration><codes>500</codes></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters><entry key="refContrat" value="${preparation-validation#refContrat}" xmlns="http://eviware.com/soapui/config"/></con:parameters></con:restRequest></con:config></con:testStep><con:testStep type="restrequest" name="migrer future"><con:settings/><con:config service="http://localhost:8081" methodName="Method 1" resourcePath="/contrat-core/contrat/{refContrat}/migrer" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="migrer future" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://localhost:8081</con:endpoint><con:request>{
  "user": "test",
  "politiqueMigration": {
    "fraisMigration": "30",
    "fraisResiliation": "true",
    "remboursement": "true",
    "fraisCreation": "true",
    "penalite": "true",
    "reductionAncienne": "true",
    "dateAction": "${=new java.text.SimpleDateFormat("yyyy-MM-dd").format(new Date())}"
  },
  "produitsMigration": [
    {
      "numEC": "1",
      "referenceGammeSource": "securite",
      "referenceProduitSource": "avfwpro-confort-s",
      "referenceGammeDestination": "max",
      "referenceProduitDestination": "Antivirus.Firewall.6.postes",
      "label": "Abonnement Antivirus 6postes",
      "numeroCommande": "Order_migration_avfw_xl",
      "typeProduit": "SERVICE",
      "remboursable": true,
      "prix": {
        "duree" : "12",
        "periodicite": 2,
        "montant": "10",
        "typeTVA": "R",
        "modeFacturation": "DATE_ANNIVERSAIRE"
      },
      "referenceDePaiement": "R0000012",
      "modePaiement": "SEPA"
    }
  ]
}
</con:request><con:originalUri>http://localhost/contrat-core/contrat/00003178/migrer</con:originalUri><con:assertion type="GroovyScriptAssertion" name="Script Assertion"><con:configuration><scriptText>assert messageExchange.hasResponse() == false</scriptText></con:configuration></con:assertion><con:assertion type="Valid HTTP Status Codes" name="Valid HTTP Status Codes"><con:configuration><codes>200</codes></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters><entry key="refContrat" value="${preparation-validation#refContrat}" xmlns="http://eviware.com/soapui/config"/></con:parameters></con:restRequest></con:config></con:testStep><con:testStep type="restrequest" name="Migrer un contrat avec une autre demande dejà active"><con:settings/><con:config service="http://localhost:8081" methodName="Method 1" resourcePath="/contrat-core/contrat/{refContrat}/migrer" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="Migrer un contrat avec une autre demande dejà active" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://localhost:8081</con:endpoint><con:request>{
  "user": "test",
  "politiqueMigration": {
    "fraisMigration": "30",
    "fraisResiliation": "true",
    "remboursement": "true",
    "fraisCreation": "true",
    "penalite": "true",
    "reductionAncienne": "true"
    
  },
  "produitsMigration": [
    {
      "numEC": "1",
      "referenceGammeSource": "securite",
      "referenceProduitSource": "avfwpro-confort-s",
      "referenceGammeDestination": "max",
      "referenceProduitDestination": "Antivirus.Firewall.6.postes",
      "label": "Abonnement Antivirus 6postes",
      "numeroCommande": "Order_migration_avfw_xl",
      "typeProduit": "SERVICE",
      "remboursable": true,
      "prix": {
        "duree" : "12",
        "periodicite": 2,
        "montant": "10",
        "typeTVA": "R",
        "modeFacturation": "DATE_ANNIVERSAIRE"
      },
      "referenceDePaiement": "R0000012",
      "modePaiement": "SEPA"
    }
  ]
}
</con:request><con:originalUri>http://localhost/contrat-core/contrat/00003217/migrer</con:originalUri><con:assertion type="XPath Match" name="errorCode"><con:configuration><path>//*:errorCode</path><content>1.1.130</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="errorMessage" disabled="true"><con:configuration><path>//*:errorMessage</path><content>il existe dejà une demande de Migration pour le contrat  ${preparation-validation#refContrat}. Veuillez l'annuler avant d'effectuer une autre demande.</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="url"><con:configuration><path>//*:url</path><content>/contrat-core/contrat/${preparation-validation#refContrat}/migrer</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="Valid HTTP Status Codes" name="Valid HTTP Status Codes"><con:configuration><codes>500</codes></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters><entry key="refContrat" value="${preparation-validation#refContrat}" xmlns="http://eviware.com/soapui/config"/></con:parameters></con:restRequest></con:config></con:testStep><con:properties/></con:testCase><con:testCase failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="Error renouvellement" searchProperties="true" id="bbc2b076-da19-47e5-8d5d-370677b26997"><con:settings/><con:testStep type="calltestcase" name="resiliation"><con:settings/><con:config xsi:type="con:RunTestCaseStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:targetTestCase>82a3926c-67ae-4136-87ba-1c522c84a422</con:targetTestCase><con:properties><con:property><con:name>refContrat</con:name><con:value>006005001</con:value></con:property></con:properties><con:returnProperties><con:entry>refContrat</con:entry></con:returnProperties><con:runMode>PARALLELL</con:runMode></con:config></con:testStep><con:testStep type="restrequest" name="Sans politique"><con:settings/><con:config service="http://localhost:8081" methodName="Method 1" resourcePath="/contrat-core/contrat/{refContrat}/renouveler" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="Sans politique" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://localhost:8081</con:endpoint><con:request>{

  "user": "ag-renouv",
  "produitRenouvellements": [
    {
      "remboursable": "true",
      "typeProduit": "SERVICE",
      "prix": {
        "periodicite": "1",
        "montant": "25",
        "referenceModePaiement": "R1234567",
        "modeFacturation": "DATE_ANNIVERSAIRE",
        "duree": "10",
        "frais": [
          {
            "montant": "12",
            "typeFrais": "creation"
          },
          {
            "montant": "13",
            "typeFrais": "resiliation"
          }
        ],
        "typeTVA": "SR",
        "modePaiement": "CB"
      },
      "referenceProduit": "avfwpro-confort-s",
      "numeroCommande": "12345",
      "label": "avfwpro-confort-s",
      "numEC": "1",
      "numECParent": ""
    }
  ]
}
</con:request><con:originalUri>http://localhost/contrat-core/contrat/00003284/renouveler</con:originalUri><con:assertion type="XPath Match" name="errorcode"><con:configuration><path>//*:errorCode</path><content>1.1.17</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="errorMessage"><con:configuration><path>//*:errorMessage</path><content>La politique de renouvellement est obligatoire.</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="url"><con:configuration><path>//*:url</path><content>/contrat-core/contrat/${resiliation#refContrat}/renouveler</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="Valid HTTP Status Codes" name="Valid HTTP Status Codes"><con:configuration><codes>500</codes></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters><entry key="refContrat" value="${resiliation#refContrat}" xmlns="http://eviware.com/soapui/config"/></con:parameters></con:restRequest></con:config></con:testStep><con:testStep type="restrequest" name="Sans user"><con:settings/><con:config service="http://localhost:8081" methodName="Method 1" resourcePath="/contrat-core/contrat/{refContrat}/renouveler" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="Sans user" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://localhost:8081</con:endpoint><con:request>{
  "politiqueRenouvellement": {
    "conserverAncienneReduction": "true",
    "force": "false"
  },	
  "produitRenouvellements": [
    {
      "remboursable": "true",
      "typeProduit": "SERVICE",
      "prix": {
        "periodicite": "1",
        "montant": "25",
        "referenceModePaiement": "R1234567",
        "modeFacturation": "DATE_ANNIVERSAIRE",
        "duree": "10",
        "frais": [
          {
            "montant": "12",
            "typeFrais": "creation"
          },
          {
            "montant": "13",
            "typeFrais": "resiliation"
          }
        ],
        "typeTVA": "SR",
        "modePaiement": "CB"
      },
      "referenceProduit": "avfwpro-confort-s",
      "numeroCommande": "12345",
      "label": "avfwpro-confort-s",
      "numEC": "1",
      "numECParent": ""
    }
  ]
}
</con:request><con:originalUri>http://localhost/contrat-core/contrat/00003284/renouveler</con:originalUri><con:assertion type="XPath Match" name="XPath Match"><con:configuration><path>//*:errorCode</path><content>1.1.91</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="errorMessage"><con:configuration><path>//*:errorMessage</path><content>L'element user est obligatoire.</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="url"><con:configuration><path>//*:url</path><content>/contrat-core/contrat/${resiliation#refContrat}/renouveler</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="Valid HTTP Status Codes" name="Valid HTTP Status Codes"><con:configuration><codes>500</codes></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters><entry key="refContrat" value="${resiliation#refContrat}" xmlns="http://eviware.com/soapui/config"/></con:parameters></con:restRequest></con:config></con:testStep><con:testStep type="restrequest" name="Sans type produit"><con:settings/><con:config service="http://localhost:8081" methodName="Method 1" resourcePath="/contrat-core/contrat/{refContrat}/renouveler" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="Sans type produit" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://localhost:8081</con:endpoint><con:request>{
  "politiqueRenouvellement": {
    "conserverAncienneReduction": "true",
    "force": "false"
  },
  "user": "ag-renouv",
  "produitRenouvellements": [
    {
      "remboursable": "true",
      "typeProduit": "",
      "prix": {
        "periodicite": "1",
        "montant": "25",
        "referenceModePaiement": "R1234567",
        "modeFacturation": "DATE_ANNIVERSAIRE",
        "duree": "10",
        "frais": [
          {
            "montant": "12",
            "typeFrais": "creation"
          },
          {
            "montant": "13",
            "typeFrais": "resiliation"
          }
        ],
        "typeTVA": "SR",
        "modePaiement": "CB"
      },
      "referenceProduit": "avfwpro-confort-s",
      "numeroCommande": "12345",
      "label": "avfwpro-confort-s",
      "numEC": "1",
      "numECParent": ""
    }
  ]
}
</con:request><con:originalUri>http://localhost/contrat-core/contrat/00003284/renouveler</con:originalUri><con:assertion type="XPath Match" name="errorCode"><con:configuration><path>//*:errorCode</path><content>1.1.138</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="errorMessage"><con:configuration><path>//*:errorMessage</path><content>Les deux elements doivent avoir le meme type [SERVICE,BIEN]</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="url"><con:configuration><path>//*:url</path><content>/contrat-core/contrat/${resiliation#refContrat}/renouveler</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="Valid HTTP Status Codes" name="Valid HTTP Status Codes"><con:configuration><codes>500</codes></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters><entry key="refContrat" value="${resiliation#refContrat}" xmlns="http://eviware.com/soapui/config"/></con:parameters></con:restRequest></con:config></con:testStep><con:testStep type="restrequest" name="Avec un type produit different de celui de contrat"><con:settings/><con:config service="http://localhost:8081" methodName="Method 1" resourcePath="/contrat-core/contrat/{refContrat}/renouveler" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="Avec un type produit different de celui de contrat" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://localhost:8081</con:endpoint><con:request>{
  "politiqueRenouvellement": {
    "conserverAncienneReduction": "true",
    "force": "false"
  },
  "user": "ag-renouv",
  "produitRenouvellements": [
    {
      "remboursable": "true",
      "typeProduit": "BIEN",
      "prix": {
        "periodicite": "1",
        "montant": "25",
        "referenceModePaiement": "R1234567",
        "modeFacturation": "DATE_ANNIVERSAIRE",
        "duree": "10",
        "frais": [
          {
            "montant": "12",
            "typeFrais": "creation"
          },
          {
            "montant": "13",
            "typeFrais": "resiliation"
          }
        ],
        "typeTVA": "SR",
        "modePaiement": "CB"
      },
      "referenceProduit": "avfwpro-confort-s",
      "numeroCommande": "12345",
      "label": "avfwpro-confort-s",
      "numEC": "1",
      "numECParent": ""
    }
  ]
}
</con:request><con:originalUri>http://localhost/contrat-core/contrat/00003284/renouveler</con:originalUri><con:assertion type="XPath Match" name="errorCode"><con:configuration><path>//*:errorCode</path><content>1.1.138</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="errormessage"><con:configuration><path>//*:errorMessage</path><content>Les deux elements doivent avoir le meme type [SERVICE,BIEN]</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="url"><con:configuration><path>//*:url</path><content>/contrat-core/contrat/${resiliation#refContrat}/renouveler</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="Valid HTTP Status Codes" name="Valid HTTP Status Codes"><con:configuration><codes>500</codes></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters><entry key="refContrat" value="${resiliation#refContrat}" xmlns="http://eviware.com/soapui/config"/></con:parameters></con:restRequest></con:config></con:testStep><con:testStep type="restrequest" name="Sans ref mode de paiement"><con:settings/><con:config service="http://localhost:8081" methodName="Method 1" resourcePath="/contrat-core/contrat/{refContrat}/renouveler" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="Sans ref mode de paiement" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://localhost:8081</con:endpoint><con:request>{
  "politiqueRenouvellement": {
    "conserverAncienneReduction": "true",
    "force": "false"
  },
  "user": "ag-renouv",
  "produitRenouvellements": [
    {
      "remboursable": "true",
      "typeProduit": "SERVICE",
      "prix": {
        "periodicite": "1",
        "montant": "25",
        "referenceModePaiement": "",
        "modeFacturation": "DATE_ANNIVERSAIRE",
        "duree": "10",
        "frais": [
          {
            "montant": "12",
            "typeFrais": "creation"
          },
          {
            "montant": "13",
            "typeFrais": "resiliation"
          }
        ],
        "typeTVA": "SR",
        "modePaiement": "SEPA"
      },
      "referenceProduit": "avfwpro-confort-s",
      "numeroCommande": "12345",
      "label": "avfwpro-confort-s",
      "numEC": "1",
      "numECParent": ""
    }
  ]
}</con:request><con:originalUri>http://localhost/contrat-core/contrat/00003284/renouveler</con:originalUri><con:assertion type="XPath Match" name="errorCode"><con:configuration><path>//*:errorCode</path><content>1.1.37</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="errorMessage" disabled="true"><con:configuration><path>//*:errorMessage</path><content>la Reference de Mode paiement est obligatoire pour les mode de paiement de type  SEPA, FACTURE ou FACTURE FIN DE MOIS .</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="url"><con:configuration><path>//*:url</path><content>/contrat-core/contrat/${resiliation#refContrat}/renouveler</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="Valid HTTP Status Codes" name="Valid HTTP Status Codes"><con:configuration><codes>500</codes></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters><entry key="refContrat" value="${resiliation#refContrat}" xmlns="http://eviware.com/soapui/config"/></con:parameters></con:restRequest></con:config></con:testStep><con:testStep type="restrequest" name="Sans mode de facturation"><con:settings/><con:config service="http://localhost:8081" methodName="Method 1" resourcePath="/contrat-core/contrat/{refContrat}/renouveler" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="Sans mode de facturation" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://localhost:8081</con:endpoint><con:request>{
  "politiqueRenouvellement": {
    "conserverAncienneReduction": "true",
    "force": "false"
  },
  "user": "ag-renouv",
  "produitRenouvellements": [
    {
      "remboursable": "true",
      "typeProduit": "SERVICE",
      "prix": {
        "periodicite": "1",
        "montant": "25",
        "referenceModePaiement": "R1234567",
        "modeFacturation": "",
        "duree": "10",
        "frais": [
          {
            "montant": "12",
            "typeFrais": "creation"
          },
          {
            "montant": "13",
            "typeFrais": "resiliation"
          }
        ],
        "typeTVA": "SR",
        "modePaiement": "CB"
      },
      "referenceProduit": "avfwpro-confort-s",
      "numeroCommande": "12345",
      "label": "avfwpro-confort-s",
      "numEC": "1",
      "numECParent": ""
    }
  ]
}
</con:request><con:originalUri>http://localhost/contrat-core/contrat/00003285/renouveler</con:originalUri><con:assertion type="XPath Match" name="errorCode"><con:configuration><path>//*:errorCode</path><content>0.1.11</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="errorMessage" disabled="true"><con:configuration><path>//*:errorMessage</path><content>Le Prix.modeFacturation ne peut valoir que [PREMIER_MOIS, DATE_ANNIVERSAIRE].</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="url"><con:configuration><path>//*:url</path><content>/contrat-core/contrat/${resiliation#refContrat}/renouveler</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="Valid HTTP Status Codes" name="Valid HTTP Status Codes"><con:configuration><codes>500</codes></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters><entry key="refContrat" value="${resiliation#refContrat}" xmlns="http://eviware.com/soapui/config"/></con:parameters></con:restRequest></con:config></con:testStep><con:testStep type="restrequest" name="Sans periodicite"><con:settings/><con:config service="http://localhost:8081" methodName="Method 1" resourcePath="/contrat-core/contrat/{refContrat}/renouveler" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="Sans periodicite" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://localhost:8081</con:endpoint><con:request>{
  "politiqueRenouvellement": {
    "conserverAncienneReduction": "true",
    "force": "false"
  },
  "user": "ag-renouv",
  "produitRenouvellements": [
    {
      "remboursable": "true",
      "typeProduit": "SERVICE",
      "prix": {
        "periodicite": "",
        "montant": "25",
        "referenceModePaiement": "R1234567",
        "modeFacturation": "DATE_ANNIVERSAIRE",
        "duree": "10",
        "frais": [
          {
            "montant": "12",
            "typeFrais": "creation"
          },
          {
            "montant": "13",
            "typeFrais": "resiliation"
          }
        ],
        "typeTVA": "SR",
        "modePaiement": "CB"
      },
      "referenceProduit": "avfwpro-confort-s",
      "numeroCommande": "12345",
      "label": "avfwpro-confort-s",
      "numEC": "1",
      "numECParent": ""
    }
  ]
}
</con:request><con:originalUri>http://localhost/contrat-core/contrat/00003285/renouveler</con:originalUri><con:assertion type="XPath Match" name="errorCode"><con:configuration><path>//*:errorCode</path><content>1.1.35</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="errorMessage" disabled="true"><con:configuration><path>//*:errorMessage</path><content>un contrat de vente de Service doit avoir un engagement ou Duree ou Periodicite egale a null.</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="url"><con:configuration><path>//*:url</path><content>/contrat-core/contrat/${resiliation#refContrat}/renouveler</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="Valid HTTP Status Codes" name="Valid HTTP Status Codes"><con:configuration><codes>500</codes></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters><entry key="refContrat" value="${resiliation#refContrat}" xmlns="http://eviware.com/soapui/config"/></con:parameters></con:restRequest></con:config></con:testStep><con:testStep type="restrequest" name="Sans duree"><con:settings/><con:config service="http://localhost:8081" methodName="Method 1" resourcePath="/contrat-core/contrat/{refContrat}/renouveler" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="Sans duree" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://localhost:8081</con:endpoint><con:request>{
  "politiqueRenouvellement": {
    "conserverAncienneReduction": "true",
    "force": "false"
  },
  "user": "ag-renouv",
  "produitRenouvellements": [
    {
      "remboursable": "true",
      "typeProduit": "BIEN",
      "prix": {
        "periodicite": "1",
        "montant": "25",
        "referenceModePaiement": "R1234567",
        "modeFacturation": "DATE_ANNIVERSAIRE",
        "duree": "",
        "frais": [
          {
            "montant": "12",
            "typeFrais": "creation"
          },
          {
            "montant": "13",
            "typeFrais": "resiliation"
          }
        ],
        "typeTVA": "SR",
        "modePaiement": "CB"
      },
      "referenceProduit": "avfwpro-confort-s",
      "numeroCommande": "12345",
      "label": "avfwpro-confort-s",
      "numEC": "1",
      "numECParent": ""
    }
  ]
}
</con:request><con:originalUri>http://localhost/contrat-core/contrat/00003285/renouveler</con:originalUri><con:assertion type="XPath Match" name="errorCode"><con:configuration><path>//*:errorCode</path><content>1.1.138</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="errorMessage" disabled="true"><con:configuration><path>//*:errorMessage</path><content>Impossible de renouveler un element contractuel n'ayant aucune duree.</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="url"><con:configuration><path>//*:url</path><content>/contrat-core/contrat/${resiliation#refContrat}/renouveler</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="Valid HTTP Status Codes" name="Valid HTTP Status Codes"><con:configuration><codes>500</codes></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters><entry key="refContrat" value="${resiliation#refContrat}" xmlns="http://eviware.com/soapui/config"/></con:parameters></con:restRequest></con:config></con:testStep><con:testStep type="restrequest" name="Sans TVA"><con:settings/><con:config service="http://localhost:8081" methodName="Method 1" resourcePath="/contrat-core/contrat/{refContrat}/renouveler" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="Sans TVA" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://localhost:8081</con:endpoint><con:request>{
  "politiqueRenouvellement": {
    "conserverAncienneReduction": "true",
    "force": "false"
  },
  "user": "ag-renouv",
  "produitRenouvellements": [
    {
      "remboursable": "true",
      "typeProduit": "SERVICE",
      "prix": {
        "periodicite": "1",
        "montant": "25",
        "referenceModePaiement": "R1234567",
        "modeFacturation": "DATE_ANNIVERSAIRE",
        "duree": "10",
        "frais": [
          {
            "montant": "12",
            "typeFrais": "creation"
          },
          {
            "montant": "13",
            "typeFrais": "resiliation"
          }
        ],
        "typeTVA": "",
        "modePaiement": "CB"
      },
      "referenceProduit": "avfwpro-confort-s",
      "numeroCommande": "12345",
      "label": "avfwpro-confort-s",
      "numEC": "1",
      "numECParent": ""
    }
  ]
}
</con:request><con:originalUri>http://localhost/contrat-core/contrat/00003285/renouveler</con:originalUri><con:assertion type="XPath Match" name="errorCode"><con:configuration><path>//*:errorCode</path><content>0.1.11</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="errorMessage" disabled="true"><con:configuration><path>//*:errorMessage</path><content>Le Prix.typeTVA ne peut valoir que [S, R, SR, P].</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="url"><con:configuration><path>//*:url</path><content>/contrat-core/contrat/${resiliation#refContrat}/renouveler</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="Valid HTTP Status Codes" name="Valid HTTP Status Codes"><con:configuration><codes>500</codes></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters><entry key="refContrat" value="${resiliation#refContrat}" xmlns="http://eviware.com/soapui/config"/></con:parameters></con:restRequest></con:config></con:testStep><con:testStep type="restrequest" name="Sans mode paiement"><con:settings/><con:config service="http://localhost:8081" methodName="Method 1" resourcePath="/contrat-core/contrat/{refContrat}/renouveler" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="Sans mode paiement" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://localhost:8081</con:endpoint><con:request>{
  "politiqueRenouvellement": {
    "conserverAncienneReduction": "true",
    "force": "false"
  },
  "user": "ag-renouv",
  "produitRenouvellements": [
    {
      "remboursable": "true",
      "typeProduit": "SERVICE",
      "prix": {
        "periodicite": "1",
        "montant": "25",
        "referenceModePaiement": "R1234567",
        "modeFacturation": "DATE_ANNIVERSAIRE",
        "duree": "10",
        "frais": [
          {
            "montant": "12",
            "typeFrais": "creation"
          },
          {
            "montant": "13",
            "typeFrais": "resiliation"
          }
        ],
        "typeTVA": "SR",
        "modePaiement": ""
      },
      "referenceProduit": "avfwpro-confort-s",
      "numeroCommande": "12345",
      "label": "avfwpro-confort-s",
      "numEC": "1",
      "numECParent": ""
    }
  ]
}
</con:request><con:originalUri>http://localhost/contrat-core/contrat/00003285/renouveler</con:originalUri><con:assertion type="XPath Match" name="errorCode"><con:configuration><path>//*:errorCode</path><content>0.1.11</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="errorMessage" disabled="true"><con:configuration><path>//*:errorMessage</path><content>Le Prix.modePaiement ne peut valoir que [SEPA, CB, CHEQUE, FACTURE, TROIS_FOIS_SANS_FRAIS, FACTURE_FIN_DE_MOIS].</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="url"><con:configuration><path>//*:url</path><content>/contrat-core/contrat/${resiliation#refContrat}/renouveler</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="Valid HTTP Status Codes" name="Valid HTTP Status Codes"><con:configuration><codes>500</codes></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters><entry key="refContrat" value="${resiliation#refContrat}" xmlns="http://eviware.com/soapui/config"/></con:parameters></con:restRequest></con:config></con:testStep><con:testStep type="restrequest" name="Sans ref produit"><con:settings/><con:config service="http://localhost:8081" methodName="Method 1" resourcePath="/contrat-core/contrat/{refContrat}/renouveler" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="Sans ref produit" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://localhost:8081</con:endpoint><con:request>{
  "politiqueRenouvellement": {
    "conserverAncienneReduction": "true",
    "force": "false"
  },
  "user": "ag-renouv",
  "produitRenouvellements": [
    {
      "remboursable": "true",
      "typeProduit": "SERVICE",
      "prix": {
        "periodicite": "1",
        "montant": "25",
        "referenceModePaiement": "R1234567",
        "modeFacturation": "DATE_ANNIVERSAIRE",
        "duree": "10",
        "frais": [
          {
            "montant": "12",
            "typeFrais": "creation"
          },
          {
            "montant": "13",
            "typeFrais": "resiliation"
          }
        ],
        "typeTVA": "SR",
        "modePaiement": "CB"
      },
      "referenceProduit": "",
      "numeroCommande": "12345",
      "label": "avfwpro-confort-s",
      "numEC": "1",
      "numECParent": ""
    }
  ]
}
</con:request><con:originalUri>http://localhost/contrat-core/contrat/00003285/renouveler</con:originalUri><con:assertion type="XPath Match" name="errorCode"><con:configuration><path>//*:errorCode</path><content>1.1.139</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="errorMessage" disabled="true"><con:configuration><path>//*:errorMessage</path><content>Les deux elements doivent avoir la meme reference.</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="url"><con:configuration><path>//*:url</path><content>/contrat-core/contrat/${resiliation#refContrat}/renouveler</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="Valid HTTP Status Codes" name="Valid HTTP Status Codes"><con:configuration><codes>500</codes></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters><entry key="refContrat" value="${resiliation#refContrat}" xmlns="http://eviware.com/soapui/config"/></con:parameters></con:restRequest></con:config></con:testStep><con:testStep type="restrequest" name="Sans num cmd"><con:settings/><con:config service="http://localhost:8081" methodName="Method 1" resourcePath="/contrat-core/contrat/{refContrat}/renouveler" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="Sans num cmd" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://localhost:8081</con:endpoint><con:request>{
  "politiqueRenouvellement": {
    "conserverAncienneReduction": "true",
    "force": "false"
  },
  "user": "ag-renouv",
  "produitRenouvellements": [
    {
      "remboursable": "true",
      "typeProduit": "SERVICE",
      "prix": {
        "periodicite": "1",
        "montant": "25",
        "referenceModePaiement": "R1234567",
        "modeFacturation": "DATE_ANNIVERSAIRE",
        "duree": "10",
        "frais": [
          {
            "montant": "12",
            "typeFrais": "creation"
          },
          {
            "montant": "13",
            "typeFrais": "resiliation"
          }
        ],
        "typeTVA": "SR",
        "modePaiement": "CB"
      },
      "referenceProduit": "avfwpro-confort-s",
      "numeroCommande": "",
      "label": "avfwpro-confort-s",
      "numEC": "1",
      "numECParent": ""
    }
  ]
}
</con:request><con:originalUri>http://localhost/contrat-core/contrat/00003285/renouveler</con:originalUri><con:assertion type="XPath Match" name="errorCode"><con:configuration><path>//*:errorCode</path><content>0.1.1</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="errormessage" disabled="true"><con:configuration><path>//*:errorMessage</path><content>un des parametres est mal formate : Produit.numeroCommande.</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="url"><con:configuration><path>//*:url</path><content>/contrat-core/contrat/${resiliation#refContrat}/renouveler</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="Valid HTTP Status Codes" name="Valid HTTP Status Codes"><con:configuration><codes>500</codes></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters><entry key="refContrat" value="${resiliation#refContrat}" xmlns="http://eviware.com/soapui/config"/></con:parameters></con:restRequest></con:config></con:testStep><con:testStep type="restrequest" name="Sans label"><con:settings/><con:config service="http://localhost:8081" methodName="Method 1" resourcePath="/contrat-core/contrat/{refContrat}/renouveler" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="Sans label" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://localhost:8081</con:endpoint><con:request>{
  "politiqueRenouvellement": {
    "conserverAncienneReduction": "true",
    "force": "false"
  },
  "user": "ag-renouv",
  "produitRenouvellements": [
    {
      "remboursable": "true",
      "typeProduit": "SERVICE",
      "prix": {
        "periodicite": "1",
        "montant": "25",
        "referenceModePaiement": "R1234567",
        "modeFacturation": "DATE_ANNIVERSAIRE",
        "duree": "10",
        "frais": [
          {
            "montant": "12",
            "typeFrais": "creation"
          },
          {
            "montant": "13",
            "typeFrais": "resiliation"
          }
        ],
        "typeTVA": "SR",
        "modePaiement": "CB"
      },
      "referenceProduit": "avfwpro-confort-s",
      "numeroCommande": "12345",
      "label": "",
      "numEC": "1",
      "numECParent": ""
    }
  ]
}
</con:request><con:originalUri>http://localhost/contrat-core/contrat/00003285/renouveler</con:originalUri><con:assertion type="XPath Match" name="errorCode"><con:configuration><path>//*:errorCode</path><content>0.1.1</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="errorMessage" disabled="true"><con:configuration><path>//*:errorMessage</path><content>un des parametres est mal formate : Produit.label.</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="url"><con:configuration><path>//*:url</path><content>/contrat-core/contrat/${resiliation#refContrat}/renouveler</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="Valid HTTP Status Codes" name="Valid HTTP Status Codes"><con:configuration><codes>500</codes></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters><entry key="refContrat" value="${resiliation#refContrat}" xmlns="http://eviware.com/soapui/config"/></con:parameters></con:restRequest></con:config></con:testStep><con:testStep type="restrequest" name="Sans indiquer son num EC"><con:settings/><con:config service="http://localhost:8081" methodName="Method 1" resourcePath="/contrat-core/contrat/{refContrat}/renouveler" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="Sans indiquer son num EC" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://localhost:8081</con:endpoint><con:request>{
  "politiqueRenouvellement": {
    "conserverAncienneReduction": "true",
    "force": "false"
  },
  "user": "ag-renouv",
  "produitRenouvellements": [
    {
      "remboursable": "true",
      "typeProduit": "BIEN",
      "prix": {
        "periodicite": "1",
        "montant": "25",
        "referenceModePaiement": "R1234567",
        "modeFacturation": "DATE_ANNIVERSAIRE",
        "duree": "10",
        "frais": [
          {
            "montant": "12",
            "typeFrais": "creation"
          },
          {
            "montant": "13",
            "typeFrais": "resiliation"
          }
        ],
        "typeTVA": "SR",
        "modePaiement": "CB"
      },
      "referenceProduit": "avfwpro-confort-s",
      "numeroCommande": "12345",
      "label": "avfwpro-confort-s",
      "numEC": "",
      "numECParent": ""
    }
  ]
}
</con:request><con:originalUri>http://localhost/contrat-core/contrat/00003285/renouveler</con:originalUri><con:assertion type="XPath Match" name="errorCode"><con:configuration><path>//*:errorCode</path><content>1.1.120</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="errorMessage" disabled="true"><con:configuration><path>//*:errorMessage</path><content>Impossible de renouveler un element contractuel absent du contrat.</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="url"><con:configuration><path>//*:url</path><content>/contrat-core/contrat/${resiliation#refContrat}/renouveler</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="Valid HTTP Status Codes" name="Valid HTTP Status Codes"><con:configuration><codes>500</codes></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters><entry key="refContrat" value="${resiliation#refContrat}" xmlns="http://eviware.com/soapui/config"/></con:parameters></con:restRequest></con:config></con:testStep><con:testStep type="calltestcase" name="prepapration-validation"><con:settings/><con:config xsi:type="con:RunTestCaseStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:targetTestCase>6c56c18b-08b8-4072-a062-97a144660809</con:targetTestCase><con:properties><con:property><con:name>refContrat</con:name><con:value>005000016</con:value></con:property><con:property><con:name>refCommande</con:name></con:property></con:properties><con:returnProperties><con:entry>refContrat</con:entry></con:returnProperties><con:runMode>PARALLELL</con:runMode></con:config></con:testStep><con:testStep type="restrequest" name="renouvellement future"><con:settings/><con:config service="http://localhost:8081" methodName="Method 1" resourcePath="/contrat-core/contrat/{refContrat}/renouveler" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="renouvellement future" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://localhost:8081</con:endpoint><con:request>{
  "politiqueRenouvellement": {
    "conserverAncienneReduction": "true",
    "force": "false"
  },
  "user": "ag-renouv",
  "produitRenouvellements": [
    {
      "remboursable": "true",
      "typeProduit": "SERVICE",
      "prix": {
        "periodicite": "1",
        "montant": "25",
        "referenceModePaiement": "R1234567",
        "modeFacturation": "DATE_ANNIVERSAIRE",
        "duree": "10",
        "frais": [
          {
            "montant": "12",
            "typeFrais": "creation"
          },
          {
            "montant": "13",
            "typeFrais": "resiliation"
          }
        ],
        "typeTVA": "SR",
        "modePaiement": "CB"
      },
      "referenceProduit": "avfwpro-confort-s",
      "numeroCommande": "12345",
      "label": "avfwpro-confort-s",
      "numEC": "1",
      "numECParent": ""
    }
  ]
}
</con:request><con:originalUri>http://localhost/contrat-core/contrat/00003303/renouveler</con:originalUri><con:assertion type="GroovyScriptAssertion" name="Script Assertion"><con:configuration><scriptText>assert messageExchange.hasResponse() == false</scriptText></con:configuration></con:assertion><con:assertion type="Valid HTTP Status Codes" name="Valid HTTP Status Codes"><con:configuration><codes>200</codes></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters><entry key="refContrat" value="${prepapration-validation#refContrat}" xmlns="http://eviware.com/soapui/config"/></con:parameters></con:restRequest></con:config></con:testStep><con:testStep type="restrequest" name="Double demande"><con:settings/><con:config service="http://localhost:8081" methodName="Method 1" resourcePath="/contrat-core/contrat/{refContrat}/renouveler" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="Double demande" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://localhost:8081</con:endpoint><con:request>{
  "politiqueRenouvellement": {
    "conserverAncienneReduction": "true",
    "force": "false"
  },
  "user": "ag-renouv",
  "produitRenouvellements": [
    {
      "remboursable": "true",
      "typeProduit": "SERVICE",
      "prix": {
        "periodicite": "1",
        "montant": "25",
        "referenceModePaiement": "R1234567",
        "modeFacturation": "DATE_ANNIVERSAIRE",
        "duree": "10",
        "frais": [
          {
            "montant": "12",
            "typeFrais": "creation"
          },
          {
            "montant": "13",
            "typeFrais": "resiliation"
          }
        ],
        "typeTVA": "SR",
        "modePaiement": "CB"
      },
      "referenceProduit": "avfwpro-confort-s",
      "numeroCommande": "12345",
      "label": "avfwpro-confort-s",
      "numEC": "1",
      "numECParent": ""
    }
  ]
}
</con:request><con:originalUri>http://localhost/contrat-core/contrat/00003303/renouveler</con:originalUri><con:assertion type="XPath Match" name="errorCode"><con:configuration><path>//*:errorCode</path><content>1.1.116</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="errorMessage" disabled="true"><con:configuration><path>//*:errorMessage</path><content>il existe dejà une demande de Renouvellement pour le contrat  ${prepapration-validation#refContrat}. Veuillez l'annuler avant d'effectuer une autre demande.</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="url"><con:configuration><path>//*:url</path><content>/contrat-core/contrat/${prepapration-validation#refContrat}/renouveler</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="Valid HTTP Status Codes" name="Valid HTTP Status Codes"><con:configuration><codes>500</codes></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters><entry key="refContrat" value="${prepapration-validation#refContrat}" xmlns="http://eviware.com/soapui/config"/></con:parameters></con:restRequest></con:config></con:testStep><con:properties/></con:testCase><con:testCase failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="error resiliation" searchProperties="true" id="d3207ea9-3f7d-49c0-bb2f-dd5d16319012"><con:settings/><con:testStep type="calltestcase" name="preparation-validation"><con:settings/><con:config xsi:type="con:RunTestCaseStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:targetTestCase>6c56c18b-08b8-4072-a062-97a144660809</con:targetTestCase><con:properties><con:property><con:name>refContrat</con:name><con:value>202000600</con:value></con:property><con:property><con:name>refCommande</con:name></con:property></con:properties><con:returnProperties><con:entry>refContrat</con:entry></con:returnProperties><con:runMode>PARALLELL</con:runMode></con:config></con:testStep><con:testStep type="restrequest" name="Resiliation dans une date anterieure à la date de jour"><con:settings/><con:config service="http://localhost:8081" methodName="Method 1" resourcePath="/contrat-core/contrat/{refContrat}/resilier" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="Resiliation dans une date anterieure à la date de jour" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://localhost:8081</con:endpoint><con:request>{
  "politiqueResiliation": {
    "fraisResiliation": "true",
    "remboursement": "true",
    "typeResiliation": "RIC",
    "dateResiliation":"2012-01-10",
    "enCascade": "true",
    "montantRemboursement": "",
    "commentaire": "test",
    "motif": "IMPAYE",
    "penalite": "true",
    "montantResiliation": "",
    "commentaire": "this is a test"
  },
  "user": "testeur"
}
</con:request><con:originalUri>http://localhost/contrat-core/contrat/00003215/resilier</con:originalUri><con:assertion type="XPath Match" name="errorCode"><con:configuration><path>//*:errorCode</path><content>1.1.92</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="ErrorMessage" disabled="true"><con:configuration><path>//*:errorMessage</path><content>Date resiliation doit etre superieure ou egale à la date du jour.</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="url"><con:configuration><path>//*:url</path><content>/contrat-core/contrat/${preparation-validation#refContrat}/resilier</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="Valid HTTP Status Codes" name="Valid HTTP Status Codes"><con:configuration><codes>500</codes></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters><entry key="refContrat" value="${preparation-validation#refContrat}" xmlns="http://eviware.com/soapui/config"/></con:parameters></con:restRequest></con:config></con:testStep><con:testStep type="restrequest" name="Politique resiliation avec montant remboursement=x et remboursement=null"><con:settings/><con:config service="http://localhost:8081" methodName="Method 1" resourcePath="/contrat-core/contrat/{refContrat}/resilier" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="Politique resiliation avec montant remboursement=x et remboursement=null" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://localhost:8081</con:endpoint><con:request>{
  "politiqueResiliation": {
    "fraisResiliation": "true",
    "remboursement": "",
    "typeResiliation": "RIC",
    "enCascade": "true",
    "montantRemboursement": "20",
    "commentaire": "test",
    "motif": "IMPAYE",
    "penalite": "true",
    "montantResiliation": "",
    "commentaire": "this is a test"
  },
  "user": "testeur"
}
</con:request><con:originalUri>http://localhost/contrat-core/contrat/00003215/resilier</con:originalUri><con:assertion type="XPath Match" name="errorCode"><con:configuration><path>//*:errorCode</path><content>0.1.1</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="errorMessage" disabled="true"><con:configuration><path>//*:errorMessage</path><content>un des parametres est mal formate : PolitiqueResiliation.remboursement.</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="url"><con:configuration><path>//*:url</path><content>/contrat-core/contrat/${preparation-validation#refContrat}/resilier</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="Valid HTTP Status Codes" name="Valid HTTP Status Codes"><con:configuration><codes>500</codes></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters><entry key="refContrat" value="${preparation-validation#refContrat}" xmlns="http://eviware.com/soapui/config"/></con:parameters></con:restRequest></con:config></con:testStep><con:testStep type="restrequest" name="Politique resiliation avec montant resiliation=x et frais resiliation=null"><con:settings/><con:config service="http://localhost:8081" methodName="Method 1" resourcePath="/contrat-core/contrat/{refContrat}/resilier" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="Politique resiliation avec montant resiliation=x et frais resiliation=null" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://localhost:8081</con:endpoint><con:request>{
  "politiqueResiliation": {
    "fraisResiliation": "",
    "remboursement": "true",
    "typeResiliation": "RIC",
    "enCascade": "true",
    "montantRemboursement": "",
    "commentaire": "test",
    "motif": "IMPAYE",
    "penalite": "true",
    "montantResiliation": "20",
    "commentaire": "this is a test"
  },
  "user": "testeur"
}
</con:request><con:originalUri>http://localhost/contrat-core/contrat/00003215/resilier</con:originalUri><con:assertion type="XPath Match" name="errorcode"><con:configuration><path>//*:errorCode</path><content>0.1.1</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="errorMessage" disabled="true"><con:configuration><path>//*:errorMessage</path><content>un des parametres est mal formate : PolitiqueResiliation.fraisResiliation.</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="url"><con:configuration><path>//*:url</path><content>/contrat-core/contrat/${preparation-validation#refContrat}/resilier</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="Valid HTTP Status Codes" name="Valid HTTP Status Codes"><con:configuration><codes>500</codes></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters><entry key="refContrat" value="${preparation-validation#refContrat}" xmlns="http://eviware.com/soapui/config"/></con:parameters></con:restRequest></con:config></con:testStep><con:testStep type="restrequest" name="Sans type resiliation"><con:settings/><con:config service="http://localhost:8081" methodName="Method 1" resourcePath="/contrat-core/contrat/{refContrat}/resilier" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="Sans type resiliation" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://localhost:8081</con:endpoint><con:request>{
  "politiqueResiliation": {
    "fraisResiliation": "true",
    "remboursement": "true",
    "typeResiliation": "",
    "enCascade": "true",
    "montantRemboursement": "",
    "commentaire": "test",
    "motif": "IMPAYE",
    "penalite": "true",
    "montantResiliation": "",
    "commentaire": "this is a test"
  },
  "user": "testeur"
}
</con:request><con:originalUri>http://localhost/contrat-core/contrat/00003215/resilier</con:originalUri><con:assertion type="XPath Match" name="errorCode"><con:configuration><path>//*:errorCode</path><content>0.1.1</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="ErrorMessage" disabled="true"><con:configuration><path>//*:errorMessage</path><content>Le PolitiqueResiliation.typeResiliation ne peut valoir que [RIN, RIC].</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="url"><con:configuration><path>//*:url</path><content>/contrat-core/contrat/${preparation-validation#refContrat}/resilier</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="Valid HTTP Status Codes" name="Valid HTTP Status Codes"><con:configuration><codes>500</codes></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters><entry key="refContrat" value="${preparation-validation#refContrat}" xmlns="http://eviware.com/soapui/config"/></con:parameters></con:restRequest></con:config></con:testStep><con:testStep type="calltestcase" name="resiliation"><con:settings/><con:config xsi:type="con:RunTestCaseStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:targetTestCase>82a3926c-67ae-4136-87ba-1c522c84a422</con:targetTestCase><con:properties><con:property><con:name>refContrat</con:name><con:value>006007002</con:value></con:property></con:properties><con:returnProperties><con:entry>refContrat</con:entry></con:returnProperties><con:runMode>PARALLELL</con:runMode></con:config></con:testStep><con:testStep type="restrequest" name="Double demande de resiliation"><con:settings/><con:config service="http://localhost:8081" methodName="Method 1" resourcePath="/contrat-core/contrat/{refContrat}/resilier" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="Double demande de resiliation" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://localhost:8081</con:endpoint><con:request>{
  "politiqueResiliation": {
    "fraisResiliation": "true",
    "remboursement": "true",
    "typeResiliation": "RIC",
    "enCascade": "true",
    "montantRemboursement": "",
    "commentaire": "test",
    "motif": "",
    "penalite": "true",
    "montantResiliation": "",
    "commentaire": "this is a test"
  },
  "user": "testeur"
}
</con:request><con:originalUri>http://localhost/contrat-core/contrat/00003216/resilier</con:originalUri><con:assertion type="XPath Match" name="errorCode"><con:configuration><path>//*:errorCode</path><content>1.1.9</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="errorMessage" disabled="true"><con:configuration><path>//*:errorMessage</path><content>le contrat de reference ${resiliation#refContrat} est deja resilier.</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="url"><con:configuration><path>//*:url</path><content>/contrat-core/contrat/${resiliation#refContrat}/resilier</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="Valid HTTP Status Codes" name="Valid HTTP Status Codes"><con:configuration><codes>500</codes></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters><entry key="refContrat" value="${resiliation#refContrat}" xmlns="http://eviware.com/soapui/config"/></con:parameters></con:restRequest></con:config></con:testStep><con:testStep type="restrequest" name="Resilier dans une date qui depasse la date fin contrat"><con:settings/><con:config service="http://localhost:8081" methodName="Method 1" resourcePath="/contrat-core/contrat/{refContrat}/resilier" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="Resilier dans une date qui depasse la date fin contrat" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://localhost:8081</con:endpoint><con:request>{
  "politiqueResiliation": {
    "fraisResiliation": "true",
    "remboursement": "true",
    "typeResiliation": "RIC",
    "dateResiliation": "2017-10-10",
    "enCascade": "true",
    "montantRemboursement": "",
    "commentaire": "test",
    "motif": "",
    "penalite": "true",
    "montantResiliation": "",
    "commentaire": "this is a test"
  },
  "user": "testeur"
}

</con:request><con:originalUri>http://localhost/contrat-core/contrat/00003215/resilier</con:originalUri><con:assertion type="XPath Match" name="errorCode"><con:configuration><path>//*:errorCode</path><content>1.1.132</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="errorMessage" disabled="true"><con:configuration><path>//*:errorMessage</path><content>la date de Resiliation ne doit depasser la date du fin du contrat ${preparation-validation#refContrat}.</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="url"><con:configuration><path>//*:url</path><content>/contrat-core/contrat/${preparation-validation#refContrat}/resilier</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="Valid HTTP Status Codes" name="Valid HTTP Status Codes"><con:configuration><codes>500</codes></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters><entry key="refContrat" value="${preparation-validation#refContrat}" xmlns="http://eviware.com/soapui/config"/></con:parameters></con:restRequest></con:config></con:testStep><con:testStep type="restrequest" name="resiliation future"><con:settings/><con:config service="http://localhost:8081" methodName="Method 1" resourcePath="/contrat-core/contrat/{refContrat}/resilier" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="resiliation future" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://localhost:8081</con:endpoint><con:request>{
  "politiqueResiliation": {
    "fraisResiliation": "true",
    "remboursement": "true",
    "typeResiliation": "RIC",
    "dateResiliation": "${=new java.text.SimpleDateFormat("yyyy-MM-dd").format(new Date())}",
    "enCascade": "true",
    "montantRemboursement": "",
    "commentaire": "test",
    "motif": "",
    "penalite": "true",
    "montantResiliation": "",
    "commentaire": "this is a test"
  },
  "user": "testeur"
}

</con:request><con:originalUri>http://localhost/contrat-core/contrat/00003215/resilier</con:originalUri><con:assertion type="GroovyScriptAssertion" name="Script Assertion"><con:configuration><scriptText>assert messageExchange.hasResponse() == false</scriptText></con:configuration></con:assertion><con:assertion type="Valid HTTP Status Codes" name="Valid HTTP Status Codes"><con:configuration><codes>200</codes></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters><entry key="refContrat" value="${preparation-validation#refContrat}" xmlns="http://eviware.com/soapui/config"/></con:parameters></con:restRequest></con:config></con:testStep><con:testStep type="restrequest" name="Presence d’une demande dejà active"><con:settings/><con:config service="http://localhost:8081" methodName="Method 1" resourcePath="/contrat-core/contrat/{refContrat}/resilier" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="Presence d’une demande dejà active" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://localhost:8081</con:endpoint><con:request>{
  "politiqueResiliation": {
    "fraisResiliation": "true",
    "remboursement": "true",
    "typeResiliation": "RIC",
    
    "enCascade": "true",
    "montantRemboursement": "",
    "commentaire": "test",
    "motif": "",
    "penalite": "true",
    "montantResiliation": "",
    "commentaire": "this is a test"
  },
  "user": "testeur"
}

</con:request><con:originalUri>http://localhost/contrat-core/contrat/00003215/resilier</con:originalUri><con:assertion type="XPath Match" name="errorCode"><con:configuration><path>//*:errorCode</path><content>1.1.130</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="errorMessage" disabled="true"><con:configuration><path>//*:errorMessage</path><content>il existe dejà une demande de Resiliation pour le contrat  ${preparation-validation#refContrat}. Veuillez l'annuler avant d'effectuer une autre demande.</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="url"><con:configuration><path>//*:url</path><content>/contrat-core/contrat/${preparation-validation#refContrat}/resilier</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="Valid HTTP Status Codes" name="Valid HTTP Status Codes"><con:configuration><codes>500</codes></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters><entry key="refContrat" value="${preparation-validation#refContrat}" xmlns="http://eviware.com/soapui/config"/></con:parameters></con:restRequest></con:config></con:testStep><con:testStep type="calltestcase" name="preparation-contrat-vente"><con:settings/><con:config xsi:type="con:RunTestCaseStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:targetTestCase>d9b2d183-2730-46c9-849a-40afae69081e</con:targetTestCase><con:properties><con:property><con:name>refContrat</con:name><con:value>005000028</con:value></con:property></con:properties><con:returnProperties><con:entry>refContrat</con:entry></con:returnProperties><con:runMode>PARALLELL</con:runMode></con:config></con:testStep><con:testStep type="restrequest" name="Resilier un contrat de vente"><con:settings/><con:config service="http://localhost:8081" methodName="Method 1" resourcePath="/contrat-core/contrat/{refContrat}/resilier" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="Resilier un contrat de vente" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://localhost:8081</con:endpoint><con:request>{
  "politiqueResiliation": {
    "fraisResiliation": "true",
    "remboursement": "true",
    "typeResiliation": "RIC",
    
    "enCascade": "true",
    "montantRemboursement": "",
    "commentaire": "test",
    "motif": "",
    "penalite": "true",
    "montantResiliation": "",
    "commentaire": "this is a test"
  },
  "user": "testeur"
}

</con:request><con:originalUri>http://localhost/contrat-core/contrat/00003226/resilier</con:originalUri><con:assertion type="XPath Match" name="errorCode"><con:configuration><path>//*:errorCode</path><content>1.1.95</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="errorMessage" disabled="true"><con:configuration><path>//*:errorMessage</path><content>Impossible de resilier un contrat ne comportant que des elements de vente.</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="url"><con:configuration><path>//*:url</path><content>/contrat-core/contrat/${preparation-contrat-vente#refContrat}/resilier</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="Valid HTTP Status Codes" name="Valid HTTP Status Codes"><con:configuration><codes>500</codes></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters><entry key="refContrat" value="${preparation-contrat-vente#refContrat}" xmlns="http://eviware.com/soapui/config"/></con:parameters></con:restRequest></con:config></con:testStep><con:properties/></con:testCase><con:properties/></con:testSuite><con:testSuite name="Migration"><con:settings/><con:runType>SEQUENTIAL</con:runType><con:testCase failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="ajout un nouveau produit + resilier l’ancien" searchProperties="true" id="a3ffc409-9b08-438d-92b5-46267fff09e6"><con:settings/><con:testStep type="properties" name="migrationInfo"><con:settings/><con:config xsi:type="con:PropertiesStep" saveFirst="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:properties><con:property><con:name>refCommande</con:name><con:value/></con:property><con:property><con:name>numECAncient</con:name><con:value/></con:property></con:properties></con:config></con:testStep><con:testStep type="calltestcase" name="preparation-validation"><con:settings/><con:config xsi:type="con:RunTestCaseStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:targetTestCase>6c56c18b-08b8-4072-a062-97a144660809</con:targetTestCase><con:properties><con:property><con:name>refContrat</con:name><con:value>431000000</con:value></con:property><con:property><con:name>refCommande</con:name></con:property></con:properties><con:returnProperties><con:entry>refContrat</con:entry></con:returnProperties><con:runMode>PARALLELL</con:runMode></con:config></con:testStep><con:testStep type="jdbc" name="contrat ancient"><con:settings/><con:config xsi:type="con:JdbcRequestTestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:driver>com.mysql.jdbc.Driver</con:driver><con:connectionString>jdbc:mysql://localhost:3306/topaze_test?user=test&amp;password=test</con:connectionString><con:query>select * from contrat where reference =
 "${preparation-validation#refContrat}";</con:query><con:assertion type="XPath Match" name="mm reference"><con:configuration><path>//ResultSet/Row/CONTRAT.REFERENCE/text()</path><content>${preparation-validation#refContrat}</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:testStep type="jdbc" name="EC ancients"><con:settings/><con:config xsi:type="con:JdbcRequestTestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:driver>com.mysql.jdbc.Driver</con:driver><con:connectionString>jdbc:mysql://localhost:3306/topaze_test?user=test&amp;password=test</con:connectionString><con:query>select * from elementcontractuel  where contratParent=
(select id from contrat where reference =
 "${preparation-validation#refContrat}");</con:query><con:assertion type="XPath Match" name="nb elements historiques"><con:configuration><path>count(//Row)</path><content>1</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:testStep type="transfer" name="move info contrat ancient"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/></con:testStep><con:testStep type="restrequest" name="migrer"><con:settings/><con:config service="http://localhost:8081" methodName="Method 1" resourcePath="/contrat-core/contrat/{refContrat}/migrer" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="migrer" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://localhost:8081</con:endpoint><con:request>{
  "user": "test",
  "politiqueMigration": {
    "fraisMigration": "30",
    "fraisResiliation": "true",
    "remboursement": "true",
    "fraisCreation": "true",
    "penalite": "true",
    "reductionAncienne": "true"
  },
  "produitsMigration": [
    {
      "numEC": "2",
      "referenceGammeSource": "",
      "referenceProduitSource": "",
      "referenceGammeDestination": "securite",
      "referenceProduitDestination": "Antivirus.Firewall.6.postes",
      "label": "Abonnement Antivirus Firewall 6 postes",
      "numeroCommande": "Order_migration_avfw_xl",
      "typeProduit": "SERVICE",
      "remboursable": true,
      "prix": {
        "duree" : "12",
        "periodicite": 2,
        "montant": "8",
        "typeTVA": "R",
        "modeFacturation": "DATE_ANNIVERSAIRE"
      },
      "referenceDePaiement": "R0000012",
      "modePaiement": "SEPA"
    }
  ]
}
</con:request><con:originalUri>http://localhost/contrat-core/contrat/00003173/migrer</con:originalUri><con:assertion type="GroovyScriptAssertion" name="Script Assertion"><con:configuration><scriptText>assert messageExchange.hasResponse() == false</scriptText></con:configuration></con:assertion><con:assertion type="Valid HTTP Status Codes" name="Valid HTTP Status Codes"><con:configuration><codes>200</codes></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters><entry key="refContrat" value="${preparation-validation#refContrat}" xmlns="http://eviware.com/soapui/config"/></con:parameters></con:restRequest></con:config></con:testStep><con:testStep type="jdbc" name="politique migration"><con:settings/><con:config xsi:type="con:JdbcRequestTestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:driver>com.mysql.jdbc.Driver</con:driver><con:connectionString>jdbc:mysql://localhost:3306/topaze_test?user=test&amp;password=test</con:connectionString><con:query>select * from politiquemigration where id=(
select politiqueMigrationId from avenant
where referencecontrat="${preparation-validation#refContrat}");
</con:query><con:assertion type="XPath Match" name="remboursement"><con:configuration><path>//Row/POLITIQUEMIGRATION.REMBOURSEMENT/text()</path><content>1</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="reduction ancienne"><con:configuration><path>//Row/POLITIQUEMIGRATION.REDUCTIONANCIENNE/text()</path><content>1</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="penalite"><con:configuration><path>//Row/POLITIQUEMIGRATION.PENALITE/text()</path><content>1</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="frais resiliation"><con:configuration><path>//Row/POLITIQUEMIGRATION.FRAISRESILIATION/text()</path><content>1</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="creation"><con:configuration><path>//Row/POLITIQUEMIGRATION.FRAISCREATION/text()</path><content>1</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:testStep type="delay" name="Wait for bon migration intite"><con:settings/><con:config><delay>1000</delay></con:config></con:testStep><con:testStep type="jdbc" name="bon migration initie"><con:settings/><con:config xsi:type="con:JdbcRequestTestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:driver>com.mysql.jdbc.Driver</con:driver><con:connectionString>jdbc:mysql://localhost:3306/topaze_test?user=test&amp;password=test</con:connectionString><con:query>select * 
from bonpreparation 
where reference = "${preparation-validation#RefContrat}"
  and typebonpreparation = "migration";</con:query><con:properties/></con:config></con:testStep><con:testStep type="goto" name="go to bon migration initie"><con:settings/><con:config xsi:type="con:GotoStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:condition><con:name>bon migration initie</con:name><con:type>XPATH</con:type><con:expression>not(//Results/ResultSet/Row/BONPREPARATION.DATEINITIATION/text())</con:expression></con:condition></con:config></con:testStep><con:testStep type="jdbc" name="bon migration-initie"><con:settings/><con:config xsi:type="con:JdbcRequestTestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:driver>com.mysql.jdbc.Driver</con:driver><con:connectionString>jdbc:mysql://localhost:3306/topaze_test?user=test&amp;password=test</con:connectionString><con:query>select * 
from bonpreparation 
where reference = "${preparation-validation#RefContrat}"
  and typebonpreparation = "migration";</con:query><con:assertion type="XPath Match" name="type de bon migration"><con:configuration><path>//*:BONPREPARATION.TYPEBONPREPARATION</path><content>MIGRATION</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="id client"><con:configuration><path>//*:BONPREPARATION.IDCLIENT</path><content>00003870</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="reference"><con:configuration><path>//*:BONPREPARATION.REFERENCE</path><content>${preparation-validation#RefContrat}</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:testStep type="jdbc" name="EL de migration intie"><con:settings/><con:config xsi:type="con:JdbcRequestTestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:driver>com.mysql.jdbc.Driver</con:driver><con:connectionString>jdbc:mysql://localhost:3306/topaze_test?user=test&amp;password=test</con:connectionString><con:query>select * from elementlivraison 
where bonPreparationParent = 
(select id
from bonpreparation 
where reference = "${preparation-validation#RefContrat}"
  and typebonpreparation = "migration")</con:query><con:assertion type="XPath Match" name="nb element migration"><con:configuration><path>count(//*:Row)</path><content>2</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="date initiation"><con:configuration><path>exists(//*:ELEMENTLIVRAISON.DATEINITIATION/text())</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:testStep type="delay" name="wait bon migration prepare"><con:settings/><con:config><delay>1000</delay></con:config></con:testStep><con:testStep type="jdbc" name="bon migration prepare"><con:settings/><con:config xsi:type="con:JdbcRequestTestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:driver>com.mysql.jdbc.Driver</con:driver><con:connectionString>jdbc:mysql://localhost:3306/topaze_test?user=test&amp;password=test</con:connectionString><con:query>select * 
from bonpreparation 
where reference = "${preparation-validation#RefContrat}"
  and typebonpreparation = "migration";</con:query><con:properties/></con:config></con:testStep><con:testStep type="goto" name="go to bon migration prepare"><con:settings/><con:config xsi:type="con:GotoStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:condition><con:name>bon migration prepare</con:name><con:type>XPATH</con:type><con:expression>not(//Results/ResultSet/Row/BONPREPARATION.DATEPREPARATION/text())</con:expression></con:condition></con:config></con:testStep><con:testStep type="jdbc" name="bon migration-prepare"><con:settings/><con:config xsi:type="con:JdbcRequestTestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:driver>com.mysql.jdbc.Driver</con:driver><con:connectionString>jdbc:mysql://localhost:3306/topaze_test?user=test&amp;password=test</con:connectionString><con:query>select * 
from bonpreparation 
where reference = "${preparation-validation#RefContrat}"
  and typebonpreparation = "migration";</con:query><con:assertion type="XPath Match" name="type bon preparation"><con:configuration><path>//*:BONPREPARATION.TYPEBONPREPARATION</path><content>MIGRATION</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="idClient"><con:configuration><path>//*:BONPREPARATION.IDCLIENT</path><content>00003870</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="reference"><con:configuration><path>//*:BONPREPARATION.REFERENCE</path><content>${preparation-validation#RefContrat}</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:testStep type="jdbc" name="el migration prepares"><con:settings/><con:config xsi:type="con:JdbcRequestTestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:driver>com.mysql.jdbc.Driver</con:driver><con:connectionString>jdbc:mysql://localhost:3306/topaze_test?user=test&amp;password=test</con:connectionString><con:query>select * from elementlivraison 
where bonPreparationParent = 
(select id
from bonpreparation 
where reference = "${preparation-validation#RefContrat}"
  and typebonpreparation = "migration")</con:query><con:assertion type="XPath Match" name="nb el migration"><con:configuration><path>count(//*:Row)</path><content>2</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="date preparation"><con:configuration><path>exists(//*:ELEMENTLIVRAISON.DATEPREPARATION/text())</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:testStep type="delay" name="wait end migration"><con:settings/><con:config><delay>500</delay></con:config></con:testStep><con:testStep type="jdbc" name="Bon migration"><con:settings/><con:config xsi:type="con:JdbcRequestTestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:driver>com.mysql.jdbc.Driver</con:driver><con:connectionString>jdbc:mysql://localhost:3306/topaze_test?user=test&amp;password=test</con:connectionString><con:query>select * from bonpreparation
where reference ="${preparation-validation#refContrat}"
and typeBonPreparation='MIGRATION'</con:query><con:properties/></con:config></con:testStep><con:testStep type="goto" name="go to bon migration terminee"><con:settings/><con:config xsi:type="con:GotoStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:condition><con:name>migration</con:name><con:type>XPATH</con:type><con:expression>not(//Results/ResultSet/Row/BONPREPARATION.DATELIVRAISONTERMINE/text())
and
not(//Results/ResultSet/Row/BONPREPARATION.DATERETOURTERMINE/text())</con:expression><con:targetStep>wait end migration</con:targetStep></con:condition></con:config></con:testStep><con:testStep type="jdbc" name="bon migration terminee"><con:settings/><con:config xsi:type="con:JdbcRequestTestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:driver>com.mysql.jdbc.Driver</con:driver><con:connectionString>jdbc:mysql://localhost:3306/topaze_test?user=test&amp;password=test</con:connectionString><con:query>select * 
from bonpreparation 
where reference = "${preparation-validation#RefContrat}"
  and typebonpreparation = "migration";</con:query><con:assertion type="XPath Match" name="mm reference"><con:configuration><path>//*:BONPREPARATION.REFERENCE</path><content>${preparation-validation#RefContrat}</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="date livraison terminee"><con:configuration><path>exists(//*:BONPREPARATION.DATELIVRAISONTERMINE)</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="date retour termine"><con:configuration><path>exists(//*:BONPREPARATION.DATERETOURTERMINE)</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:testStep type="jdbc" name="el migration termines"><con:settings/><con:config xsi:type="con:JdbcRequestTestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:driver>com.mysql.jdbc.Driver</con:driver><con:connectionString>jdbc:mysql://localhost:3306/topaze_test?user=test&amp;password=test</con:connectionString><con:query>select * from elementlivraison 
where bonPreparationParent = 
(select id
from bonpreparation 
where reference = "${preparation-validation#RefContrat}"
  and typebonpreparation = "migration")</con:query><con:assertion type="XPath Match" name="nb el"><con:configuration><path>count(//*:Row)</path><content>2</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XQuery Match" name="acteurs"><con:configuration><path>&lt;Results> 
{ 
 for $x in //Row 
order by $x/ELEMENTLIVRAISON.NUMEC
 return &lt;result>{$x/ELEMENTLIVRAISON.ACTEUR/text()}&lt;/result> 
}
&lt;/Results></path><content><![CDATA[<Results>
  <result>PACKAGER</result>
<result>PACKAGER</result>
</Results>]]></content><allowWildcards>false</allowWildcards></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:testStep type="delay" name="wait end facture"><con:settings/><con:config><delay>500</delay></con:config></con:testStep><con:testStep type="jdbc" name="facture"><con:settings/><con:config xsi:type="con:JdbcRequestTestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:driver>com.mysql.jdbc.Driver</con:driver><con:connectionString>jdbc:mysql://localhost:3306/topaze_test?user=test&amp;password=test</con:connectionString><con:query>select * from movement where productReferenceId="${preparation-validation#refContrat}";</con:query><con:properties/></con:config></con:testStep><con:testStep type="goto" name="go to facture"><con:settings/><con:config xsi:type="con:GotoStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:condition><con:name>facture</con:name><con:type>XPATH</con:type><con:expression>not(//ResultSet/Row[contains(MOVEMENT.PRODUCTID/text(), 'Remboursement')])
</con:expression><con:targetStep>wait end migration</con:targetStep></con:condition></con:config></con:testStep><con:testStep type="jdbc" name="facture valide"><con:settings/><con:config xsi:type="con:JdbcRequestTestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:driver>com.mysql.jdbc.Driver</con:driver><con:connectionString>jdbc:mysql://localhost:3306/topaze_test?user=test&amp;password=test</con:connectionString><con:query>select * from movement where productReferenceId="${preparation-validation#refContrat}";</con:query><con:assertion type="XPath Match" name="frais migration exists"><con:configuration><path>exists(//Row[contains(MOVEMENT.PRODUCTID/text(),'Frais/Migration')])</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="remboursement exists"><con:configuration><path>exists(//Row[contains(MOVEMENT.PRODUCTID/text(),'Remboursement')])</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="frais resiliation exists"><con:configuration><path>exists(//Row[contains(MOVEMENT.PRODUCTID/text(),'Frais/Resiliation')])</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:properties/></con:testCase><con:testCase failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="Migration normal : Packager migration (même gamme) un seul EL avec date retour et date livraison not null" searchProperties="true" id="28247f9f-31fb-4c01-8739-36004a47841f"><con:settings/><con:testStep type="calltestcase" name="preparation-validation"><con:settings/><con:config xsi:type="con:RunTestCaseStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:targetTestCase>6c56c18b-08b8-4072-a062-97a144660809</con:targetTestCase><con:properties><con:property><con:name>refContrat</con:name><con:value>008000003</con:value></con:property><con:property><con:name>refCommande</con:name></con:property></con:properties><con:returnProperties><con:entry>refContrat</con:entry></con:returnProperties><con:runMode>PARALLELL</con:runMode></con:config></con:testStep><con:testStep type="restrequest" name="migrer"><con:settings/><con:config service="http://localhost:8081" methodName="Method 1" resourcePath="/contrat-core/contrat/{refContrat}/migrer" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="migrer" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://localhost:8081</con:endpoint><con:request>{
  "user": "test",
  "politiqueMigration": {
    "fraisMigration": "30",
    "fraisResiliation": "true",
    "remboursement": "true",
    "fraisCreation": "true",
    "penalite": "true",
    "reductionAncienne": "true"
  },
  "produitsMigration": [
    {
      "numEC": "1",
      "referenceGammeSource": "securite",
      "referenceProduitSource": "avfwpro-confort-s",
      "referenceGammeDestination": "securite",
      "referenceProduitDestination": "Antivirus.Firewall.6.postes",
      "label": "Abonnement Antivirus Firewall 6 postes",
      "numeroCommande": "Order_migration_avfw_xl",
      "typeProduit": "SERVICE",
      "remboursable": true,
      "prix": {
        "duree" : "12",
        "periodicite": 2,
        "montant": "8",
        "typeTVA": "R",
        "modeFacturation": "DATE_ANNIVERSAIRE"
      },
      "referenceDePaiement": "R0000012",
      "modePaiement": "SEPA"
    }
  ]
}
</con:request><con:originalUri>http://localhost/contrat-core/contrat/00003174/migrer</con:originalUri><con:assertion type="GroovyScriptAssertion" name="Script Assertion"><con:configuration><scriptText>assert messageExchange.hasResponse() == false</scriptText></con:configuration></con:assertion><con:assertion type="Valid HTTP Status Codes" name="Valid HTTP Status Codes"><con:configuration><codes>200</codes></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters><entry key="refContrat" value="${preparation-validation#refContrat}" xmlns="http://eviware.com/soapui/config"/></con:parameters></con:restRequest></con:config></con:testStep><con:testStep type="jdbc" name="contrat ancient"><con:settings/><con:config xsi:type="con:JdbcRequestTestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:driver>com.mysql.jdbc.Driver</con:driver><con:connectionString>jdbc:mysql://localhost:3306/topaze_test?user=test&amp;password=test</con:connectionString><con:query>select * from contrathistorique where reference =
 "${preparation-validation#refContrat}";</con:query><con:assertion type="XPath Match" name="mm reference"><con:configuration><path>//ResultSet/Row/CONTRATHISTORIQUE.REFERENCE/text()</path><content>${preparation-validation#refContrat}</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:testStep type="jdbc" name="EC ancients"><con:settings/><con:config xsi:type="con:JdbcRequestTestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:driver>com.mysql.jdbc.Driver</con:driver><con:connectionString>jdbc:mysql://localhost:3306/topaze_test?user=test&amp;password=test</con:connectionString><con:query>select * from elementcontractuelhistorique 
where contratParent=
(select id from contrathistorique where reference =
 "${preparation-validation#refContrat}");</con:query><con:assertion type="XPath Match" name="nb EC historique"><con:configuration><path>count(//Row)</path><content>1</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:testStep type="jdbc" name="politique migration"><con:settings/><con:config xsi:type="con:JdbcRequestTestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:driver>com.mysql.jdbc.Driver</con:driver><con:connectionString>jdbc:mysql://localhost:3306/topaze_test?user=test&amp;password=test</con:connectionString><con:query>select * from politiquemigration where id=(
select politiqueMigrationId from avenant
where referencecontrat="${preparation-validation#refContrat}");
</con:query><con:assertion type="XPath Match" name="remboursement"><con:configuration><path>//Row/POLITIQUEMIGRATION.REMBOURSEMENT/text()</path><content>1</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="reduction ancienne"><con:configuration><path>//Row/POLITIQUEMIGRATION.REDUCTIONANCIENNE/text()</path><content>1</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match"><con:configuration/></con:assertion><con:assertion type="XPath Match" name="penalite"><con:configuration><path>//Row/POLITIQUEMIGRATION.PENALITE/text()</path><content>1</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="frais resiliation"><con:configuration><path>//Row/POLITIQUEMIGRATION.FRAISRESILIATION/text()</path><content>1</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="frais creation"><con:configuration><path>//Row/POLITIQUEMIGRATION.FRAISCREATION/text()</path><content>1</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:testStep type="delay" name="wait for bon  migration intitie"><con:settings/><con:config><delay>500</delay></con:config></con:testStep><con:testStep type="jdbc" name="bon migration initie"><con:settings/><con:config xsi:type="con:JdbcRequestTestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:driver>com.mysql.jdbc.Driver</con:driver><con:connectionString>jdbc:mysql://localhost:3306/topaze_test?user=test&amp;password=test</con:connectionString><con:query>select * 
from bonpreparation 
where reference = "${preparation-validation#RefContrat}"
  and typebonpreparation = "migration";</con:query><con:properties/></con:config></con:testStep><con:testStep type="goto" name="go to bon migration initie"><con:settings/><con:config xsi:type="con:GotoStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:condition><con:name>el migration</con:name><con:type>XPATH</con:type><con:expression>not(//Results/ResultSet/Row/BONPREPARATION.DATEINITIATION/text())</con:expression><con:targetStep>wait for bon  migration intitie</con:targetStep></con:condition></con:config></con:testStep><con:testStep type="jdbc" name="bon migration intiee"><con:settings/><con:config xsi:type="con:JdbcRequestTestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:driver>com.mysql.jdbc.Driver</con:driver><con:connectionString>jdbc:mysql://localhost:3306/topaze_test?user=test&amp;password=test</con:connectionString><con:query>select * 
from bonpreparation 
where reference = "${preparation-validation#RefContrat}"
  and typebonpreparation = "migration";</con:query><con:assertion type="XPath Match" name="type bon migration"><con:configuration><path>//*:BONPREPARATION.TYPEBONPREPARATION</path><content>MIGRATION</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="id client"><con:configuration><path>//*:BONPREPARATION.IDCLIENT</path><content>00003870</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="mm reference"><con:configuration><path>//*:BONPREPARATION.REFERENCE</path><content>${preparation-validation#RefContrat}</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="date initiation"><con:configuration><path>exists(//*:BONPREPARATION.DATEINITIATION)</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:testStep type="jdbc" name="el migration inities"><con:settings/><con:config xsi:type="con:JdbcRequestTestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:driver>com.mysql.jdbc.Driver</con:driver><con:connectionString>jdbc:mysql://localhost:3306/topaze_test?user=test&amp;password=test</con:connectionString><con:query>select * from elementlivraison where 
bonPreparationparent =(select id from bonpreparation
where reference ="${preparation-validation#refContrat}"
and typeBonPreparation='MIGRATION');</con:query><con:assertion type="XPath Match" name="nb EL migration"><con:configuration><path>count(//Row)</path><content>1</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XQuery Match" name="acteurs"><con:configuration><path>&lt;Results> 
{ 
 for $x in //Row 
order by $x/ELEMENTLIVRAISON.NUMEC
 return &lt;result>{$x/ELEMENTLIVRAISON.ACTEUR/text()}&lt;/result> 
}
&lt;/Results></path><content>&lt;Results>
  &lt;result>PACKAGER&lt;/result>
&lt;/Results></content><allowWildcards>false</allowWildcards></con:configuration></con:assertion><con:assertion type="XQuery Match" name="date initiation"><con:configuration><path>exists(//*:ELEMENTLIVRAISON.DATEINITIATION)</path><content>true</content><allowWildcards>false</allowWildcards></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:testStep type="delay" name="wait bon  migration preparee"><con:settings/><con:config><delay>500</delay></con:config></con:testStep><con:testStep type="jdbc" name="Bon migration"><con:settings/><con:config xsi:type="con:JdbcRequestTestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:driver>com.mysql.jdbc.Driver</con:driver><con:connectionString>jdbc:mysql://localhost:3306/topaze_test?user=test&amp;password=test</con:connectionString><con:query>select * from bonpreparation
where reference ="${preparation-validation#refContrat}"
and typeBonPreparation='MIGRATION'</con:query><con:assertion type="XPath Match" name="mm reference"><con:configuration><path>//ResultSet/Row/BONPREPARATION.REFERENCE/text()</path><content>${preparation-validation#refContrat}</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="type Bon"><con:configuration><path>//ResultSet/Row/BONPREPARATION.TYPEBONPREPARATION/text()</path><content>MIGRATION</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:testStep type="goto" name="go to migration preparee"><con:settings/><con:config xsi:type="con:GotoStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:condition><con:name>migration</con:name><con:type>XPATH</con:type><con:expression>not(//Results/ResultSet/Row/BONPREPARATION.DATEPREPARATION/text())
</con:expression><con:targetStep>wait bon  migration preparee</con:targetStep></con:condition></con:config></con:testStep><con:testStep type="jdbc" name="bon migration preparee"><con:settings/><con:config xsi:type="con:JdbcRequestTestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:driver>com.mysql.jdbc.Driver</con:driver><con:connectionString>jdbc:mysql://localhost:3306/topaze_test?user=test&amp;password=test</con:connectionString><con:query>select * from bonpreparation
where reference
="${preparation-validation#refContrat}"
and typeBonPreparation='MIGRATION'</con:query><con:assertion type="XPath Match" name="id client"><con:configuration><path>//*:BONPREPARATION.IDCLIENT</path><content>00003870</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="mm reference"><con:configuration><path>//*:BONPREPARATION.REFERENCE</path><content>${preparation-validation#refContrat}</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="date preparation"><con:configuration><path>exists(//*:BONPREPARATION.DATEPREPARATION)</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:testStep type="jdbc" name="el migration prepares"><con:settings/><con:config xsi:type="con:JdbcRequestTestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:driver>com.mysql.jdbc.Driver</con:driver><con:connectionString>jdbc:mysql://localhost:3306/topaze_test?user=test&amp;password=test</con:connectionString><con:query>select * from elementlivraison where 
bonPreparationparent =(select id from bonpreparation
where reference ="${preparation-validation#refContrat}"
and typeBonPreparation='MIGRATION');</con:query><con:assertion type="XPath Match" name="type contrat"><con:configuration><path>//*:ELEMENTLIVRAISON.TYPECONTRAT</path><content>ABONNEMENT</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="type bon migration"><con:configuration><path>//*:ELEMENTLIVRAISON.TYPEBONPREPARATION</path><content>MIGRATION</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="date preparation exists"><con:configuration><path>exists(//*:ELEMENTLIVRAISON.DATEDEBUTPREPARATION)</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:testStep type="delay" name="wait end migration"><con:settings/><con:config><delay>1000</delay></con:config></con:testStep><con:testStep type="jdbc" name="bon migration"><con:settings/><con:config xsi:type="con:JdbcRequestTestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:driver>com.mysql.jdbc.Driver</con:driver><con:connectionString>jdbc:mysql://localhost:3306/topaze_test?user=test&amp;password=test</con:connectionString><con:query>select * from bonpreparation
where reference
="${preparation-validation#refContrat}"
and typeBonPreparation='MIGRATION'</con:query><con:properties/></con:config></con:testStep><con:testStep type="goto" name="go to bon migration terminee"><con:settings/><con:config xsi:type="con:GotoStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:condition><con:name>migration terminee</con:name><con:type>XPATH</con:type><con:expression>not(//Results/ResultSet/Row/BONPREPARATION.DATELIVRAISONTERMINE/text())
and
not(//Results/ResultSet/Row/BONPREPARATION.DATERETOURTERMINE/text())</con:expression></con:condition></con:config></con:testStep><con:testStep type="jdbc" name="el migration terminees"><con:settings/><con:config xsi:type="con:JdbcRequestTestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:driver>com.mysql.jdbc.Driver</con:driver><con:connectionString>jdbc:mysql://localhost:3306/topaze_test?user=test&amp;password=test</con:connectionString><con:query>select * from elementlivraison where 
bonPreparationparent =(select id from bonpreparation
where reference ="${preparation-validation#refContrat}"
and typeBonPreparation='MIGRATION');</con:query><con:assertion type="XPath Match" name="acteur"><con:configuration><path>//*:ELEMENTLIVRAISON.ACTEUR</path><content>PACKAGER</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="retailer package"><con:configuration><path>exists(//*:ELEMENTLIVRAISON.RETAILERPACKAGERID)</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="date retour"><con:configuration><path>exists(//*:ELEMENTLIVRAISON.DATERETOURTERMINE)</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="date livraison"><con:configuration><path>exists(//*:ELEMENTLIVRAISON.DATELIVRAISONTERMINE)</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:testStep type="jdbc" name="bon migration terminee"><con:settings/><con:config xsi:type="con:JdbcRequestTestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:driver>com.mysql.jdbc.Driver</con:driver><con:connectionString>jdbc:mysql://localhost:3306/topaze_test?user=test&amp;password=test</con:connectionString><con:query>select * from bonpreparation
where reference
="${preparation-validation#refContrat}"
and typeBonPreparation='MIGRATION'</con:query><con:assertion type="XPath Match" name="type bon migration"><con:configuration><path>//*:BONPREPARATION.TYPEBONPREPARATION</path><content>MIGRATION</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="mm refrence"><con:configuration><path>//*:BONPREPARATION.REFERENCE</path><content>${preparation-validation#refContrat}</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="date retour"><con:configuration><path>exists(//*:BONPREPARATION.DATERETOURTERMINE)</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="date livraison"><con:configuration><path>exists(//*:BONPREPARATION.DATELIVRAISONTERMINE)</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:testStep type="delay" name="wait end facture"><con:settings/><con:config><delay>1000</delay></con:config></con:testStep><con:testStep type="jdbc" name="facture"><con:settings/><con:config xsi:type="con:JdbcRequestTestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:driver>com.mysql.jdbc.Driver</con:driver><con:connectionString>jdbc:mysql://localhost:3306/topaze_test?user=test&amp;password=test</con:connectionString><con:query>select * from movement where productReferenceId="${preparation-validation#refContrat}";</con:query><con:properties/></con:config></con:testStep><con:testStep type="goto" name="go to facture"><con:settings/><con:config xsi:type="con:GotoStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:condition><con:name>facture</con:name><con:type>XPATH</con:type><con:expression>not(//ResultSet/Row[contains(MOVEMENT.PRODUCTID/text(), 'Remboursement')])</con:expression><con:targetStep>wait for bon  migration intitie</con:targetStep></con:condition></con:config></con:testStep><con:testStep type="jdbc" name="facture valide"><con:settings/><con:config xsi:type="con:JdbcRequestTestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:driver>com.mysql.jdbc.Driver</con:driver><con:connectionString>jdbc:mysql://localhost:3306/topaze_test?user=test&amp;password=test</con:connectionString><con:query>select * from movement where productReferenceId="${preparation-validation#refContrat}";</con:query><con:assertion type="XPath Match" name="nb mvt"><con:configuration><path>count(//Row)</path><content>6</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="frais migration exists"><con:configuration><path>exists(//Row[contains(MOVEMENT.PRODUCTID/text(),'Frais/Migration')])</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="remboursement exists"><con:configuration><path>exists(//Row[contains(MOVEMENT.PRODUCTID/text(),'Remboursement')])</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="frais resilation"><con:configuration><path>exists(//Row[contains(MOVEMENT.PRODUCTID/text(),'Frais/Resiliation')])</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:properties/></con:testCase><con:testCase failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name=": Packager : EL livraison + EL Retour" searchProperties="true" id="cf510e06-8aea-4dda-9997-aeb4ad09f504"><con:settings/><con:testStep type="calltestcase" name="preparation-validation"><con:settings/><con:config xsi:type="con:RunTestCaseStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:targetTestCase>6c56c18b-08b8-4072-a062-97a144660809</con:targetTestCase><con:properties><con:property><con:name>refContrat</con:name><con:value>006006003</con:value></con:property><con:property><con:name>refCommande</con:name></con:property></con:properties><con:returnProperties><con:entry>refContrat</con:entry></con:returnProperties><con:runMode>PARALLELL</con:runMode></con:config></con:testStep><con:testStep type="restrequest" name="migrer"><con:settings/><con:config service="http://localhost:8081" methodName="Method 1" resourcePath="/contrat-core/contrat/{refContrat}/migrer" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="migrer" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://localhost:8081</con:endpoint><con:request>{
  "user": "test",
  "politiqueMigration": {
    "fraisMigration": "30",
    "fraisResiliation": "true",
    "remboursement": "true",
    "fraisCreation": "true",
    "penalite": "true",
    "reductionAncienne": "true"
  },
  "produitsMigration": [
    {
      "numEC": "1",
      "referenceGammeSource": "securite",
      "referenceProduitSource": "avfwpro-confort-s",
      "referenceGammeDestination": "max",
      "referenceProduitDestination": "Antivirus.Firewall.6.postes",
      "label": "Abonnement Antivirus Firewall 6 postes",
      "numeroCommande": "Order_migration_avfw_xl",
      "typeProduit": "SERVICE",
      "remboursable": true,
      "prix": {
        "duree" : "12",
        "periodicite": 2,
        "montant": "8",
        "typeTVA": "R",
        "modeFacturation": "DATE_ANNIVERSAIRE"
      },
      "referenceDePaiement": "R0000012",
      "modePaiement": "SEPA"
    }
  ]
}
</con:request><con:originalUri>http://localhost/contrat-core/contrat//migrer</con:originalUri><con:assertion type="GroovyScriptAssertion" name="Script Assertion"><con:configuration><scriptText>assert messageExchange.hasResponse() == false</scriptText></con:configuration></con:assertion><con:assertion type="Valid HTTP Status Codes" name="Valid HTTP Status Codes"><con:configuration><codes>200</codes></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters><entry key="refContrat" value="${preparation-validation#refContrat}" xmlns="http://eviware.com/soapui/config"/></con:parameters></con:restRequest></con:config></con:testStep><con:testStep type="jdbc" name="contrat ancient"><con:settings/><con:config xsi:type="con:JdbcRequestTestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:driver>com.mysql.jdbc.Driver</con:driver><con:connectionString>jdbc:mysql://localhost:3306/topaze_test?user=test&amp;password=test</con:connectionString><con:query>select * from contrathistorique where reference =
 "${preparation-validation#refContrat}";</con:query><con:assertion type="XPath Match" name="mm reference"><con:configuration><path>//ResultSet/Row/CONTRATHISTORIQUE.REFERENCE/text()</path><content>${preparation-validation#refContrat}</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:testStep type="jdbc" name="EL ancients"><con:settings/><con:config xsi:type="con:JdbcRequestTestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:driver>com.mysql.jdbc.Driver</con:driver><con:connectionString>jdbc:mysql://localhost:3306/topaze_test?user=test&amp;password=test</con:connectionString><con:query>select * from elementcontractuelhistorique 
where contratParent=
(select id from contrathistorique where reference =
 "${preparation-validation#refContrat}");</con:query><con:assertion type="XPath Match" name="nb elements historique"><con:configuration><path>count(//Row)</path><content>1</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:testStep type="jdbc" name="politique migration"><con:settings/><con:config xsi:type="con:JdbcRequestTestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:driver>com.mysql.jdbc.Driver</con:driver><con:connectionString>jdbc:mysql://localhost:3306/topaze_test?user=test&amp;password=test</con:connectionString><con:query>select * from politiquemigration where id=(
select politiqueMigrationId from avenant
where referencecontrat="${preparation-validation#refContrat}");
</con:query><con:assertion type="XPath Match" name="remboursement"><con:configuration><path>//Row/POLITIQUEMIGRATION.REMBOURSEMENT/text()</path><content>1</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="reduction ancienne"><con:configuration><path>//Row/POLITIQUEMIGRATION.REDUCTIONANCIENNE/text()</path><content>1</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="penalite"><con:configuration><path>//Row/POLITIQUEMIGRATION.PENALITE/text()</path><content>1</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="frais resiliation"><con:configuration><path>//Row/POLITIQUEMIGRATION.FRAISRESILIATION/text()</path><content>1</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="frais migration"><con:configuration><path>//Row/POLITIQUEMIGRATION.FRAISCREATION/text()</path><content>1</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:testStep type="delay" name="wait bon migration initiee"><con:settings/><con:config><delay>500</delay></con:config></con:testStep><con:testStep type="jdbc" name="bon migration initiee"><con:settings/><con:config xsi:type="con:JdbcRequestTestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:driver>com.mysql.jdbc.Driver</con:driver><con:connectionString>jdbc:mysql://localhost:3306/topaze_test?user=test&amp;password=test</con:connectionString><con:query>select * from bonpreparation
where reference ="${preparation-validation#refContrat}"
and typeBonPreparation='MIGRATION'</con:query><con:properties/></con:config></con:testStep><con:testStep type="goto" name="go to bon migration initiee"><con:settings/><con:config xsi:type="con:GotoStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:condition><con:name>el migration</con:name><con:type>XPATH</con:type><con:expression>not(//Results/ResultSet/Row/BONPREPARATION.DATEINITIATION/text())</con:expression><con:targetStep>wait bon migration initiee</con:targetStep></con:condition></con:config></con:testStep><con:testStep type="jdbc" name="bon migration-initiee"><con:settings/><con:config xsi:type="con:JdbcRequestTestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:driver>com.mysql.jdbc.Driver</con:driver><con:connectionString>jdbc:mysql://localhost:3306/topaze_test?user=test&amp;password=test</con:connectionString><con:query>select * from bonpreparation
where reference ="${preparation-validation#refContrat}"
and typeBonPreparation='MIGRATION'</con:query><con:assertion type="XPath Match" name="type bon migration"><con:configuration><path>//*:BONPREPARATION.TYPEBONPREPARATION</path><content>MIGRATION</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="id client"><con:configuration><path>//*:BONPREPARATION.IDCLIENT</path><content>00003870</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="date initiation"><con:configuration><path>exists(//*:BONPREPARATION.DATEINITIATION)</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:testStep type="jdbc" name="el migration inities"><con:settings/><con:config xsi:type="con:JdbcRequestTestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:driver>com.mysql.jdbc.Driver</con:driver><con:connectionString>jdbc:mysql://localhost:3306/topaze_test?user=test&amp;password=test</con:connectionString><con:query>select * from elementlivraison where 
bonPreparationparent =(select id from bonpreparation
where reference ="${preparation-validation#refContrat}"
and typeBonPreparation='MIGRATION');</con:query><con:assertion type="XQuery Match" name="acteurs"><con:configuration><path>&lt;Results> 
{ 
 for $x in //Row 
order by $x/ELEMENTLIVRAISON.NUMEC
 return &lt;result>{$x/ELEMENTLIVRAISON.ACTEUR/text()}&lt;/result> 
}
&lt;/Results></path><content><![CDATA[<Results>
  <result>PACKAGER</result>
  <result>PACKAGER</result>
</Results>]]></content><allowWildcards>false</allowWildcards></con:configuration></con:assertion><con:assertion type="XQuery Match" name="type contrat"><con:configuration><path>&lt;Results> 
{ 
 for $x in //Row 
order by $x/ELEMENTLIVRAISON.NUMEC
 return &lt;result>{$x/ELEMENTLIVRAISON.TYPECONTRAT/text()}&lt;/result> 
}
&lt;/Results></path><content><![CDATA[<Results>
  <result>ABONNEMENT</result>
  <result>ABONNEMENT</result>
</Results>]]></content><allowWildcards>false</allowWildcards></con:configuration></con:assertion><con:assertion type="XPath Match" name="date initiation"><con:configuration><path>exists(//*:ELEMENTLIVRAISON.DATEINITIATION)</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:testStep type="delay" name="wait bon migration preparee"><con:settings/><con:config><delay>1000</delay></con:config></con:testStep><con:testStep type="jdbc" name="bon migration preparee"><con:settings/><con:config xsi:type="con:JdbcRequestTestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:driver>com.mysql.jdbc.Driver</con:driver><con:connectionString>jdbc:mysql://localhost:3306/topaze_test?user=test&amp;password=test</con:connectionString><con:query>select * from bonpreparation
where reference ="${preparation-validation#refContrat}"
and typeBonPreparation='MIGRATION'</con:query><con:properties/></con:config></con:testStep><con:testStep type="goto" name="go to bon migration preparee"><con:settings/><con:config xsi:type="con:GotoStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:condition><con:name>bon migration prepares</con:name><con:type>XPATH</con:type><con:expression>not(//Results/ResultSet/Row/BONPREPARATION.DATEPREPARATION/text())
</con:expression></con:condition></con:config></con:testStep><con:testStep type="jdbc" name="bon migration-preparee"><con:settings/><con:config xsi:type="con:JdbcRequestTestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:driver>com.mysql.jdbc.Driver</con:driver><con:connectionString>jdbc:mysql://localhost:3306/topaze_test?user=test&amp;password=test</con:connectionString><con:query>select * from bonpreparation
where reference =
"${preparation-validation#refContrat}"
and typeBonPreparation='MIGRATION'</con:query><con:assertion type="XPath Match" name="type bon migration"><con:configuration><path>//*:BONPREPARATION.TYPEBONPREPARATION</path><content>MIGRATION</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="reference"><con:configuration><path>//*:BONPREPARATION.REFERENCE</path><content>${preparation-validation#refContrat}</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="date preparation"><con:configuration><path>exists(//*:BONPREPARATION.DATEPREPARATION)</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:testStep type="jdbc" name="el migration prepares"><con:settings/><con:config xsi:type="con:JdbcRequestTestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:driver>com.mysql.jdbc.Driver</con:driver><con:connectionString>jdbc:mysql://localhost:3306/topaze_test?user=test&amp;password=test</con:connectionString><con:query>select * from elementlivraison where 
bonPreparationparent =(select id from bonpreparation
where reference ="${preparation-validation#refContrat}"
and typeBonPreparation='MIGRATION');</con:query><con:assertion type="XPath Match" name="date preapration"><con:configuration><path>exists(//*:ELEMENTLIVRAISON.DATEDEBUTPREPARATION)</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XQuery Match" name="idr liv"><con:configuration><path>&lt;Results> 
{ 
 for $x in //Row 
order by $x/ELEMENTLIVRAISON.NUMEC
 return &lt;result>{$x/ELEMENTLIVRAISON.ADDRESSELIVRAISON/text()}&lt;/result> 
}
&lt;/Results></path><content><![CDATA[<Results>
  <result>idr</result>
  <result>idr</result>
</Results>]]></content><allowWildcards>false</allowWildcards></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:testStep type="delay" name="wait end migration"><con:settings/><con:config><delay>500</delay></con:config></con:testStep><con:testStep type="jdbc" name="bon migration terminee"><con:settings/><con:config xsi:type="con:JdbcRequestTestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:driver>com.mysql.jdbc.Driver</con:driver><con:connectionString>jdbc:mysql://localhost:3306/topaze_test?user=test&amp;password=test</con:connectionString><con:query>select * from bonpreparation
where reference ="${preparation-validation#refContrat}"
and typeBonPreparation='MIGRATION'</con:query><con:assertion type="XPath Match" name="mm reference"><con:configuration><path>//ResultSet/Row/BONPREPARATION.REFERENCE/text()</path><content>${preparation-validation#refContrat}</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="type bon"><con:configuration><path>//ResultSet/Row/BONPREPARATION.TYPEBONPREPARATION/text()</path><content>MIGRATION</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:testStep type="goto" name="go to bon migration terminee"><con:settings/><con:config xsi:type="con:GotoStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:condition><con:name>migration</con:name><con:type>XPATH</con:type><con:expression>not(//Results/ResultSet/Row/BONPREPARATION.DATELIVRAISONTERMINE/text())
and
not(//Results/ResultSet/Row/BONPREPARATION.DATERETOURTERMINE/text())</con:expression><con:targetStep>wait end migration</con:targetStep></con:condition></con:config></con:testStep><con:testStep type="jdbc" name="bon migration-terminee"><con:settings/><con:config xsi:type="con:JdbcRequestTestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:driver>com.mysql.jdbc.Driver</con:driver><con:connectionString>jdbc:mysql://localhost:3306/topaze_test?user=test&amp;password=test</con:connectionString><con:query>select * from bonpreparation
where reference =
"${preparation-validation#refContrat}"
and typeBonPreparation='MIGRATION'</con:query><con:assertion type="XPath Match" name="mm reference"><con:configuration><path>//ResultSet/Row/BONPREPARATION.REFERENCE/text()</path><content>${preparation-validation#refContrat}</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="type bon "><con:configuration><path>//ResultSet/Row/BONPREPARATION.TYPEBONPREPARATION/text()</path><content>MIGRATION</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="date livraison"><con:configuration><path>exists(//*:BONPREPARATION.DATELIVRAISONTERMINE)</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="date retour"><con:configuration><path>exists(//*:BONPREPARATION.DATERETOURTERMINE)</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:testStep type="jdbc" name="el migration terminee"><con:settings/><con:config xsi:type="con:JdbcRequestTestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:driver>com.mysql.jdbc.Driver</con:driver><con:connectionString>jdbc:mysql://localhost:3306/topaze_test?user=test&amp;password=test</con:connectionString><con:query>select * from elementlivraison where 
bonPreparationparent =(select id from bonpreparation
where reference ="${preparation-validation#refContrat}"
and typeBonPreparation='MIGRATION');</con:query><con:assertion type="XPath Match" name="date livraison"><con:configuration><path>exists(//*:ELEMENTLIVRAISON.DATELIVRAISONTERMINE)</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="date retour"><con:configuration><path>exists(//*:ELEMENTLIVRAISON.DATERETOURTERMINE)</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:testStep type="delay" name="wait en facture"><con:settings/><con:config><delay>1000</delay></con:config></con:testStep><con:testStep type="jdbc" name="facture"><con:settings/><con:config xsi:type="con:JdbcRequestTestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:driver>com.mysql.jdbc.Driver</con:driver><con:connectionString>jdbc:mysql://localhost:3306/topaze_test?user=test&amp;password=test</con:connectionString><con:query>select * from movement where productReferenceId="${preparation-validation#refContrat}";</con:query><con:properties/></con:config></con:testStep><con:testStep type="goto" name="go to facture"><con:settings/><con:config xsi:type="con:GotoStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:condition><con:name>facture</con:name><con:type>XPATH</con:type><con:expression>not(//ResultSet/Row[contains(MOVEMENT.PRODUCTID/text(), 'Remboursement')])</con:expression><con:targetStep>wait en facture</con:targetStep></con:condition></con:config></con:testStep><con:testStep type="jdbc" name="facture valide"><con:settings/><con:config xsi:type="con:JdbcRequestTestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:driver>com.mysql.jdbc.Driver</con:driver><con:connectionString>jdbc:mysql://localhost:3306/topaze_test?user=test&amp;password=test</con:connectionString><con:query>select * from movement where productReferenceId="${preparation-validation#refContrat}";</con:query><con:assertion type="XPath Match" name="frais migration exists"><con:configuration><path>exists(//Row[contains(MOVEMENT.PRODUCTID/text(),'Frais/Migration')])</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="remboursement"><con:configuration><path>exists(//Row[contains(MOVEMENT.PRODUCTID/text(),'Remboursement')])</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XQuery Match" name="frais resilation"><con:configuration><path>exists(//Row[contains(MOVEMENT.PRODUCTID/text(),'Frais/Resiliation')])</path><content>true</content><allowWildcards>false</allowWildcards></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:properties/></con:testCase><con:testCase failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="Migration administrative : pas de creation ni d’EL ni de BP" searchProperties="true" id="e7d92f1f-bd16-4a51-bce4-343baa619a29"><con:settings/><con:testStep type="calltestcase" name="preparation-validation"><con:settings/><con:config xsi:type="con:RunTestCaseStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:targetTestCase>6c56c18b-08b8-4072-a062-97a144660809</con:targetTestCase><con:properties><con:property><con:name>refContrat</con:name><con:value>302000200</con:value></con:property><con:property><con:name>refCommande</con:name></con:property></con:properties><con:returnProperties><con:entry>refContrat</con:entry></con:returnProperties><con:runMode>PARALLELL</con:runMode></con:config></con:testStep><con:testStep type="restrequest" name="migrer"><con:settings/><con:config service="http://localhost:8081" methodName="Method 1" resourcePath="/contrat-core/contrat/{refContrat}/migrer" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="migrer" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://localhost:8081</con:endpoint><con:request>{
  "user": "test",
  "politiqueMigration": {
    "fraisMigration": "30",
    "fraisResiliation": "true",
    "remboursement": "true",
    "fraisCreation": "true",
    "penalite": "true",
    "reductionAncienne": "true"
  },
  "produitsMigration": [
    {
      "numEC": "1",
      "referenceGammeSource": "securite",
      "referenceProduitSource": "avfwpro-confort-s",
      "referenceGammeDestination": "securite",
      "referenceProduitDestination": "avfwpro-confort-s",
      "label": "Abonnement Antivirus Firewall 6 postes",
      "numeroCommande": "Order_migration_avfw_xl",
      "typeProduit": "SERVICE",
      "remboursable": true,
      "prix": {
        "duree" : "12",
        "periodicite": 2,
        "montant": "8",
        "typeTVA": "R",
        "modeFacturation": "DATE_ANNIVERSAIRE"
      },
      "referenceDePaiement": "R0000012",
      "modePaiement": "SEPA"
    }
  ]
}
</con:request><con:originalUri>http://localhost/contrat-core/contrat/00003181/migrer</con:originalUri><con:assertion type="GroovyScriptAssertion" name="Script Assertion"><con:configuration><scriptText>assert messageExchange.hasResponse() == false</scriptText></con:configuration></con:assertion><con:assertion type="Valid HTTP Status Codes" name="Valid HTTP Status Codes"><con:configuration><codes>200</codes></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters><entry key="refContrat" value="${preparation-validation#refContrat}" xmlns="http://eviware.com/soapui/config"/></con:parameters></con:restRequest></con:config></con:testStep><con:testStep type="jdbc" name="contrat ancient"><con:settings/><con:config xsi:type="con:JdbcRequestTestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:driver>com.mysql.jdbc.Driver</con:driver><con:connectionString>jdbc:mysql://localhost:3306/topaze_test?user=test&amp;password=test</con:connectionString><con:query>select * from contrathistorique where reference =
 "${preparation-validation#refContrat}";</con:query><con:assertion type="XPath Match" name="mm reference"><con:configuration><path>//ResultSet/Row/CONTRATHISTORIQUE.REFERENCE/text()</path><content>${preparation-validation#refContrat}</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:testStep type="jdbc" name="EC ancients"><con:settings/><con:config xsi:type="con:JdbcRequestTestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:driver>com.mysql.jdbc.Driver</con:driver><con:connectionString>jdbc:mysql://localhost:3306/topaze_test?user=test&amp;password=test</con:connectionString><con:query>select * from elementcontractuelhistorique 
where contratParent=
(select id from contrathistorique where reference =
 "${preparation-validation#refContrat}");</con:query><con:assertion type="XPath Match" name="nb EC historique"><con:configuration><path>count(//Row)</path><content>1</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:testStep type="jdbc" name="politique migration"><con:settings/><con:config xsi:type="con:JdbcRequestTestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:driver>com.mysql.jdbc.Driver</con:driver><con:connectionString>jdbc:mysql://localhost:3306/topaze_test?user=test&amp;password=test</con:connectionString><con:query>select * from politiquemigration where id=(
select politiqueMigrationId from avenant
where referencecontrat="${preparation-validation#refContrat}");
</con:query><con:assertion type="XPath Match" name="remboursement"><con:configuration><path>//Row/POLITIQUEMIGRATION.REMBOURSEMENT/text()</path><content>1</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="reduction ancienne"><con:configuration><path>//Row/POLITIQUEMIGRATION.REDUCTIONANCIENNE/text()</path><content>1</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="penalite"><con:configuration><path>//Row/POLITIQUEMIGRATION.PENALITE/text()</path><content>1</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="frais resiliaton"><con:configuration><path>//Row/POLITIQUEMIGRATION.FRAISRESILIATION/text()</path><content>1</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="frais creation"><con:configuration><path>//Row/POLITIQUEMIGRATION.FRAISCREATION/text()</path><content>1</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:testStep type="delay" name="wait bon migration initiee"><con:settings/><con:config><delay>500</delay></con:config></con:testStep><con:testStep type="jdbc" name="bon migration initie"><con:settings/><con:config xsi:type="con:JdbcRequestTestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:driver>com.mysql.jdbc.Driver</con:driver><con:connectionString>jdbc:mysql://localhost:3306/topaze_test?user=test&amp;password=test</con:connectionString><con:query>select * from bonpreparation
where reference ="${preparation-validation#refContrat}"
and typeBonPreparation='MIGRATION'</con:query><con:assertion type="XPath Match" name="pas des EL"><con:configuration><path>count(//Row)</path><content>0</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:testStep type="goto" name="go to bon migration initiee"><con:settings/><con:config xsi:type="con:GotoStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:condition><con:name>bon initie</con:name><con:type>XPATH</con:type><con:expression>not(//Results/ResultSet/Row/BONPREPARATION.DATEINITIATION/text())</con:expression></con:condition></con:config></con:testStep><con:testStep type="jdbc" name="bon migration initiee"><con:settings/><con:config xsi:type="con:JdbcRequestTestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:driver>com.mysql.jdbc.Driver</con:driver><con:connectionString>jdbc:mysql://localhost:3306/topaze_test?user=test&amp;password=test</con:connectionString><con:query>select * from bonpreparation
where reference ="${preparation-validation#refContrat}"
and typeBonPreparation='MIGRATION'</con:query><con:assertion type="XPath Match" name="pas de bon migration"><con:configuration><path>count(//Row)</path><content>0</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:testStep type="jdbc" name="el migration initie"><con:settings/><con:config xsi:type="con:JdbcRequestTestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:driver>com.mysql.jdbc.Driver</con:driver><con:connectionString>jdbc:mysql://localhost:3306/topaze_test?user=test&amp;password=test</con:connectionString><con:query>select * from elementlivraison where 
bonPreparationparent =(select id from bonpreparation
where reference ="${preparation-validation#refContrat}"
and typeBonPreparation='MIGRATION');</con:query><con:assertion type="XPath Match" name="pas de el migration"><con:configuration><path>count(//Row)</path><content>0</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:testStep type="delay" name="wait end facture"><con:settings/><con:config><delay>1000</delay></con:config></con:testStep><con:testStep type="jdbc" name="facture"><con:settings/><con:config xsi:type="con:JdbcRequestTestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:driver>com.mysql.jdbc.Driver</con:driver><con:connectionString>jdbc:mysql://localhost:3306/topaze_test?user=test&amp;password=test</con:connectionString><con:query>select * from movement where productReferenceId="${preparation-validation#refContrat}";</con:query><con:properties/></con:config></con:testStep><con:testStep type="goto" name="go to facture"><con:settings/><con:config xsi:type="con:GotoStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:condition><con:name>facture</con:name><con:type>XPATH</con:type><con:expression>not(//ResultSet/Row[contains(MOVEMENT.PRODUCTID/text(), 'Remboursement')])
</con:expression><con:targetStep>wait end facture</con:targetStep></con:condition></con:config></con:testStep><con:testStep type="jdbc" name="facture valide"><con:settings/><con:config xsi:type="con:JdbcRequestTestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:driver>com.mysql.jdbc.Driver</con:driver><con:connectionString>jdbc:mysql://localhost:3306/topaze_test?user=test&amp;password=test</con:connectionString><con:query>select * from movement where productReferenceId="${preparation-validation#refContrat}";</con:query><con:assertion type="XPath Match" name="frais migration exists"><con:configuration><path>exists(//Row[contains(MOVEMENT.PRODUCTID/text(),'Frais/Migration')])</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="remboursement"><con:configuration><path>exists(//Row[contains(MOVEMENT.PRODUCTID/text(),'Remboursement')])</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="frais resilation"><con:configuration><path>exists(//Row[contains(MOVEMENT.PRODUCTID/text(),'Frais/Resiliation')])</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:properties/></con:testCase><con:properties/></con:testSuite><con:testSuite name="Resiliation"><con:settings/><con:runType>SEQUENTIAL</con:runType><con:testCase failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="resiliation contrat" searchProperties="true" id="27792f09-aab7-42d2-adf1-b7741fe96e70"><con:settings/><con:testStep type="calltestcase" name="preparation-validation"><con:settings/><con:config xsi:type="con:RunTestCaseStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:targetTestCase>6c56c18b-08b8-4072-a062-97a144660809</con:targetTestCase><con:properties><con:property><con:name>refContrat</con:name><con:value>301000000</con:value></con:property><con:property><con:name>refCommande</con:name><con:value>40702e64-b9f6-4d6a-a1b6-e9c3ea383d21</con:value></con:property></con:properties><con:returnProperties><con:entry>refContrat</con:entry><con:entry>refCommande</con:entry></con:returnProperties><con:runMode>PARALLELL</con:runMode></con:config></con:testStep><con:testStep type="restrequest" name="resilier"><con:settings/><con:config service="http://localhost:8081" methodName="Method 1" resourcePath="/contrat-core/contrat/{refContrat}/resilier" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="resilier" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://localhost:8081</con:endpoint><con:request>{
  "politiqueResiliation": {
    "fraisResiliation": "true",
    "remboursement": "true",
    "typeResiliation": "RIC",
    "delaiDeSecurite": false,
    "enCascade": "true",
    "montantRemboursement": "",
    "commentaire": "test",
    "motif": "IMPAYE",
    "penalite": "true",
    "montantResiliation": "",
    "commentaire": "this is a test"
  },
  "user": "testeur"
}
</con:request><con:originalUri>http://localhost/contrat-core/contrat/00003230/resilier</con:originalUri><con:assertion type="GroovyScriptAssertion" name="Script Assertion"><con:configuration><scriptText>assert messageExchange.hasResponse() == false</scriptText></con:configuration></con:assertion><con:assertion type="Valid HTTP Status Codes" name="Valid HTTP Status Codes"><con:configuration><codes>200</codes></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters><entry key="refContrat" value="${preparation-validation#refContrat}" xmlns="http://eviware.com/soapui/config"/></con:parameters></con:restRequest></con:config></con:testStep><con:testStep type="jdbc" name="politique resiliation"><con:settings/><con:config xsi:type="con:JdbcRequestTestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:driver>com.mysql.jdbc.Driver</con:driver><con:connectionString>jdbc:mysql://localhost:3306/topaze_test?user=test&amp;password=test</con:connectionString><con:query>select * from politiqueresiliation 
where id = 
 (select politiqueResiliationId 
    from contrat 
   where reference = "${preparation-validation#RefContrat}")</con:query><con:assertion type="XPath Match" name="frais resiliation"><con:configuration><path>//Row/POLITIQUERESILIATION.FRAISRESILIATION/text()</path><content>1</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="Motif"><con:configuration><path>//Row/POLITIQUERESILIATION.MOTIF/text()</path><content>IMPAYE</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:testStep type="jdbc" name="contrat resilie"><con:settings/><con:config xsi:type="con:JdbcRequestTestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:driver>com.mysql.jdbc.Driver</con:driver><con:connectionString>jdbc:mysql://localhost:3306/topaze_test?user=test&amp;password=test</con:connectionString><con:query>select * from contrat where 
reference ="${preparation-validation#refContrat}"</con:query><con:assertion type="Simple Contains" name="date fin contrat"><con:configuration><token>CONTRAT.DATEFINCONTRAT</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:assertion type="XPath Match" name="type resiliation"><con:configuration><path>//Row/CONTRAT.TYPERESILIATION/text()</path><content>RIC</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="Simple Contains" name="id politque resiliation"><con:configuration><token>CONTRAT.POLITIQUERESILIATIONID</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:testStep type="jdbc" name="EC resilies"><con:settings/><con:config xsi:type="con:JdbcRequestTestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:driver>com.mysql.jdbc.Driver</con:driver><con:connectionString>jdbc:mysql://localhost:3306/topaze_test?user=test&amp;password=test</con:connectionString><con:query>select * from elementcontractuel where contratParent=
(select id from contrat where 
reference ="${preparation-validation#refContrat}");</con:query><con:assertion type="Simple Contains" name="date fin contrat"><con:configuration><token>ELEMENTCONTRACTUEL.DATEFINCONTRAT</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:testStep type="delay" name="Wait for bon retour intite"><con:settings/><con:config><delay>500</delay></con:config></con:testStep><con:testStep type="jdbc" name="bon de retour - Initie"><con:settings/><con:config xsi:type="con:JdbcRequestTestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:driver>com.mysql.jdbc.Driver</con:driver><con:connectionString>jdbc:mysql://localhost:3306/topaze_test?user=test&amp;password=test</con:connectionString><con:query>select * 
from bonpreparation 
where reference = "${preparation-validation#RefContrat}"
  and typebonpreparation = "retour"</con:query><con:properties/></con:config></con:testStep><con:testStep type="goto" name="go to retour initie"><con:settings/><con:config xsi:type="con:GotoStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:condition><con:name>retour</con:name><con:type>XPATH</con:type><con:expression>not(//Results/ResultSet/Row/BONPREPARATION.DATEINITIATION/text())</con:expression><con:targetStep>Wait for bon retour intite</con:targetStep></con:condition></con:config></con:testStep><con:testStep type="jdbc" name="El de retour initie"><con:settings/><con:config xsi:type="con:JdbcRequestTestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:driver>com.mysql.jdbc.Driver</con:driver><con:connectionString>jdbc:mysql://localhost:3306/topaze_test?user=test&amp;password=test</con:connectionString><con:query>select * from elementlivraison 
where bonPreparationParent = 
(select id
from bonpreparation 
where reference = "${preparation-validation#RefContrat}"
  and typebonpreparation = "retour")</con:query><con:assertion type="XPath Match" name="addresse livraison"><con:configuration><path>//*:ELEMENTLIVRAISON.ADDRESSELIVRAISON/text()</path><content>idr</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="acteur "><con:configuration><path>//Row/ELEMENTLIVRAISON.ACTEUR/text()</path><content>PACKAGER</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="date initiation"><con:configuration><path>exists(//*:ELEMENTLIVRAISON.DATEINITIATION/text())</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:testStep type="jdbc" name="bon de retour-initie"><con:settings/><con:config xsi:type="con:JdbcRequestTestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:driver>com.mysql.jdbc.Driver</con:driver><con:connectionString>jdbc:mysql://localhost:3306/topaze_test?user=test&amp;password=test</con:connectionString><con:query>select * 
from bonpreparation 
where reference = "${preparation-validation#RefContrat}"
  and typebonpreparation = "retour"</con:query><con:assertion type="XPath Match" name="type bon retour"><con:configuration><path>//*:BONPREPARATION.TYPEBONPREPARATION/text()</path><content>RETOUR</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="reference"><con:configuration><path>//*:BONPREPARATION.REFERENCE/text()</path><content>${preparation-validation#refContrat}</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="id client"><con:configuration><path>//*:BONPREPARATION.IDCLIENT/text()</path><content>00003870</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:testStep type="delay" name="wait bon retour prepare"><con:settings/><con:config><delay>500</delay></con:config></con:testStep><con:testStep type="jdbc" name="bon deretour-prepare"><con:settings/><con:config xsi:type="con:JdbcRequestTestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:driver>com.mysql.jdbc.Driver</con:driver><con:connectionString>jdbc:mysql://localhost:3306/topaze_test?user=test&amp;password=test</con:connectionString><con:query>select * 
from bonpreparation 
where reference = "${preparation-validation#RefContrat}"
  and typebonpreparation = "retour";</con:query><con:assertion type="XPath Match" name="type bon preparation"><con:configuration><path>//*:BONPREPARATION.TYPEBONPREPARATION/text()</path><content>RETOUR</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="id client"><con:configuration><path>//*:BONPREPARATION.IDCLIENT/text()</path><content>00003870</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:testStep type="goto" name="go to bon retour prepare"><con:settings/><con:config xsi:type="con:GotoStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:condition><con:name>bon retour prepare</con:name><con:type>XPATH</con:type><con:expression>not(//Results/ResultSet/Row/BONPREPARATION.DATEPREPARATION/text())</con:expression><con:targetStep>wait bon retour prepare</con:targetStep></con:condition></con:config></con:testStep><con:testStep type="jdbc" name="EL de retour -prepare"><con:settings/><con:config xsi:type="con:JdbcRequestTestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:driver>com.mysql.jdbc.Driver</con:driver><con:connectionString>jdbc:mysql://localhost:3306/topaze_test?user=test&amp;password=test</con:connectionString><con:query>select * from elementlivraison 
where bonPreparationParent = 
(select id
from bonpreparation 
where reference = "${preparation-validation#RefContrat}"
  and typebonpreparation = "retour")</con:query><con:assertion type="XPath Match" name="date preparation"><con:configuration><path>exists(//*:ELEMENTLIVRAISON.DATEPREPARATION/text())</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="date initiation"><con:configuration><path>exists(//*:ELEMENTLIVRAISON.DATEINITIATION/text())</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="reference code produit"><con:configuration><path>//*:ELEMENTLIVRAISON.REFERENCEPRODUIT/text()</path><content>avfwpro-confort-s</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="abonnement"><con:configuration><path>//*:ELEMENTLIVRAISON.TYPECONTRAT/text()</path><content>ABONNEMENT</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="resiliation partielle"><con:configuration><path>//*:ELEMENTLIVRAISON.RESILIATIONPARTIEL/text()</path><content>0</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:testStep type="delay" name="wait bon retour termine"><con:settings/><con:config><delay>500</delay></con:config></con:testStep><con:testStep type="jdbc" name="bon retour termine"><con:settings/><con:config xsi:type="con:JdbcRequestTestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:driver>com.mysql.jdbc.Driver</con:driver><con:connectionString>jdbc:mysql://localhost:3306/topaze_test?user=test&amp;password=test</con:connectionString><con:query>select * 
from bonpreparation 
where reference = "${preparation-validation#RefContrat}"
  and typebonpreparation = "retour"</con:query><con:assertion type="XPath Match" name="type bon retour"><con:configuration><path>//*:BONPREPARATION.TYPEBONPREPARATION/text()</path><content>RETOUR</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="id client"><con:configuration><path>//*:BONPREPARATION.IDCLIENT/text()</path><content>00003870</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="reference"><con:configuration><path>//*:BONPREPARATION.REFERENCE/text()</path><content>${preparation-validation#refContrat}</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:testStep type="goto" name="go to bon retour termine"><con:settings/><con:config xsi:type="con:GotoStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:condition><con:name>bon retour termine</con:name><con:type>XPATH</con:type><con:expression>not(//Results/ResultSet/Row/BONPREPARATION.DATERETOURTERMINE/text())</con:expression><con:targetStep>wait bon retour termine</con:targetStep></con:condition></con:config></con:testStep><con:testStep type="jdbc" name="EL Retour-termine"><con:settings/><con:config xsi:type="con:JdbcRequestTestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:driver>com.mysql.jdbc.Driver</con:driver><con:connectionString>jdbc:mysql://localhost:3306/topaze_test?user=test&amp;password=test</con:connectionString><con:query>select * from elementlivraison 
where bonPreparationParent = 
(select id
from bonpreparation 
where reference = "${preparation-validation#RefContrat}"
  and typebonpreparation = "retour")</con:query><con:assertion type="XPath Match" name="date retour termine exists"><con:configuration><path>exists(//*:ELEMENTLIVRAISON.DATERETOURTERMINE/text())</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="reference produit"><con:configuration><path>//*:ELEMENTLIVRAISON.REFERENCEPRODUIT/text()</path><content>avfwpro-confort-s</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="type contrat"><con:configuration><path>//*:ELEMENTLIVRAISON.TYPECONTRAT/text()</path><content>ABONNEMENT</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="un seul retailer packager"><con:configuration><path>count(//Row[ELEMENTLIVRAISON.TYPECONTRAT="ABONNEMENT"]/ELEMENTLIVRAISON.RETAILERPACKAGERID/text())</path><content>1</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="pas de bien"><con:configuration><path>count(//Row[ELEMENTLIVRAISON.TYPECONTRAT="LOCATION"]/ELEMENTLIVRAISON.CODECOLIS/text())</path><content>0</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="addresse livraison"><con:configuration><path>//*:ELEMENTLIVRAISON.ADDRESSELIVRAISON/text()</path><content>idr</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:testStep type="delay" name="wait end facture"><con:settings/><con:config><delay>1000</delay></con:config></con:testStep><con:testStep type="jdbc" name="facture exists"><con:settings/><con:config xsi:type="con:JdbcRequestTestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:driver>com.mysql.jdbc.Driver</con:driver><con:connectionString>jdbc:mysql://localhost:3306/topaze_test?user=test&amp;password=test</con:connectionString><con:query>select * from movement where productReferenceId="${preparation-validation#refContrat}";</con:query><con:assertion type="XPath Match" name="nb mouvement" disabled="true"><con:configuration><path>count(//Row)</path><content>4</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="frais resiliation" disabled="true"><con:configuration><path>exists(//Row[contains(MOVEMENT.PRODUCTID/text(),'Frais/Resiliation')])</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="remboursement exists" disabled="true"><con:configuration><path>exists(//Row[contains(MOVEMENT.PRODUCTID/text(),'Remboursement')])</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:testStep type="goto" name="go to facture"><con:settings/><con:config xsi:type="con:GotoStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:condition><con:name>facture</con:name><con:type>XPATH</con:type><con:expression>not(//ResultSet/Row[contains(MOVEMENT.PRODUCTID/text(), 'Frais/Resiliation')])</con:expression><con:targetStep>wait end facture</con:targetStep></con:condition></con:config></con:testStep><con:testStep type="jdbc" name="facture valide"><con:settings/><con:config xsi:type="con:JdbcRequestTestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:driver>com.mysql.jdbc.Driver</con:driver><con:connectionString>jdbc:mysql://localhost:3306/topaze_test?user=test&amp;password=test</con:connectionString><con:query>select * from movement where productReferenceId="${preparation-validation#refContrat}";</con:query><con:assertion type="XQuery Match" name="refrence contrat"><con:configuration><path>&lt;Results> 
{ 
  for $x in //Row 
  return &lt;Result>{$x/MOVEMENT.PRODUCTREFERENCEID/text()}&lt;/Result> 
} 
&lt;/Results></path><content><![CDATA[<Results>
<Result> ${preparation-validation#refContrat}  </Result>
<Result> ${preparation-validation#refContrat}  </Result>
<Result> ${preparation-validation#refContrat}  </Result>
<Result> ${preparation-validation#refContrat}  </Result>


</Results>]]></content><allowWildcards>false</allowWildcards></con:configuration></con:assertion><con:assertion type="XQuery Match" name="frais resiliation"><con:configuration><path><![CDATA[<Results>
{
for $x in //Row[contains(MOVEMENT.PRODUCTID/text(), 'Frais/Resiliation')]
return <result>
<amount>{$x/MOVEMENT.AMOUNT/text()}</amount>
<referenceContrat>{$x/MOVEMENT.PRODUCTREFERENCEID/text()}</referenceContrat>
<numeroCommande>{$x/MOVEMENT.BILLINGGROUP/text()}</numeroCommande>
<productId>{$x/MOVEMENT.PRODUCTID/text()}</productId>
</result>
}
</Results>]]></path><content><![CDATA[<Results>
<result>

<amount> 30</amount>
<referenceContrat> ${preparation-validation#RefContrat}</referenceContrat>
<numeroCommande>${preparation-validation#refCommande}</numeroCommande>
<productId>Securite/securitoo/avfwpro-confort-s/Frais/Resiliation</productId>
</result>
</Results>]]></content><allowWildcards>false</allowWildcards></con:configuration></con:assertion><con:assertion type="XQuery Match" name="remboursement"><con:configuration><path><![CDATA[<Results>
{
for $x in //Row[contains(MOVEMENT.PRODUCTID/text(), '/Remboursement')]
return <result>
<amount>{$x/MOVEMENT.AMOUNT/text()}</amount>
<referenceContrat>{$x/MOVEMENT.PRODUCTREFERENCEID/text()}</referenceContrat>
<numeroCommande>{$x/MOVEMENT.BILLINGGROUP/text()}</numeroCommande>
<productId>{$x/MOVEMENT.PRODUCTID/text()}</productId>
</result>
}
</Results>]]></path><content><![CDATA[<Results>
<result>

<amount> 5</amount>
<referenceContrat> ${preparation-validation#RefContrat}</referenceContrat>
<numeroCommande>null </numeroCommande>
<productId>Securite/securitoo/avfwpro-confort-s/Remboursement</productId>
</result>
</Results>]]></content><allowWildcards>false</allowWildcards></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:properties><con:property><con:name>NbPasses</con:name><con:value>60</con:value></con:property></con:properties></con:testCase><con:properties/></con:testSuite><con:testSuite name="Renouvellement"><con:settings/><con:runType>SEQUENTIAL</con:runType><con:testCase failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="renouvellement contrat" searchProperties="true" id="c6977a99-f00c-4fd0-9eab-f1e9520c7330"><con:settings/><con:testStep type="groovy" name="create ref commande"><con:settings/><con:config><script>import static java.util.UUID.randomUUID 
def tc = context.testCase 
uuid = randomUUID().toString()
testRunner.testCase.setPropertyValue( "RefCommande", uuid ) 
log.info testRunner.testCase.getPropertyValue("RefCommande")</script></con:config></con:testStep><con:testStep type="properties" name="RenouvellementInfo"><con:settings/><con:config xsi:type="con:PropertiesStep" saveFirst="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:properties><con:property><con:name>PolitiqueValidationId</con:name><con:value>6</con:value></con:property><con:property><con:name>duree</con:name><con:value>10</con:value></con:property><con:property><con:name>montant</con:name><con:value>5</con:value></con:property><con:property><con:name>periodicite</con:name><con:value>1</con:value></con:property><con:property><con:name>modeFacturation</con:name><con:value>DATE_ANNIVERSAIRE</con:value></con:property><con:property><con:name>referenceModePaiement</con:name><con:value>R0000012</con:value></con:property><con:property><con:name>idClient</con:name><con:value>00003870</con:value></con:property><con:property><con:name>numEC</con:name><con:value>1</con:value></con:property><con:property><con:name>referenceProduit</con:name><con:value>avfwpro-confort-s</con:value></con:property></con:properties></con:config></con:testStep><con:testStep type="calltestcase" name="resiliation"><con:settings/><con:config xsi:type="con:RunTestCaseStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:targetTestCase>82a3926c-67ae-4136-87ba-1c522c84a422</con:targetTestCase><con:properties><con:property><con:name>refContrat</con:name><con:value>068000000</con:value></con:property></con:properties><con:returnProperties><con:entry>refContrat</con:entry></con:returnProperties><con:runMode>PARALLELL</con:runMode></con:config></con:testStep><con:testStep type="jdbc" name="contrat ancient"><con:settings/><con:config xsi:type="con:JdbcRequestTestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:driver>com.mysql.jdbc.Driver</con:driver><con:connectionString>jdbc:mysql://localhost:3306/topaze_test?user=test&amp;password=test</con:connectionString><con:query>select * from contrat where
reference="${resiliation#refContrat}"</con:query><con:properties/></con:config></con:testStep><con:testStep type="jdbc" name="EC ancients"><con:settings/><con:config xsi:type="con:JdbcRequestTestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:driver>com.mysql.jdbc.Driver</con:driver><con:connectionString>jdbc:mysql://localhost:3306/topaze_test?user=test&amp;password=test</con:connectionString><con:query>select * from elementcontractuel where contratParent=
(select id from contrat where 
reference="${resiliation#refContrat}");</con:query><con:properties/></con:config></con:testStep><con:testStep type="transfer" name="move info contat ancient"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" useXQuery="false" entitize="false" transferChildNodes="false"><con:name>PolitiqueValidationId</con:name><con:sourceType>ResponseAsXml</con:sourceType><con:sourceStep>contrat ancient</con:sourceStep><con:sourcePath>//*:CONTRAT.POLITIQUEVALIDATIONID</con:sourcePath><con:targetType>PolitiqueValidationId</con:targetType><con:targetStep>RenouvellementInfo</con:targetStep></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" entitize="false" transferToAll="false"><con:name>duree</con:name><con:sourceType>ResponseAsXml</con:sourceType><con:sourceStep>EC ancients</con:sourceStep><con:sourcePath>//*:ELEMENTCONTRACTUEL.DUREE</con:sourcePath><con:targetType>duree</con:targetType><con:targetStep>RenouvellementInfo</con:targetStep></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" transferToAll="false" entitize="false" ignoreEmpty="false" useXQuery="false" transferChildNodes="false"><con:name>montant</con:name><con:sourceType>ResponseAsXml</con:sourceType><con:sourceStep>EC ancients</con:sourceStep><con:sourcePath>//*:ELEMENTCONTRACTUEL.MONTANT</con:sourcePath><con:targetType>montant</con:targetType><con:targetStep>RenouvellementInfo</con:targetStep></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" entitize="false" transferToAll="false" ignoreEmpty="false" useXQuery="false" transferChildNodes="false"><con:name>perodicite</con:name><con:sourceType>ResponseAsXml</con:sourceType><con:sourceStep>EC ancients</con:sourceStep><con:sourcePath>//*:ELEMENTCONTRACTUEL.PERIODICITE</con:sourcePath><con:targetType>periodicite</con:targetType><con:targetStep>RenouvellementInfo</con:targetStep></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" transferToAll="false"><con:name>modeFacturation</con:name><con:sourceType>ResponseAsXml</con:sourceType><con:sourceStep>EC ancients</con:sourceStep><con:sourcePath>//*:ELEMENTCONTRACTUEL.MODEFACTURATION</con:sourcePath><con:targetType>modeFacturation</con:targetType><con:targetStep>RenouvellementInfo</con:targetStep></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" useXQuery="false" entitize="false" transferChildNodes="false"><con:name>referenceModePaiement</con:name><con:sourceType>ResponseAsXml</con:sourceType><con:sourceStep>EC ancients</con:sourceStep><con:sourcePath>//*:ELEMENTCONTRACTUEL.REFERENCEMODEPAIEMENT</con:sourcePath><con:targetType>referenceModePaiement</con:targetType><con:targetStep>RenouvellementInfo</con:targetStep></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true"><con:name>idClient</con:name><con:sourceType>ResponseAsXml</con:sourceType><con:sourceStep>contrat ancient</con:sourceStep><con:sourcePath>//*:CONTRAT.IDCLIENT</con:sourcePath><con:targetType>idClient</con:targetType><con:targetStep>RenouvellementInfo</con:targetStep></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true"><con:name>numEC</con:name><con:sourceType>ResponseAsXml</con:sourceType><con:sourceStep>EC ancients</con:sourceStep><con:sourcePath>//*:ELEMENTCONTRACTUEL.NUMEC</con:sourcePath><con:targetType>numEC</con:targetType><con:targetStep>RenouvellementInfo</con:targetStep></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" transferToAll="false"><con:name>refrenceProduit</con:name><con:sourceType>ResponseAsXml</con:sourceType><con:sourceStep>EC ancients</con:sourceStep><con:sourcePath>//*:ELEMENTCONTRACTUEL.REFERENCEPRODUIT</con:sourcePath><con:targetType>referenceProduit</con:targetType><con:targetStep>RenouvellementInfo</con:targetStep></con:transfers></con:config></con:testStep><con:testStep type="restrequest" name="renouvellement"><con:settings/><con:config service="http://localhost:8081" methodName="Method 1" resourcePath="/contrat-core/contrat/{refContrat}/renouveler" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="renouvellement" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://localhost:8081</con:endpoint><con:request>{
  "politiqueRenouvellement": {
    "conserverAncienneReduction": "true",
    "force": "false"
  },
  "user": "ag-renouv",
  "produitRenouvellements": [
    {
      "remboursable": "true",
      "typeProduit": "SERVICE",
      "prix": {
        "periodicite": "2",
        "montant": "20",
        "referenceModePaiement": "R1234567",
        "modeFacturation": "DATE_ANNIVERSAIRE",
        "duree": "8",
        "frais": [
          {
            "montant": "12",
            "typeFrais": "creation"
          },
          {
            "montant": "13",
            "typeFrais": "resiliation"
          }
        ],
        "typeTVA": "SR",
        "modePaiement": "CB"
      },
      "referenceProduit": "avfwpro-confort-s",
      "numeroCommande": "${#TestCase#RefCommande}",
      "label": "avfwpro-confort-s",
      "numEC": "1",
      "numECParent": ""
    }
  ]
}
</con:request><con:originalUri>http://localhost/contrat-core/contrat/00003311/renouveler</con:originalUri><con:assertion type="GroovyScriptAssertion" name="Script Assertion"><con:configuration><scriptText>assert messageExchange.hasResponse() == false</scriptText></con:configuration></con:assertion><con:assertion type="Valid HTTP Status Codes" name="Valid HTTP Status Codes"><con:configuration><codes>200</codes></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters><entry key="refContrat" value="${resiliation#refContrat}" xmlns="http://eviware.com/soapui/config"/></con:parameters></con:restRequest></con:config></con:testStep><con:testStep type="jdbc" name="politique renouvellement"><con:settings/><con:config xsi:type="con:JdbcRequestTestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:driver>com.mysql.jdbc.Driver</con:driver><con:connectionString>jdbc:mysql://localhost:3306/topaze_test?user=test&amp;password=test</con:connectionString><con:query>select * from politiquerenouvellement where id=(
select politiqueRenouvellementId from avenant
where referencecontrat
="${resiliation#refContrat}");
</con:query><con:assertion type="XPath Match" name="reduction ancienne"><con:configuration><path>//Row/POLITIQUERENOUVELLEMENT.CONSERVERANCIENNEREDUCTION/text()</path><content>1</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="force renouvellement"><con:configuration><path>//Row/POLITIQUERENOUVELLEMENT.FORCERENOUVELLEMENT/text()</path><content>0</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:testStep type="jdbc" name="avenant"><con:settings/><con:config xsi:type="con:JdbcRequestTestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:driver>com.mysql.jdbc.Driver</con:driver><con:connectionString>jdbc:mysql://localhost:3306/topaze_test?user=test&amp;password=test</con:connectionString><con:query>select * from  avenant
where referencecontrat
="${resiliation#refContrat}";
</con:query><con:assertion type="XPath Match" name="type renouvellement"><con:configuration><path>//Row/AVENANT.TYPEAVENANT/text()</path><content>RENOUVELLEMENT</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="politique renouvellement exist"><con:configuration><path>exists(//Row/AVENANT.POLITIQUERENOUVELLEMENTID/text())</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="reference contrat"><con:configuration><path>//Row/AVENANT.REFERENCECONTRAT/text()</path><content>${resiliation#refContrat}</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:testStep type="jdbc" name="modifications"><con:settings/><con:config xsi:type="con:JdbcRequestTestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:driver>com.mysql.jdbc.Driver</con:driver><con:connectionString>jdbc:mysql://localhost:3306/topaze_test?user=test&amp;password=test</con:connectionString><con:query>select * from modification where avenantId=(
select id from  avenant
where referencecontrat="${resiliation#refContrat}"
);</con:query><con:assertion type="XPath Match" name="trame json existe"><con:configuration><path>exists(//Row/MODIFICATION.TRAMEJSON/text())</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="num EC"><con:configuration><path>exists(//Row/MODIFICATION.NUMEC/text())</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:testStep type="jdbc" name="contrat renouvele"><con:settings/><con:config xsi:type="con:JdbcRequestTestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:driver>com.mysql.jdbc.Driver</con:driver><con:connectionString>jdbc:mysql://localhost:3306/topaze_test?user=test&amp;password=test</con:connectionString><con:query>select * from contrat where
reference="${resiliation#refContrat}"</con:query><con:assertion type="XPath Match" name="pas de resiliation"><con:configuration><path>exists(//ResultSet/Row/CONTRAT.POLITIQUERESILIATIONID/text())</path><content>false</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="meme id client"><con:configuration><path>//*:CONTRAT.IDCLIENT/text()</path><content>${RenouvellementInfo#idClient}</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="politique validation different"><con:configuration><path>//*:CONTRAT.POLITIQUEVALIDATIONID/text()!=${RenouvellementInfo#PolitiqueValidationId}</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="meme reference"><con:configuration><path>//*:CONTRAT.REFERENCE/text()</path><content>${resiliation#refContrat}</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:testStep type="jdbc" name="EC renouvele"><con:settings/><con:config xsi:type="con:JdbcRequestTestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:driver>com.mysql.jdbc.Driver</con:driver><con:connectionString>jdbc:mysql://localhost:3306/topaze_test?user=test&amp;password=test</con:connectionString><con:query>select * from elementcontractuel where contratParent=
(select id from contrat where 
reference="${resiliation#refContrat}");</con:query><con:assertion type="XPath Match" name="date preparation et date validation exists"><con:configuration><path>exists(//*:ELEMENTCONTRACTUEL.DATEPREPARATION/text())
and
exists(//*:ELEMENTCONTRACTUEL.DATEVALIDATION/text())</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="duree different"><con:configuration><path>//*:ELEMENTCONTRACTUEL.DUREE/text()!=${RenouvellementInfo#duree}</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="montant different"><con:configuration><path>//*:ELEMENTCONTRACTUEL.MONTANT/text()!=${RenouvellementInfo#montant}</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="periodicite differente"><con:configuration><path>//*:ELEMENTCONTRACTUEL.PERIODICITE/text()!=${RenouvellementInfo#periodicite}</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="meme mode facturation"><con:configuration><path>//*:ELEMENTCONTRACTUEL.MODEFACTURATION</path><content>${RenouvellementInfo#modeFacturation}</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="meme reference produit"><con:configuration><path>//*:ELEMENTCONTRACTUEL.REFERENCEPRODUIT/text()</path><content>${RenouvellementInfo#referenceProduit}</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="meme numEC"><con:configuration><path>//*:ELEMENTCONTRACTUEL.NUMEC/text()</path><content>${RenouvellementInfo#numEC}</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:testStep type="delay" name="wait bon renouvellement initie"><con:settings/><con:config><delay>500</delay></con:config></con:testStep><con:testStep type="jdbc" name="bon renouvellement -initie"><con:settings/><con:config xsi:type="con:JdbcRequestTestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:driver>com.mysql.jdbc.Driver</con:driver><con:connectionString>jdbc:mysql://localhost:3306/topaze_test?user=test&amp;password=test</con:connectionString><con:query>select * from bonpreparation where reference=
"${resiliation#refContrat}" and typeBonPreparation
="RENOUVELLEMENT"</con:query><con:properties/></con:config></con:testStep><con:testStep type="goto" name="go bon renouvellement initie"><con:settings/><con:config xsi:type="con:GotoStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:condition><con:name>bon renouvellement initie</con:name><con:type>XPATH</con:type><con:expression>not(//Results/ResultSet/Row/BONPREPARATION.DATEINITIATION/text())</con:expression><con:targetStep>wait bon renouvellement initie</con:targetStep></con:condition></con:config></con:testStep><con:testStep type="jdbc" name="bon renouvellement initie"><con:settings/><con:config xsi:type="con:JdbcRequestTestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:driver>com.mysql.jdbc.Driver</con:driver><con:connectionString>jdbc:mysql://localhost:3306/topaze_test?user=test&amp;password=test</con:connectionString><con:query>select * from bonpreparation where reference=
"${resiliation#refContrat}" and typeBonPreparation
="RENOUVELLEMENT"</con:query><con:assertion type="XPath Match" name="type bon renouvellement"><con:configuration><path>//*:BONPREPARATION.TYPEBONPREPARATION/text()</path><content>RENOUVELLEMENT</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="reference"><con:configuration><path>//*:BONPREPARATION.REFERENCE/text()</path><content>${resiliation#refContrat}</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="id client"><con:configuration><path>//*:BONPREPARATION.IDCLIENT/text()</path><content>${RenouvellementInfo#idClient}</content><allowWildcards>true</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:testStep type="jdbc" name="EL de renouvellement initie"><con:settings/><con:config xsi:type="con:JdbcRequestTestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:driver>com.mysql.jdbc.Driver</con:driver><con:connectionString>jdbc:mysql://localhost:3306/topaze_test?user=test&amp;password=test</con:connectionString><con:query>select * from elementlivraison where bonPreparationparent=
(select id from bonpreparation where reference=
"${resiliation#refContrat}" and typeBonPreparation
="RENOUVELLEMENT");</con:query><con:assertion type="XPath Match" name="acteur packager"><con:configuration><path>//ResultSet/Row/ELEMENTLIVRAISON.ACTEUR/text()</path><content>PACKAGER</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="type renouvellement"><con:configuration><path>//ResultSet/Row/ELEMENTLIVRAISON.TYPEBONPREPARATION/text()</path><content>RENOUVELLEMENT</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="refrence"><con:configuration><path>//*:ELEMENTLIVRAISON.REFERENCE/text()</path><content>${resiliation#refContrat}-${RenouvellementInfo#numEC}</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="meme refrence produit"><con:configuration><path>//*:ELEMENTLIVRAISON.REFERENCEPRODUIT/text()</path><content>${RenouvellementInfo#referenceProduit}</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="date initiation exists"><con:configuration><path>exists(//*:ELEMENTLIVRAISON.DATEINITIATION/text())</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:testStep type="delay" name="wait end renouvellement"><con:settings/><con:config><delay>500</delay></con:config></con:testStep><con:testStep type="jdbc" name="bon renouvellement - termine"><con:settings/><con:config xsi:type="con:JdbcRequestTestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:driver>com.mysql.jdbc.Driver</con:driver><con:connectionString>jdbc:mysql://localhost:3306/topaze_test?user=test&amp;password=test</con:connectionString><con:query>select * from bonpreparation where reference=
"${resiliation#refContrat}" and typeBonPreparation
="RENOUVELLEMENT"</con:query><con:assertion type="XPath Match" name="type bon"><con:configuration><path>//ResultSet/Row/BONPREPARATION.TYPEBONPREPARATION/text()</path><content>RENOUVELLEMENT</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="reference "><con:configuration><path>//*:BONPREPARATION.REFERENCE/text()</path><content>${resiliation#refContrat}</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="date initiation"><con:configuration><path>exists(//*:BONPREPARATION.DATEINITIATION/text())</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="id client"><con:configuration><path>exists(//*:BONPREPARATION.IDCLIENT/text())</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:testStep type="goto" name="go to renouvellement termine"><con:settings/><con:config xsi:type="con:GotoStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:condition><con:name>renouvellement</con:name><con:type>XPATH</con:type><con:expression>not(//Results/ResultSet/Row/BONPREPARATION.DATELIVRAISONTERMINE/text())</con:expression><con:targetStep>wait end renouvellement</con:targetStep></con:condition></con:config></con:testStep><con:testStep type="delay" name="wait end facture"><con:settings/><con:config><delay>1000</delay></con:config></con:testStep><con:testStep type="jdbc" name="facture exists"><con:settings/><con:config xsi:type="con:JdbcRequestTestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:driver>com.mysql.jdbc.Driver</con:driver><con:connectionString>jdbc:mysql://localhost:3306/topaze_test?user=test&amp;password=test</con:connectionString><con:query>select * from movement where billingGroup="${#TestCase#RefCommande}";</con:query><con:assertion type="XPath Match" name="pas de frais resiliation"><con:configuration><path>exists(//Row[contains(MOVEMENT.PRODUCTID/text(),'Frais/Resiliation')])</path><content>false</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="pas de remboursement"><con:configuration><path>exists(//Row[contains(MOVEMENT.PRODUCTID/text(),'Remboursement')])</path><content>false</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:testStep type="goto" name="go to end facture"><con:settings/><con:config xsi:type="con:GotoStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:condition><con:name>end facture</con:name><con:type>XPATH</con:type><con:expression>not(//Results/ResultSet/Row/MOVEMENT.ID/text())</con:expression><con:targetStep>wait end facture</con:targetStep></con:condition></con:config></con:testStep><con:testStep type="jdbc" name="facture valide"><con:settings/><con:config xsi:type="con:JdbcRequestTestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:driver>com.mysql.jdbc.Driver</con:driver><con:connectionString>jdbc:mysql://localhost:3306/topaze_test?user=test&amp;password=test</con:connectionString><con:query>select * from movement where billingGroup="${#TestCase#RefCommande}";</con:query><con:assertion type="XPath Match" name="pas frais de resiliation"><con:configuration><path>exists(//Row[contains(MOVEMENT.PRODUCTID/text(),'Frais/Resiliation')])</path><content>false</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="pas de remboursement"><con:configuration><path>exists(//Row[contains(MOVEMENT.PRODUCTID/text(),'Remboursement')])</path><content>false</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="pas de frais  de creation"><con:configuration><path>exists(//Row[contains(MOVEMENT.PRODUCTID/text(),'Frais/Creation')])</path><content>false</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XQuery Match" name="movement recurrent"><con:configuration><path><![CDATA[<Results>
{
for $x in //Row
return <result>
<amount>{$x/MOVEMENT.AMOUNT/text()}</amount>
<referenceContrat>{$x/MOVEMENT.PRODUCTREFERENCEID/text()}</referenceContrat>
<numeroCommande>{$x/MOVEMENT.BILLINGGROUP/text()}</numeroCommande>
<productId>{$x/MOVEMENT.PRODUCTID/text()}</productId>
</result>
}
</Results>]]></path><content><![CDATA[<Results>
<result>

<amount>20</amount>
<referenceContrat>${resiliation#refContrat}</referenceContrat>
<numeroCommande>${#TestCase#RefCommande}</numeroCommande>
<productId>Securite/securitoo/avfwpro-confort-s</productId>
</result>
</Results>]]></content><allowWildcards>false</allowWildcards></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:properties><con:property><con:name>RefCommande</con:name><con:value>2e9246f7-9916-4b7f-8e29-7c8b4917a4cb</con:value></con:property></con:properties></con:testCase><con:properties/></con:testSuite><con:testSuite name="Reduction"><con:settings/><con:runType>SEQUENTIAL</con:runType><con:testCase failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="tarif récurrent uniquement" searchProperties="true" id="a7be3f47-0ab8-4d84-aecc-94d90289e105"><con:settings/><con:testStep type="properties" name="contratPropertie"><con:settings/><con:config xsi:type="con:PropertiesStep" saveFirst="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:properties><con:property><con:name>refContrat</con:name><con:value>003000010</con:value></con:property></con:properties></con:config></con:testStep><con:testStep type="restrequest" name="preparerContrat"><con:settings/><con:config service="http://localhost:8081" methodName="Method 1" resourcePath="/contrat-core/contrat/preparer" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="preparerContrat" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://localhost:8081</con:endpoint><con:request>{
  "user": "test",
  "produits": [
    {
"reference": "avfwpro-confort-s",
      "numEC": "1",
"numeroCommande": "12345678",
      "label": "Abonnement Antivirus Securitoo",
      "remboursable": "true",
      "typeProduit": "SERVICE",
      "prix": {
        "duree": "12",
        "periodicite": "1",
        "typeTVA": "R",
        "montant": "5",
        "modePaiement": "VIREMENT",
        "modeFacturation": "DATE_ANNIVERSAIRE"
      }
    }
  ]
}
</con:request><con:originalUri>http://localhost/contrat-core/contrat/preparer</con:originalUri><con:assertion type="XPath Match" name="reference contrat exists"><con:configuration><path>exists(//*:referenceContrat)</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="Valid HTTP Status Codes" name="Valid HTTP Status Codes"><con:configuration><codes>200</codes></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:restRequest></con:config></con:testStep><con:testStep type="transfer" name="move ref contrat"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" useXQuery="false" entitize="false" transferChildNodes="false"><con:name>refContrat</con:name><con:sourceType>ResponseAsXml</con:sourceType><con:sourceStep>preparerContrat</con:sourceStep><con:sourcePath>//*:referenceContrat</con:sourcePath><con:targetType>refContrat</con:targetType><con:targetStep>contratPropertie</con:targetStep></con:transfers></con:config></con:testStep><con:testStep type="jdbc" name="contrat prepare"><con:settings/><con:config xsi:type="con:JdbcRequestTestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:driver>com.mysql.jdbc.Driver</con:driver><con:connectionString>jdbc:mysql://localhost:3306/topaze_test?user=test&amp;password=test</con:connectionString><con:query>select * from contrat where reference=
"${contratPropertie#refContrat}";</con:query><con:assertion type="XPath Match" name="date preapration exists"><con:configuration><path>exists(//*:CONTRAT.DATEPREPARATION/text())</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:testStep type="jdbc" name="EC prepares"><con:settings/><con:config xsi:type="con:JdbcRequestTestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:driver>com.mysql.jdbc.Driver</con:driver><con:connectionString>jdbc:mysql://localhost:3306/topaze_test?user=test&amp;password=test</con:connectionString><con:query>select * from elementcontractuel where contratParent
=(select id from contrat where reference =
"${contratPropertie#refContrat}");</con:query><con:assertion type="XPath Match" name="datepreparation"><con:configuration><path>exists(//*:ELEMENTCONTRACTUEL.DATEPREPARATION/text())</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="modeFacturation"><con:configuration><path>exists(//*:ELEMENTCONTRACTUEL.MODEFACTURATION/text())</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:testStep type="restrequest" name="ajouter reduction"><con:settings/><con:config service="http://localhost:8081" methodName="Method 1" resourcePath="/contrat-core/contrat/{refContrat}/reduction/ajouter" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="ajouter reduction" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://localhost:8081</con:endpoint><con:request>{
  "reduction": {
    "valeur": "20",
    "isAffichableSurFacture": "false",
    "dateFin": "",
    "nbUtilisationMax": "1",
    "titre": "red-global-test",
    "dateDebut": "",
    "typeReduction": "CONTRAT",
    "typeValeur": "POURCENTAGE",
    "typeFrais": ""
  },
  "user": "testeur-red"
}
</con:request><con:originalUri>http://localhost/contrat-core/contrat/004800005/reduction/ajouter</con:originalUri><con:assertion type="XPath Match" name="reference exists"><con:configuration><path>exists(//*:referenceReduction)</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="Valid HTTP Status Codes" name="Valid HTTP Status Codes"><con:configuration><codes>200</codes></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters><entry key="refContrat" value="${contratPropertie#refContrat}" xmlns="http://eviware.com/soapui/config"/></con:parameters></con:restRequest></con:config></con:testStep><con:testStep type="jdbc" name="reduction valide"><con:settings/><con:config xsi:type="con:JdbcRequestTestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:driver>com.mysql.jdbc.Driver</con:driver><con:connectionString>jdbc:mysql://localhost:3306/topaze_test?user=test&amp;password=test</con:connectionString><con:query>select * from reduction where 
referenceContrat="${contratPropertie#refContrat}";</con:query><con:assertion type="XPath Match" name="context"><con:configuration><path>//*:REDUCTION.CONTEXTREDUCTION</path><content>GLOBAL</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="type reduction"><con:configuration><path>//*:REDUCTION.TYPEREDUCTION</path><content>CONTRAT</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="type valeur"><con:configuration><path>//*:REDUCTION.TYPEVALEUR</path><content>POURCENTAGE</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:testStep type="restrequest" name="valider contrat"><con:settings/><con:config service="http://localhost:8081" methodName="Method 1" resourcePath="/contrat-core/contrat/{refContrat}/valider" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="valider contrat" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://localhost:8081</con:endpoint><con:request>
{
  "user": "test",
  "idClient": "00003870",
  "idAdrFacturation": "685",
  "segmentTVA": "00",
  "paiementInfos": [
    {
      "referenceProduit": "avfwpro-confort-s",
      "numEC": "1",
      "referenceModePaiement": "R0000012",
      "idAdrLivraison": "adrliv1"
    }
  ],
  "politiqueValidation": {
    "fraisCreation": "true",
    "checkIsPackagerCreationPossible": "true"
  }
}

</con:request><con:originalUri>http://localhost/contrat-core/contrat/004800005/valider</con:originalUri><con:assertion type="GroovyScriptAssertion" name="Script Assertion"><con:configuration><scriptText>assert messageExchange.hasResponse() == false</scriptText></con:configuration></con:assertion><con:assertion type="Valid HTTP Status Codes" name="Valid HTTP Status Codes"><con:configuration><codes>200</codes></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters><entry key="refContrat" value="${contratPropertie#refContrat}" xmlns="http://eviware.com/soapui/config"/></con:parameters></con:restRequest></con:config></con:testStep><con:testStep type="jdbc" name="contrat valide"><con:settings/><con:config xsi:type="con:JdbcRequestTestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:driver>com.mysql.jdbc.Driver</con:driver><con:connectionString>jdbc:mysql://localhost:3306/topaze_test?user=test&amp;password=test</con:connectionString><con:query>select * from contrat where reference=
"${contratPropertie#refContrat}";</con:query><con:assertion type="XPath Match" name="date validation exists"><con:configuration><path>exists(//*:CONTRAT.DATEVALIDATION)</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:testStep type="jdbc" name="EC valides"><con:settings/><con:config xsi:type="con:JdbcRequestTestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:driver>com.mysql.jdbc.Driver</con:driver><con:connectionString>jdbc:mysql://localhost:3306/topaze_test?user=test&amp;password=test</con:connectionString><con:query>select * from elementcontractuel where
contratparent=(select id from contrat where
reference="${contratPropertie#refcontrat}");</con:query><con:assertion type="XPath Match" name="date validation exists"><con:configuration><path>exists(//*:ELEMENTCONTRACTUEL.DATEVALIDATION/text())</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="idr facturation"><con:configuration><path>exists(//*:ELEMENTCONTRACTUEL.IDADRLIVRAISON/text())</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:testStep type="delay" name="wait bon livraison initie"><con:settings/><con:config><delay>1000</delay></con:config></con:testStep><con:testStep type="jdbc" name="bon livraison initie"><con:settings/><con:config xsi:type="con:JdbcRequestTestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:driver>com.mysql.jdbc.Driver</con:driver><con:connectionString>jdbc:mysql://localhost:3306/topaze_test?user=test&amp;password=test</con:connectionString><con:query>select * from bonpreparation 
where reference = "${contratPropertie#refContrat}"
  and typeBonPreparation = 'LIVRAISON'</con:query><con:properties/></con:config></con:testStep><con:testStep type="goto" name="go to bon livraison initie"><con:settings/><con:config xsi:type="con:GotoStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:condition><con:name>bon livraison initie</con:name><con:type>XPATH</con:type><con:expression>not(//Results/ResultSet/Row/BONPREPARATION.DATEINITIATION/text())</con:expression><con:targetStep>wait bon livraison initie</con:targetStep></con:condition></con:config></con:testStep><con:testStep type="jdbc" name="bon livraison-initie"><con:settings/><con:config xsi:type="con:JdbcRequestTestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:driver>com.mysql.jdbc.Driver</con:driver><con:connectionString>jdbc:mysql://localhost:3306/topaze_test?user=test&amp;password=test</con:connectionString><con:query>select * from bonpreparation 
where reference = "${contratPropertie#refContrat}"
  and typeBonPreparation = 'LIVRAISON'</con:query><con:assertion type="XPath Match" name="date initiation"><con:configuration><path>exists(//*:BONPREPARATION.DATEINITIATION)</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="type bon livraison"><con:configuration><path>//*:BONPREPARATION.TYPEBONPREPARATION</path><content>LIVRAISON</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:testStep type="jdbc" name="el de livraison inities"><con:settings/><con:config xsi:type="con:JdbcRequestTestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:driver>com.mysql.jdbc.Driver</con:driver><con:connectionString>jdbc:mysql://localhost:3306/topaze_test?user=test&amp;password=test</con:connectionString><con:query>select * from elementlivraison 
where bonPreparationParent = 
(select id from bonpreparation 
  where reference = "${contratPropertie#refContrat}"
    and typeBonPreparation = 'LIVRAISON')</con:query><con:assertion type="XPath Match" name="date livraison exists"><con:configuration><path>exists(//*:ELEMENTLIVRAISON.DATEINITIATION/text())</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="livraison"><con:configuration><path>//*:ELEMENTLIVRAISON.TYPEBONPREPARATION/text()</path><content>LIVRAISON</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="type contrat"><con:configuration><path>//*:ELEMENTLIVRAISON.TYPECONTRAT/text()</path><content>ABONNEMENT</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="XPath Match"><con:configuration><path>exists(//*:ELEMENTLIVRAISON.ADDRESSELIVRAISON/text())</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:testStep type="delay" name="wait bon livraison preparee"><con:settings/><con:config><delay>1000</delay></con:config></con:testStep><con:testStep type="jdbc" name="bon livraison preparee"><con:settings/><con:config xsi:type="con:JdbcRequestTestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:driver>com.mysql.jdbc.Driver</con:driver><con:connectionString>jdbc:mysql://localhost:3306/topaze_test?user=test&amp;password=test</con:connectionString><con:query>select * from bonpreparation 
where reference = "${contratPropertie#refContrat}"
  and typeBonPreparation = 'LIVRAISON'</con:query><con:properties/></con:config></con:testStep><con:testStep type="goto" name="go to bon livraison preparee"><con:settings/><con:config xsi:type="con:GotoStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:condition><con:name>bon prapare</con:name><con:type>XPATH</con:type><con:expression>not(//Results/ResultSet/Row/BONPREPARATION.DATEDEBUTPREPARATION/text())</con:expression><con:targetStep>wait bon livraison preparee</con:targetStep></con:condition></con:config></con:testStep><con:testStep type="jdbc" name="bon livraison-preparee"><con:settings/><con:config xsi:type="con:JdbcRequestTestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:driver>com.mysql.jdbc.Driver</con:driver><con:connectionString>jdbc:mysql://localhost:3306/topaze_test?user=test&amp;password=test</con:connectionString><con:query>select * from bonpreparation 
where reference = "${contratPropertie#refContrat}"
  and typeBonPreparation = 'LIVRAISON'</con:query><con:assertion type="XPath Match" name="date preparation"><con:configuration><path>exists(//*:BONPREPARATION.DATEDEBUTPREPARATION)</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="id client"><con:configuration><path>//*:BONPREPARATION.IDCLIENT</path><content>00003870</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:testStep type="jdbc" name="el livraison prepares"><con:settings/><con:config xsi:type="con:JdbcRequestTestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:driver>com.mysql.jdbc.Driver</con:driver><con:connectionString>jdbc:mysql://localhost:3306/topaze_test?user=test&amp;password=test</con:connectionString><con:query>select * from elementlivraison 
where bonPreparationParent = 
(select id from bonpreparation 
  where reference = "${contratPropertie#refContrat}"
    and typeBonPreparation = 'LIVRAISON')</con:query><con:assertion type="XPath Match" name="acteur"><con:configuration><path>//*:ELEMENTLIVRAISON.ACTEUR</path><content>PACKAGER</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="date preparation"><con:configuration><path>exists(//*:ELEMENTLIVRAISON.DATEPREPARATION)</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:testStep type="delay" name="wait bon livraison terminee"><con:settings/><con:config><delay>1000</delay></con:config></con:testStep><con:testStep type="jdbc" name="bon livraison terminee"><con:settings/><con:config xsi:type="con:JdbcRequestTestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:driver>com.mysql.jdbc.Driver</con:driver><con:connectionString>jdbc:mysql://localhost:3306/topaze_test?user=test&amp;password=test</con:connectionString><con:query>select * from bonpreparation 
where reference = "${contratPropertie#refContrat}"
  and typeBonPreparation = 'LIVRAISON'</con:query><con:properties/></con:config></con:testStep><con:testStep type="goto" name="go to bon livraison terminee"><con:settings/><con:config xsi:type="con:GotoStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:condition><con:name>go end migration</con:name><con:type>XPATH</con:type><con:expression>not(//ResultSet/Row/BONPREPARATION.DATELIVRAISONTERMINE/text()) 
and
not(//ResultSet/Row/BONPREPARATION.CAUSENONLIVRAISON/text())</con:expression><con:targetStep>wait bon livraison terminee</con:targetStep></con:condition></con:config></con:testStep><con:testStep type="jdbc" name="bon livraison-terminee"><con:settings/><con:config xsi:type="con:JdbcRequestTestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:driver>com.mysql.jdbc.Driver</con:driver><con:connectionString>jdbc:mysql://localhost:3306/topaze_test?user=test&amp;password=test</con:connectionString><con:query>select * from bonpreparation 
where reference = "${contratPropertie#refContrat}"
  and typeBonPreparation = 'LIVRAISON'</con:query><con:assertion type="XPath Match" name="date livraison termine"><con:configuration><path>exists(//*:BONPREPARATION.DATELIVRAISONTERMINE)</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="id client"><con:configuration><path>//*:BONPREPARATION.IDCLIENT</path><content>00003870</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:testStep type="delay" name="wait end facture"><con:settings/><con:config><delay>1000</delay></con:config></con:testStep><con:testStep type="jdbc" name="facture terminee"><con:settings/><con:config xsi:type="con:JdbcRequestTestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:driver>com.mysql.jdbc.Driver</con:driver><con:connectionString>jdbc:mysql://localhost:3306/topaze_test?user=test&amp;password=test</con:connectionString><con:query>select * from movement where productReferenceId=
${contratPropertie#refContrat} ;</con:query><con:properties/></con:config></con:testStep><con:testStep type="goto" name="go to facture termine"><con:settings/><con:config xsi:type="con:GotoStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:condition><con:name>end facture</con:name><con:type>XPATH</con:type><con:expression>not(//Results/ResultSet/Row/MOVEMENT.ID/text())</con:expression></con:condition></con:config></con:testStep><con:testStep type="jdbc" name="facture valide"><con:settings/><con:config xsi:type="con:JdbcRequestTestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:driver>com.mysql.jdbc.Driver</con:driver><con:connectionString>jdbc:mysql://localhost:3306/topaze_test?user=test&amp;password=test</con:connectionString><con:query>select * from movement where productReferenceId=
${contratPropertie#refContrat} ;</con:query><con:assertion type="XPath Match" name="discount"><con:configuration><path>//*:MOVEMENT.DISCOUNT</path><content>20</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="product ID"><con:configuration><path>//*:MOVEMENT.PRODUCTID</path><content>Securite/securitoo/avfwpro-confort-s</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="amount"><con:configuration><path>//*:MOVEMENT.AMOUNT</path><content>5</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:properties/></con:testCase><con:testCase failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="tarif recurrent + tarif comptant" searchProperties="true" id="545cbf05-1d2e-4ef9-ae79-1e6b2f2aee4c"><con:settings/><con:testStep type="properties" name="contratPropertie"><con:settings/><con:config xsi:type="con:PropertiesStep" saveFirst="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:properties><con:property><con:name>refContrat</con:name><con:value>002000200</con:value></con:property></con:properties></con:config></con:testStep><con:testStep type="groovy" name="creation ref commande"><con:settings/><con:config><script>import static java.util.UUID.randomUUID 
def tc = context.testCase 
uuid = randomUUID().toString()
testRunner.testCase.setPropertyValue( "RefCommande", uuid ) 
log.info testRunner.testCase.getPropertyValue("RefCommande")</script></con:config></con:testStep><con:testStep type="restrequest" name="preparerContrat"><con:settings/><con:config service="http://localhost:8081" methodName="Method 1" resourcePath="/contrat-core/contrat/preparer" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="preparerContrat" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://localhost:8081</con:endpoint><con:request>{
  "user": "test",
  "produits": [
    {
"reference": "avfwpro-confort-s",
      "numEC": "1",
"numeroCommande": "${#TestCase#RefCommande}",
      "label": "Abonnement Antivirus Securitoo",
      "remboursable": "true",
      "typeProduit": "SERVICE",
      "prix": {
        "duree": "12",
        "periodicite": "1",
        "typeTVA": "R",
        "montant": "5",
        "frais": [
          {
            "montant": "25",
            "typeFrais": "creation"
          },
          {
            "montant": "20",
            "typeFrais": "resiliation"
          }
        ],
        "modePaiement": "VIREMENT",
        "modeFacturation": "DATE_ANNIVERSAIRE"
      }
    }
  ]
}
</con:request><con:originalUri>http://localhost/contrat-core/contrat/preparer</con:originalUri><con:assertion type="XPath Match" name="reference contrat exists"><con:configuration><path>exists(//*:referenceContrat)</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="Valid HTTP Status Codes" name="Valid HTTP Status Codes"><con:configuration><codes>200</codes></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:restRequest></con:config></con:testStep><con:testStep type="transfer" name="move ref contrat"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" useXQuery="false" entitize="false" transferChildNodes="false"><con:name>refContrat</con:name><con:sourceType>ResponseAsXml</con:sourceType><con:sourceStep>preparerContrat</con:sourceStep><con:sourcePath>//*:referenceContrat</con:sourcePath><con:targetType>refContrat</con:targetType><con:targetStep>contratPropertie</con:targetStep></con:transfers></con:config></con:testStep><con:testStep type="jdbc" name="contrat prepare"><con:settings/><con:config xsi:type="con:JdbcRequestTestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:driver>com.mysql.jdbc.Driver</con:driver><con:connectionString>jdbc:mysql://localhost:3306/topaze_test?user=test&amp;password=test</con:connectionString><con:query>select * from contrat where reference=
"${contratPropertie#refContrat}";</con:query><con:assertion type="XPath Match" name="date preapration exists"><con:configuration><path>exists(//*:CONTRAT.DATEPREPARATION/text())</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:testStep type="jdbc" name="EC prepares"><con:settings/><con:config xsi:type="con:JdbcRequestTestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:driver>com.mysql.jdbc.Driver</con:driver><con:connectionString>jdbc:mysql://localhost:3306/topaze_test?user=test&amp;password=test</con:connectionString><con:query>select * from elementcontractuel where contratParent
=(select id from contrat where reference =
"${contratPropertie#refContrat}");</con:query><con:assertion type="XPath Match" name="datepreparation"><con:configuration><path>exists(//*:ELEMENTCONTRACTUEL.DATEPREPARATION/text())</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="modeFacturation"><con:configuration><path>exists(//*:ELEMENTCONTRACTUEL.MODEFACTURATION/text())</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:testStep type="restrequest" name="ajouter reduction contrat"><con:settings/><con:config service="http://localhost:8081" methodName="Method 1" resourcePath="/contrat-core/contrat/{refContrat}/reduction/ajouter" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="ajouter reduction contrat" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://localhost:8081</con:endpoint><con:request>{
  "reduction": {
    "valeur": "1",
    "isAffichableSurFacture": "true",
    "dateFin": "",
    "nbUtilisationMax": "1",
    "titre": "red-global-test",
    "dateDebut": "",
    "typeReduction": "CONTRAT",
    "typeValeur": "MOIS",
    "typeFrais": ""
  },
  "user": "testeur-red"
}
</con:request><con:originalUri>http://localhost/contrat-core/contrat/004800005/reduction/ajouter</con:originalUri><con:assertion type="XPath Match" name="reference exists"><con:configuration><path>exists(//*:referenceReduction)</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="Valid HTTP Status Codes" name="Valid HTTP Status Codes"><con:configuration><codes>200</codes></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters><entry key="refContrat" value="${contratPropertie#refContrat}" xmlns="http://eviware.com/soapui/config"/></con:parameters></con:restRequest></con:config></con:testStep><con:testStep type="restrequest" name="ajouter reduction frais creation"><con:settings/><con:config service="http://localhost:8081" methodName="Method 1" resourcePath="/contrat-core/contrat/{refContrat}/reduction/ajouter" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="ajouter reduction frais creation" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://localhost:8081</con:endpoint><con:request>{
  "reduction": {
    "valeur": "20",
    "isAffichableSurFacture": "true",
    "dateFin": "",
    "nbUtilisationMax": "1",
    "titre": "red-global-test",
    "dateDebut": "",
    "typeReduction": "FRAIS",
    "typeValeur": "POURCENTAGE",
    "typeFrais": "CREATION",
    "ordre" :1
  },
  "user": "testeur-red"
}
</con:request><con:originalUri>http://localhost/contrat-core/contrat/003000980/reduction/ajouter</con:originalUri><con:assertion type="Valid HTTP Status Codes" name="Valid HTTP Status Codes"><con:configuration><codes>200</codes></con:configuration></con:assertion><con:assertion type="XPath Match" name="reference exists"><con:configuration><path>exists(//*:referenceReduction)</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters><entry key="refContrat" value="${contratPropertie#refContrat}" xmlns="http://eviware.com/soapui/config"/></con:parameters></con:restRequest></con:config></con:testStep><con:testStep type="restrequest" name="ajouter reduction frais resilation"><con:settings/><con:config service="http://localhost:8081" methodName="Method 1" resourcePath="/contrat-core/contrat/{refContrat}/reduction/ajouter" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="ajouter reduction frais resilation" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://localhost:8081</con:endpoint><con:request>{
  "reduction": {
    "valeur": "30",
    "isAffichableSurFacture": "true",
    "dateFin": "",
    "nbUtilisationMax": "1",
    "titre": "red-global-test",
    "dateDebut": "",
    "typeReduction": "FRAIS",
    "typeValeur": "POURCENTAGE",
    "typeFrais": "RESILIATION",
     "ordre"  : "3"
  },
  "user": "testeur-red"
}
</con:request><con:originalUri>http://localhost/contrat-core/contrat/003000980/reduction/ajouter</con:originalUri><con:assertion type="XPath Match" name="reference"><con:configuration><path>exists(//*:referenceReduction)</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="Valid HTTP Status Codes" name="Valid HTTP Status Codes"><con:configuration><codes>200</codes></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters><entry key="refContrat" value="${contratPropertie#refContrat}" xmlns="http://eviware.com/soapui/config"/></con:parameters></con:restRequest></con:config></con:testStep><con:testStep type="jdbc" name="reduction valide"><con:settings/><con:config xsi:type="con:JdbcRequestTestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:driver>com.mysql.jdbc.Driver</con:driver><con:connectionString>jdbc:mysql://localhost:3306/topaze_test?user=test&amp;password=test</con:connectionString><con:query>select * from reduction where 
referenceContrat="${contratPropertie#refContrat}";</con:query><con:assertion type="XPath Match" name="context"><con:configuration><path>//*:REDUCTION.CONTEXTREDUCTION</path><content>GLOBAL</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="type reduction"><con:configuration><path>//*:REDUCTION.TYPEREDUCTION</path><content>CONTRAT</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="type valeur"><con:configuration><path>//*:REDUCTION.TYPEVALEUR</path><content>POURCENTAGE</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:testStep type="restrequest" name="valider contrat"><con:settings/><con:config service="http://localhost:8081" methodName="Method 1" resourcePath="/contrat-core/contrat/{refContrat}/valider" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="valider contrat" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://localhost:8081</con:endpoint><con:request>
{
  "user": "test",
  "idClient": "00003870",
  "idAdrFacturation": "685",
  "segmentTVA": "00",
  "paiementInfos": [
    {
      "referenceProduit": "avfwpro-confort-s",
      "numEC": "1",
      "referenceModePaiement": "R0000012",
      "idAdrLivraison": "adrliv1"
    }
  ],
  "politiqueValidation": {
    "fraisCreation": "true",
    "checkIsPackagerCreationPossible": "true"
  }
}
</con:request><con:originalUri>http://localhost/contrat-core/contrat/004800005/valider</con:originalUri><con:assertion type="GroovyScriptAssertion" name="Script Assertion"><con:configuration><scriptText>assert messageExchange.hasResponse() == false</scriptText></con:configuration></con:assertion><con:assertion type="Valid HTTP Status Codes" name="Valid HTTP Status Codes"><con:configuration><codes>200</codes></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters><entry key="refContrat" value="${contratPropertie#refContrat}" xmlns="http://eviware.com/soapui/config"/></con:parameters></con:restRequest></con:config></con:testStep><con:testStep type="jdbc" name="contrat valide"><con:settings/><con:config xsi:type="con:JdbcRequestTestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:driver>com.mysql.jdbc.Driver</con:driver><con:connectionString>jdbc:mysql://localhost:3306/topaze_test?user=test&amp;password=test</con:connectionString><con:query>select * from contrat where reference=
"${contratPropertie#refContrat}";</con:query><con:assertion type="XPath Match" name="date validation exists"><con:configuration><path>exists(//*:CONTRAT.DATEVALIDATION)</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:testStep type="jdbc" name="EC valides"><con:settings/><con:config xsi:type="con:JdbcRequestTestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:driver>com.mysql.jdbc.Driver</con:driver><con:connectionString>jdbc:mysql://localhost:3306/topaze_test?user=test&amp;password=test</con:connectionString><con:query>select * from elementcontractuel where
contratparent=(select id from contrat where
reference="${contratPropertie#refcontrat}");</con:query><con:assertion type="XPath Match" name="date validation exists"><con:configuration><path>exists(//*:ELEMENTCONTRACTUEL.DATEVALIDATION/text())</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="idr facturation"><con:configuration><path>exists(//*:ELEMENTCONTRACTUEL.IDADRLIVRAISON/text())</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:testStep type="delay" name="wait bon livraison initie"><con:settings/><con:config><delay>1000</delay></con:config></con:testStep><con:testStep type="jdbc" name="bon livraison initie"><con:settings/><con:config xsi:type="con:JdbcRequestTestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:driver>com.mysql.jdbc.Driver</con:driver><con:connectionString>jdbc:mysql://localhost:3306/topaze_test?user=test&amp;password=test</con:connectionString><con:query>select * from bonpreparation 
where reference = "${contratPropertie#refContrat}"
  and typeBonPreparation = 'LIVRAISON'</con:query><con:properties/></con:config></con:testStep><con:testStep type="goto" name="go to bon livraison initie"><con:settings/><con:config xsi:type="con:GotoStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:condition><con:name>bon livraison initie</con:name><con:type>XPATH</con:type><con:expression>not(//Results/ResultSet/Row/BONPREPARATION.DATEINITIATION/text())</con:expression><con:targetStep>wait bon livraison initie</con:targetStep></con:condition></con:config></con:testStep><con:testStep type="jdbc" name="bon livraison-initie"><con:settings/><con:config xsi:type="con:JdbcRequestTestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:driver>com.mysql.jdbc.Driver</con:driver><con:connectionString>jdbc:mysql://localhost:3306/topaze_test?user=test&amp;password=test</con:connectionString><con:query>select * from bonpreparation 
where reference = "${contratPropertie#refContrat}"
  and typeBonPreparation = 'LIVRAISON'</con:query><con:assertion type="XPath Match" name="date initiation"><con:configuration><path>exists(//*:BONPREPARATION.DATEINITIATION)</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="type bon livraison"><con:configuration><path>//*:BONPREPARATION.TYPEBONPREPARATION</path><content>LIVRAISON</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:testStep type="jdbc" name="el de livraison inities"><con:settings/><con:config xsi:type="con:JdbcRequestTestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:driver>com.mysql.jdbc.Driver</con:driver><con:connectionString>jdbc:mysql://localhost:3306/topaze_test?user=test&amp;password=test</con:connectionString><con:query>select * from elementlivraison 
where bonPreparationParent = 
(select id from bonpreparation 
  where reference = "${contratPropertie#refContrat}"
    and typeBonPreparation = 'LIVRAISON')</con:query><con:assertion type="XPath Match" name="date livraison exists"><con:configuration><path>exists(//*:ELEMENTLIVRAISON.DATEINITIATION/text())</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="livraison"><con:configuration><path>//*:ELEMENTLIVRAISON.TYPEBONPREPARATION/text()</path><content>LIVRAISON</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="type contrat"><con:configuration><path>//*:ELEMENTLIVRAISON.TYPECONTRAT/text()</path><content>ABONNEMENT</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="XPath Match"><con:configuration><path>exists(//*:ELEMENTLIVRAISON.ADDRESSELIVRAISON/text())</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:testStep type="delay" name="bon livraison preparee"><con:settings/><con:config><delay>1000</delay></con:config></con:testStep><con:testStep type="jdbc" name="bon livraison prepare"><con:settings/><con:config xsi:type="con:JdbcRequestTestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:driver>com.mysql.jdbc.Driver</con:driver><con:connectionString>jdbc:mysql://localhost:3306/topaze_test?user=test&amp;password=test</con:connectionString><con:query>select * from bonpreparation 
where reference = "${contratPropertie#refContrat}"
  and typeBonPreparation = 'LIVRAISON'</con:query><con:properties/></con:config></con:testStep><con:testStep type="goto" name="go to bon livraison preparee"><con:settings/><con:config xsi:type="con:GotoStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:condition><con:name>bon prapare</con:name><con:type>XPATH</con:type><con:expression>not(//Results/ResultSet/Row/BONPREPARATION.DATEDEBUTPREPARATION/text())</con:expression><con:targetStep>wait bon livraison preparee</con:targetStep></con:condition></con:config></con:testStep><con:testStep type="jdbc" name="bon livraison-preparee"><con:settings/><con:config xsi:type="con:JdbcRequestTestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:driver>com.mysql.jdbc.Driver</con:driver><con:connectionString>jdbc:mysql://localhost:3306/topaze_test?user=test&amp;password=test</con:connectionString><con:query>select * from bonpreparation 
where reference = "${contratPropertie#refContrat}"
  and typeBonPreparation = 'LIVRAISON'</con:query><con:assertion type="XPath Match" name="date preparation"><con:configuration><path>exists(//*:BONPREPARATION.DATEDEBUTPREPARATION)</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="id client"><con:configuration><path>//*:BONPREPARATION.IDCLIENT</path><content>00003870</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:testStep type="jdbc" name="el livraison prepares"><con:settings/><con:config xsi:type="con:JdbcRequestTestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:driver>com.mysql.jdbc.Driver</con:driver><con:connectionString>jdbc:mysql://localhost:3306/topaze_test?user=test&amp;password=test</con:connectionString><con:query>select * from elementlivraison 
where bonPreparationParent = 
(select id from bonpreparation 
  where reference = "${contratPropertie#refContrat}"
    and typeBonPreparation = 'LIVRAISON')</con:query><con:assertion type="XPath Match" name="acteur"><con:configuration><path>//*:ELEMENTLIVRAISON.ACTEUR</path><content>PACKAGER</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="date preparation"><con:configuration><path>exists(//*:ELEMENTLIVRAISON.DATEPREPARATION)</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:testStep type="delay" name="wait bon livraison terminee"><con:settings/><con:config><delay>1000</delay></con:config></con:testStep><con:testStep type="jdbc" name="bon livraison terminee"><con:settings/><con:config xsi:type="con:JdbcRequestTestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:driver>com.mysql.jdbc.Driver</con:driver><con:connectionString>jdbc:mysql://localhost:3306/topaze_test?user=test&amp;password=test</con:connectionString><con:query>select * from bonpreparation 
where reference = "${contratPropertie#refContrat}"
  and typeBonPreparation = 'LIVRAISON'</con:query><con:properties/></con:config></con:testStep><con:testStep type="goto" name="go to bon livraison terminee"><con:settings/><con:config xsi:type="con:GotoStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:condition><con:name>go end migration</con:name><con:type>XPATH</con:type><con:expression>not(//ResultSet/Row/BONPREPARATION.DATELIVRAISONTERMINE/text()) 
and
not(//ResultSet/Row/BONPREPARATION.CAUSENONLIVRAISON/text())</con:expression><con:targetStep>wait bon livraison terminee</con:targetStep></con:condition></con:config></con:testStep><con:testStep type="jdbc" name="bon livraison-terminee"><con:settings/><con:config xsi:type="con:JdbcRequestTestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:driver>com.mysql.jdbc.Driver</con:driver><con:connectionString>jdbc:mysql://localhost:3306/topaze_test?user=test&amp;password=test</con:connectionString><con:query>select * from bonpreparation 
where reference =
"${contratPropertie#refContrat}"
  and typeBonPreparation = 'LIVRAISON'</con:query><con:assertion type="XPath Match" name="date livraison termine"><con:configuration><path>exists(//*:BONPREPARATION.DATELIVRAISONTERMINE)</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="id client"><con:configuration><path>//*:BONPREPARATION.IDCLIENT</path><content>00003870</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:testStep type="delay" name="wait end facture"><con:settings/><con:config><delay>1000</delay></con:config></con:testStep><con:testStep type="jdbc" name="facture terminee"><con:settings/><con:config xsi:type="con:JdbcRequestTestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:driver>com.mysql.jdbc.Driver</con:driver><con:connectionString>jdbc:mysql://localhost:3306/topaze_test?user=test&amp;password=test</con:connectionString><con:query>select * from movement where 
billinggroup=
"${#TestCase#RefCommande}" ;</con:query><con:properties/></con:config></con:testStep><con:testStep type="goto" name="go to facture termine"><con:settings/><con:config xsi:type="con:GotoStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:condition><con:name>end facture</con:name><con:type>XPATH</con:type><con:expression>not(//Results/ResultSet/Row/MOVEMENT.ID/text())</con:expression></con:condition></con:config></con:testStep><con:testStep type="jdbc" name="facture valide"><con:settings/><con:config xsi:type="con:JdbcRequestTestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:driver>com.mysql.jdbc.Driver</con:driver><con:connectionString>jdbc:mysql://localhost:3306/topaze_test?user=test&amp;password=test</con:connectionString><con:query>select * from movement where 
billinggroup=
"${#TestCase#RefCommande}" ;</con:query><con:assertion type="XPath Match" name="product ID"><con:configuration><path>//*:MOVEMENT.PRODUCTID</path><content>Securite/securitoo/avfwpro-confort-s</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" name="amount"><con:configuration><path>//*:MOVEMENT.AMOUNT</path><content>5</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XQuery Match" name="mvt"><con:configuration><path><![CDATA[<Results>
{
for $x in //Row
return <result>
<amount>{$x/MOVEMENT.AMOUNT/text()}</amount>

<numeroCommande>{$x/MOVEMENT.BILLINGGROUP/text()}</numeroCommande>
<productId>{$x/MOVEMENT.PRODUCTID/text()}</productId>
</result>
}
</Results>]]></path><content><![CDATA[<Results>
<result>
<amount>5</amount>
<numeroCommande>${#TestCase#RefCommande}</numeroCommande>
<productId>Securite/securitoo/avfwpro-confort-s/Frais/Creation/Reduction/gesteco</productId>
</result>

<result>
<amount>25</amount>
<numeroCommande>${#TestCase#RefCommande}</numeroCommande>
<productId>Securite/securitoo/avfwpro-confort-s/Frais/Creation</productId>
</result>

<result>
<amount>5</amount>
<numeroCommande>${#TestCase#RefCommande}</numeroCommande>
<productId>Securite/securitoo/avfwpro-confort-s/Reduction/gesteco</productId>
</result>

<result>
<amount>5</amount>
<numeroCommande>${#TestCase#RefCommande}</numeroCommande>
<productId>Securite/securitoo/avfwpro-confort-s</productId>
</result>
</Results>]]></content><allowWildcards>false</allowWildcards></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:properties><con:property><con:name>RefCommande</con:name><con:value>b37439f9-f43a-4bdc-b8c9-5786d0881077</con:value></con:property></con:properties></con:testCase><con:testCase failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="Contrat avec plusieurs reductions globales (affichable)" searchProperties="true" id="7311570e-c673-40c9-9839-63adc1b2e5bb"><con:settings/><con:testStep type="calltestcase" name="Preparation"><con:settings/><con:config xsi:type="con:RunTestCaseStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:targetTestCase>621887f4-565f-4013-bd4a-24e3e4c41a1e</con:targetTestCase><con:properties><con:property><con:name>RefCommande</con:name><con:value>0b45fd2b-d756-4fc3-b2c8-f96c84b8016f</con:value></con:property><con:property><con:name>refContrat</con:name><con:value>301000000</con:value></con:property></con:properties><con:returnProperties><con:entry>RefCommande</con:entry><con:entry>refContrat</con:entry></con:returnProperties><con:runMode>PARALLELL</con:runMode></con:config></con:testStep><con:testStep type="restrequest" name="Reduction Globales (20Euro)"><con:settings/><con:config service="http://localhost:8081" resourcePath="/contrat-core/contrat/{refContrat}/reduction/ajouter" methodName="Method 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="Reduction Globales (20Euro)" mediaType="application/json" postQueryString="false" id="c08c5fb9-e8af-470e-988b-2a9adff352c1"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>http://localhost:8081</con:endpoint><con:request>{
  "reduction": {
    "typeReduction": "contrat",
    "valeur": "2",
    "nbUtilisationMax": "1",
    "isAffichableSurFacture": true,
    "typeValeur": "montant",
    "titre": "reduction 2 euro",
    "ordre": "1"
  },
  "user": "soap-ui"
}</con:request><con:originalUri>http://localhost/contrat-core/contrat/00003177/reduction/ajouter</con:originalUri><con:assertion type="Valid HTTP Status Codes" name="Valid HTTP Status Codes"><con:configuration><codes>200</codes></con:configuration></con:assertion><con:assertion type="Simple Contains" name="response"><con:configuration><token>referenceReduction</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters><entry key="refContrat" value="${Preparation#refContrat}" xmlns="http://eviware.com/soapui/config"/></con:parameters></con:restRequest></con:config></con:testStep><con:testStep type="restrequest" name="Reduction Globales (20%)"><con:settings/><con:config service="http://localhost:8081" resourcePath="/contrat-core/contrat/{refContrat}/reduction/ajouter" methodName="Method 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="Reduction Globales (20%)" mediaType="application/json" postQueryString="false" id="c08c5fb9-e8af-470e-988b-2a9adff352c1"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>http://localhost:8081</con:endpoint><con:request>{
  "reduction": {
    "typeReduction": "contrat",
    "valeur": "20",
    "nbUtilisationMax": "1",
    "isAffichableSurFacture": true,
    "typeValeur": "pourcentage",
    "titre": "reduction 20%",
    "ordre": "2"
  },
  "user": "soap-ui"
}</con:request><con:originalUri>http://localhost/contrat-core/contrat/00003177/reduction/ajouter</con:originalUri><con:assertion type="Valid HTTP Status Codes" name="Valid HTTP Status Codes"><con:configuration><codes>200</codes></con:configuration></con:assertion><con:assertion type="Simple Contains" name="response"><con:configuration><token>referenceReduction</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters><entry key="refContrat" value="${Preparation#refContrat}" xmlns="http://eviware.com/soapui/config"/></con:parameters></con:restRequest></con:config></con:testStep><con:testStep type="restrequest" name="validation"><con:settings/><con:config service="http://localhost:8081" resourcePath="/contrat-core/contrat/{refContrat}/valider" methodName="Method 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="validation" mediaType="application/json" postQueryString="false" id="2f9095be-b9f7-4881-8ee1-74542c5d8d83"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>http://localhost:8081</con:endpoint><con:request>{
  "user": "test",
  "idClient": "00003870",
  "segmentTVA": "00",
  "idAdrFacturation": "685",
  "paiementInfos": [
    {
      "referenceProduit": "avfwpro-confort-s",
      "numEC": "1",
      "referenceModePaiement": "R0000012",
      "idAdrLivraison": "idr"
    }
  ],
  "politiqueValidation": {
    "fraisCreation": "true",
    "checkIsPackagerCreationPossible": "true"
  }
}
</con:request><con:originalUri>http://localhost/contrat-core/contrat/00003177/valider</con:originalUri><con:assertion type="GroovyScriptAssertion" name="reponse vide"><con:configuration><scriptText>assert messageExchange.hasResponse() == false</scriptText></con:configuration></con:assertion><con:assertion type="Valid HTTP Status Codes" name="Valid HTTP Status Codes"><con:configuration><codes>200</codes></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters><entry key="refContrat" value="${Preparation#refContrat}" xmlns="http://eviware.com/soapui/config"/></con:parameters></con:restRequest></con:config></con:testStep><con:testStep type="delay" name="wait facturation"><con:settings/><con:config><delay>500</delay></con:config></con:testStep><con:testStep type="jdbc" name="Element Facturé"><con:settings/><con:config xsi:type="con:JdbcRequestTestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:driver>com.mysql.jdbc.Driver</con:driver><con:connectionString>jdbc:mysql://localhost:3306/topaze_test?user=test&amp;password=test</con:connectionString><con:query>select el.* from contrat c, elementcontractuel el where
c.id=el.contratParent and c.reference=${Preparation#refContrat}</con:query><con:properties/></con:config></con:testStep><con:testStep type="goto" name="Go to facture"><con:settings/><con:config xsi:type="con:GotoStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:condition><con:name>wait</con:name><con:type>XPATH</con:type><con:expression>not(//Results/ResultSet/Row/ELEMENTCONTRACTUEL.DATEDEBUTFACTURATION/text())</con:expression><con:targetStep>wait facturation</con:targetStep></con:condition></con:config></con:testStep><con:testStep type="delay" name="wait facture finish"><con:settings/><con:config><delay>3000</delay></con:config></con:testStep><con:testStep type="jdbc" name="Validation Facture"><con:settings/><con:config xsi:type="con:JdbcRequestTestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:driver>com.mysql.jdbc.Driver</con:driver><con:connectionString>jdbc:mysql://localhost:3306/topaze_test?user=test&amp;password=test</con:connectionString><con:query>select * from movement where productReferenceId=
'${Preparation#refContrat}' or billinggroup='${Preparation#refCommande}';</con:query><con:assertion type="XPath Match" name="Nombre Mouvement Valide"><con:configuration><path>count(//Results/ResultSet/Row/MOVEMENT.ID/text())</path><content>4</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:testStep type="jdbc" name="Validation Montant Reduction"><con:settings/><con:config xsi:type="con:JdbcRequestTestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:driver>com.mysql.jdbc.Driver</con:driver><con:connectionString>jdbc:mysql://localhost:3306/topaze_test?user=test&amp;password=test</con:connectionString><con:query>select amount from movement where billinggroup='${Preparation#refCommande}';</con:query><con:assertion type="XQuery Match" name="montant"><con:configuration><path>&lt;Results> 
{ 
  for $x in //Row 
  return &lt;Result>{$x/MOVEMENT.AMOUNT/text()}&lt;/Result> 
} 
&lt;/Results></path><content><![CDATA[<Results>
  <Result>30</Result>
  <Result>2</Result>
  <Result>0.6</Result>
  <Result>5</Result>
</Results>]]></content><allowWildcards>false</allowWildcards></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:properties><con:property><con:name>RefCommande</con:name><con:value/></con:property></con:properties></con:testCase><con:testCase failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="Contrat avec plusieurs reduction globales (non affichable)" searchProperties="true" id="c76ec742-2b43-4842-b66b-fcddc75fd276"><con:settings/><con:testStep type="calltestcase" name="Preparation"><con:settings/><con:config xsi:type="con:RunTestCaseStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:targetTestCase>621887f4-565f-4013-bd4a-24e3e4c41a1e</con:targetTestCase><con:properties><con:property><con:name>RefCommande</con:name><con:value>a71588b0-26ad-4a36-8ebf-f40fc41c7865</con:value></con:property><con:property><con:name>refContrat</con:name><con:value>005000004</con:value></con:property></con:properties><con:returnProperties><con:entry>RefCommande</con:entry><con:entry>refContrat</con:entry></con:returnProperties><con:runMode>PARALLELL</con:runMode></con:config></con:testStep><con:testStep type="restrequest" name="Reduction Globales (20Euro)"><con:settings/><con:config service="http://localhost:8081" resourcePath="/contrat-core/contrat/{refContrat}/reduction/ajouter" methodName="Method 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="Reduction Globales (20Euro)" mediaType="application/json" postQueryString="false" id="c08c5fb9-e8af-470e-988b-2a9adff352c1"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>http://localhost:8081</con:endpoint><con:request>{
  "reduction": {
    "typeReduction": "contrat",
    "valeur": "2",
    "nbUtilisationMax": "1",
    "isAffichableSurFacture": false,
    "typeValeur": "montant",
    "titre": "reduction 2 euro",
    "ordre": "1"
  },
  "user": "soap-ui"
}</con:request><con:originalUri>http://localhost/contrat-core/contrat/00003177/reduction/ajouter</con:originalUri><con:assertion type="Valid HTTP Status Codes" name="Valid HTTP Status Codes"><con:configuration><codes>200</codes></con:configuration></con:assertion><con:assertion type="Simple Contains" name="response"><con:configuration><token>referenceReduction</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters><entry key="refContrat" value="${Preparation#refContrat}" xmlns="http://eviware.com/soapui/config"/></con:parameters></con:restRequest></con:config></con:testStep><con:testStep type="restrequest" name="Reduction Globales (20%)"><con:settings/><con:config service="http://localhost:8081" resourcePath="/contrat-core/contrat/{refContrat}/reduction/ajouter" methodName="Method 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="Reduction Globales (20%)" mediaType="application/json" postQueryString="false" id="c08c5fb9-e8af-470e-988b-2a9adff352c1"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>http://localhost:8081</con:endpoint><con:request>{
  "reduction": {
    "typeReduction": "contrat",
    "valeur": "20",
    "nbUtilisationMax": "1",
    "isAffichableSurFacture": false,
    "typeValeur": "pourcentage",
    "titre": "reduction 20%",
    "ordre": "2"
  },
  "user": "soap-ui"
}</con:request><con:originalUri>http://localhost/contrat-core/contrat/00003177/reduction/ajouter</con:originalUri><con:assertion type="Valid HTTP Status Codes" name="Valid HTTP Status Codes"><con:configuration><codes>200</codes></con:configuration></con:assertion><con:assertion type="Simple Contains" name="response"><con:configuration><token>referenceReduction</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters><entry key="refContrat" value="${Preparation#refContrat}" xmlns="http://eviware.com/soapui/config"/></con:parameters></con:restRequest></con:config></con:testStep><con:testStep type="restrequest" name="validation"><con:settings/><con:config service="http://localhost:8081" resourcePath="/contrat-core/contrat/{refContrat}/valider" methodName="Method 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="validation" mediaType="application/json" postQueryString="false" id="2f9095be-b9f7-4881-8ee1-74542c5d8d83"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>http://localhost:8081</con:endpoint><con:request>{
  "user": "test",
  "idClient": "00003870",
  "segmentTVA": "00",
  "idAdrFacturation": "685",
  "paiementInfos": [
    {
      "referenceProduit": "avfwpro-confort-s",
      "numEC": "1",
      "referenceModePaiement": "R0000012",
      "idAdrLivraison": "idr"
    }
  ],
  "politiqueValidation": {
    "fraisCreation": "true",
    "checkIsPackagerCreationPossible": "true"
  }
}
</con:request><con:originalUri>http://localhost/contrat-core/contrat/00003177/valider</con:originalUri><con:assertion type="GroovyScriptAssertion" name="reponse vide"><con:configuration><scriptText>assert messageExchange.hasResponse() == false</scriptText></con:configuration></con:assertion><con:assertion type="Valid HTTP Status Codes" name="Valid HTTP Status Codes"><con:configuration><codes>200</codes></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters><entry key="refContrat" value="${Preparation#refContrat}" xmlns="http://eviware.com/soapui/config"/></con:parameters></con:restRequest></con:config></con:testStep><con:testStep type="delay" name="wait facturation"><con:settings/><con:config><delay>500</delay></con:config></con:testStep><con:testStep type="jdbc" name="Element Facturé"><con:settings/><con:config xsi:type="con:JdbcRequestTestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:driver>com.mysql.jdbc.Driver</con:driver><con:connectionString>jdbc:mysql://localhost:3306/topaze_test?user=test&amp;password=test</con:connectionString><con:query>select el.* from contrat c, elementcontractuel el where
c.id=el.contratParent and c.reference=${Preparation#refContrat}</con:query><con:properties/></con:config></con:testStep><con:testStep type="goto" name="Go to facture"><con:settings/><con:config xsi:type="con:GotoStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:condition><con:name>wait</con:name><con:type>XPATH</con:type><con:expression>not(//Results/ResultSet/Row/ELEMENTCONTRACTUEL.DATEDEBUTFACTURATION/text())</con:expression><con:targetStep>wait facturation</con:targetStep></con:condition></con:config></con:testStep><con:testStep type="delay" name="wait facture finish"><con:settings/><con:config><delay>3000</delay></con:config></con:testStep><con:testStep type="jdbc" name="Validation Facture"><con:settings/><con:config xsi:type="con:JdbcRequestTestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:driver>com.mysql.jdbc.Driver</con:driver><con:connectionString>jdbc:mysql://localhost:3306/topaze_test?user=test&amp;password=test</con:connectionString><con:query>select * from movement where productReferenceId=
'${Preparation#refContrat}' or billinggroup='${Preparation#refCommande}';</con:query><con:assertion type="XPath Match" name="Nombre Mouvement Valide"><con:configuration><path>count(//Results/ResultSet/Row/MOVEMENT.ID/text())</path><content>2</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:testStep type="jdbc" name="Validation Montant Reduction"><con:settings/><con:config xsi:type="con:JdbcRequestTestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:driver>com.mysql.jdbc.Driver</con:driver><con:connectionString>jdbc:mysql://localhost:3306/topaze_test?user=test&amp;password=test</con:connectionString><con:query>select amount, discount from movement where productReferenceId=
'${Preparation#refContrat}';</con:query><con:assertion type="XQuery Match" name="montant"><con:configuration><path>&lt;Results> 
{ 
  for $x in //Row 
  return &lt;Result>{$x/MOVEMENT.DISCOUNT/text()}&lt;/Result> 
} 
&lt;/Results></path><content><![CDATA[<Results>
  <Result>0</Result>
  <Result>2.6</Result>
</Results>]]></content><allowWildcards>false</allowWildcards></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:properties><con:property><con:name>RefCommande</con:name><con:value/></con:property></con:properties></con:testCase><con:testCase failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="Contrat avec reduction globales (1) + reduction element (2) (affichable)" searchProperties="true" id="612a8536-a348-4454-8615-201259223050"><con:settings/><con:testStep type="calltestcase" name="Preparation"><con:settings/><con:config xsi:type="con:RunTestCaseStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:targetTestCase>621887f4-565f-4013-bd4a-24e3e4c41a1e</con:targetTestCase><con:properties><con:property><con:name>RefCommande</con:name><con:value>8172f7fa-304b-4e08-a647-98e9e1be5457</con:value></con:property><con:property><con:name>refContrat</con:name><con:value>002000500</con:value></con:property></con:properties><con:returnProperties><con:entry>RefCommande</con:entry><con:entry>refContrat</con:entry></con:returnProperties><con:runMode>PARALLELL</con:runMode></con:config></con:testStep><con:testStep type="restrequest" name="Reduction Globales (20Euro)"><con:settings/><con:config service="http://localhost:8081" resourcePath="/contrat-core/contrat/{refContrat}/reduction/ajouter" methodName="Method 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="Reduction Globales (20Euro)" mediaType="application/json" postQueryString="false" id="c08c5fb9-e8af-470e-988b-2a9adff352c1"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>http://localhost:8081</con:endpoint><con:request>{
  "reduction": {
    "typeReduction": "contrat",
    "valeur": "2",
    "nbUtilisationMax": "1",
    "isAffichableSurFacture": true,
    "typeValeur": "montant",
    "titre": "reduction 2 euro",
    "ordre": "2"
  },
  "user": "soap-ui"
}</con:request><con:originalUri>http://localhost/contrat-core/contrat/00003177/reduction/ajouter</con:originalUri><con:assertion type="Valid HTTP Status Codes" name="Valid HTTP Status Codes"><con:configuration><codes>200</codes></con:configuration></con:assertion><con:assertion type="Simple Contains" name="response"><con:configuration><token>referenceReduction</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters><entry key="refContrat" value="${Preparation#refContrat}" xmlns="http://eviware.com/soapui/config"/></con:parameters></con:restRequest></con:config></con:testStep><con:testStep type="restrequest" name="Reduction Globales (20%)"><con:settings/><con:config service="http://localhost:8081" resourcePath="/contrat-core/contrat/{refContrat}/reduction/ajouter" methodName="Method 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="Reduction Globales (20%)" mediaType="application/json" postQueryString="false" id="c08c5fb9-e8af-470e-988b-2a9adff352c1"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>http://localhost:8081</con:endpoint><con:request>{
  "reduction": {
    "typeReduction": "contrat",
    "valeur": "20",
    "nbUtilisationMax": "1",
    "isAffichableSurFacture": true,
    "typeValeur": "pourcentage",
    "titre": "reduction 20%",
    "ordre": "1"
  },
  "user": "soap-ui"
}</con:request><con:originalUri>http://localhost/contrat-core/contrat/00003177/reduction/ajouter</con:originalUri><con:assertion type="Valid HTTP Status Codes" name="Valid HTTP Status Codes"><con:configuration><codes>200</codes></con:configuration></con:assertion><con:assertion type="Simple Contains" name="response"><con:configuration><token>referenceReduction</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters>
  <con:entry key="refContrat" value="${Preparation#refContrat}"/>
  <con:entry key="numEC" value="1"/>
  <con:entry key="referenceContrat" value="${Preparation#refContrat}"/>
</con:parameters></con:restRequest></con:config></con:testStep><con:testStep type="restrequest" name="validation"><con:settings/><con:config service="http://localhost:8081" resourcePath="/contrat-core/contrat/{refContrat}/valider" methodName="Method 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="validation" mediaType="application/json" postQueryString="false" id="2f9095be-b9f7-4881-8ee1-74542c5d8d83"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>http://localhost:8081</con:endpoint><con:request>{
  "user": "test",
  "idClient": "00003870",
  "segmentTVA": "00",
  "idAdrFacturation": "685",
  "paiementInfos": [
    {
      "referenceProduit": "avfwpro-confort-s",
      "numEC": "1",
      "referenceModePaiement": "R0000012",
      "idAdrLivraison": "idr"
    }
  ],
  "politiqueValidation": {
    "fraisCreation": "true",
    "checkIsPackagerCreationPossible": "true"
  }
}
</con:request><con:originalUri>http://localhost/contrat-core/contrat/00003177/valider</con:originalUri><con:assertion type="GroovyScriptAssertion" name="reponse vide"><con:configuration><scriptText>assert messageExchange.hasResponse() == false</scriptText></con:configuration></con:assertion><con:assertion type="Valid HTTP Status Codes" name="Valid HTTP Status Codes"><con:configuration><codes>200</codes></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters><entry key="refContrat" value="${Preparation#refContrat}" xmlns="http://eviware.com/soapui/config"/></con:parameters></con:restRequest></con:config></con:testStep><con:testStep type="delay" name="wait facturation"><con:settings/><con:config><delay>500</delay></con:config></con:testStep><con:testStep type="jdbc" name="Element Facturé"><con:settings/><con:config xsi:type="con:JdbcRequestTestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:driver>com.mysql.jdbc.Driver</con:driver><con:connectionString>jdbc:mysql://localhost:3306/topaze_test?user=test&amp;password=test</con:connectionString><con:query>select el.* from contrat c, elementcontractuel el where
c.id=el.contratParent and c.reference=${Preparation#refContrat}</con:query><con:properties/></con:config></con:testStep><con:testStep type="goto" name="Go to facture"><con:settings/><con:config xsi:type="con:GotoStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:condition><con:name>wait</con:name><con:type>XPATH</con:type><con:expression>not(//Results/ResultSet/Row/ELEMENTCONTRACTUEL.DATEDEBUTFACTURATION/text())</con:expression><con:targetStep>wait facturation</con:targetStep></con:condition></con:config></con:testStep><con:testStep type="delay" name="wait facture finish"><con:settings/><con:config><delay>3000</delay></con:config></con:testStep><con:testStep type="jdbc" name="Validation Facture"><con:settings/><con:config xsi:type="con:JdbcRequestTestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:driver>com.mysql.jdbc.Driver</con:driver><con:connectionString>jdbc:mysql://localhost:3306/topaze_test?user=test&amp;password=test</con:connectionString><con:query>select * from movement where productReferenceId=
'${Preparation#refContrat}' or billinggroup='${Preparation#refCommande}';</con:query><con:assertion type="XPath Match" name="Nombre Mouvement Valide"><con:configuration><path>count(//Results/ResultSet/Row/MOVEMENT.ID/text())</path><content>4</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:testStep type="jdbc" name="Validation Mouvement"><con:settings/><con:config xsi:type="con:JdbcRequestTestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:driver>com.mysql.jdbc.Driver</con:driver><con:connectionString>jdbc:mysql://localhost:3306/topaze_test?user=test&amp;password=test</con:connectionString><con:query>select * from movement where billinggroup='${Preparation#refCommande}';</con:query><con:assertion type="XQuery Match" name="montant"><con:configuration><path><![CDATA[<Results> 
{ 
  for $x in //Row 
  return <result>
<amount>{$x/MOVEMENT.AMOUNT/text()}</amount>
<productId>{$x/MOVEMENT.PRODUCTID/text()}</productId>
</result>
} 
</Results>]]></path><content><![CDATA[<Results>
  <result>
    <amount>30</amount>
    <productId>Securite/securitoo/avfwpro-confort-s/Frais/Creation</productId>
  </result>
  <result>
    <amount>1</amount>
    <productId>Securite/securitoo/avfwpro-confort-s/Reduction/gesteco</productId>
  </result>
  <result>
    <amount>2</amount>
    <productId>Securite/securitoo/avfwpro-confort-s/Reduction/gesteco</productId>
  </result>
  <result>
    <amount>5</amount>
    <productId>Securite/securitoo/avfwpro-confort-s</productId>
  </result>
</Results>]]></content><allowWildcards>false</allowWildcards></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:properties><con:property><con:name>RefCommande</con:name><con:value/></con:property></con:properties></con:testCase><con:properties/></con:testSuite><con:properties/><con:wssContainer/><con:oAuth2ProfileContainer/><con:sensitiveInformation/></con:soapui-project>